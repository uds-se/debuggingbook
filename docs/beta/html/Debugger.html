<!-- A html document -->
<!-- 
with standard nbconvert css layout
with standard nbconvert input/output content
standard html tag wrapping
with mathjax loaded
with jupyter wigets
 caption and label elements according to ipub meta tags  
with fuzzingbook adaptations -->None
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /><title>How Debuggers Work - The Debugging Book</title>

<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
    </style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>
<!-- End of mathjax configuration --><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!--[if IE lte 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<style type="text/css">
.ipyfigure { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipyfigure>div { flex:1; }
.ipytable { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipytable>div { flex:1; }

</style>

<link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,500,700|Raleway:300|Source+Code+Pro|Open+Sans' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<meta property="og:url" content="https://www.debuggingbook.org/beta/html/Debugger.html" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How Debuggers Work - The Debugging Book" />
<meta property="og:description" content="Interactive debuggers are tools that allow you to selectively observe the program state during an execution.  In this chapter, you will learn how such debuggers work – by building your own debugger.Prerequisites You should have read the Chapter on Tracing Executions. Again, knowing a bit of Python is helpful for understanding the code examples in the book." />
<meta property="og:image" content="https://www.debuggingbook.org/beta/html/PICS/wordcloud.png" />

<meta name="twitter:dnt" content="on">

<link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon.png">

<meta name="msapplication-TileColor" content="#B03A2E">
<meta name="msapplication-config" content="favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">

<meta name="viewport" content="width=device-width, initial-scale=1"></head>
 <body>

    <script>
    var close_menus = function() {
        /* doesn't work yet - AZ
        console.log("Closing menus")
        var cssmenu = document.getElementById("cssmenu")
        var all_items = cssmenu.getElementsByTagName("li");
        var i;
        for (i = 0; i < all_items.length; i++) {
            item = all_items[i];
            // console.log("<li>: ")
            // console.log(item.innerHTML);
            var j;
            var all_ul = item.getElementsByTagName("ul");
            for (j = 0; j < all_ul.length; j++) {
                console.log("<ul>: ")
                console.log(all_ul[j].innerHTML);
                all_ul[j].style.display = "none";
            }
            var all_ol = item.getElementsByTagName("ol");
            for (j = 0; j < all_ol.length; j++) {
                console.log("<ol>: ")
                console.log(all_ol[j].innerHTML);
                all_ol[j].style.display = "none";
            }
        }
        */
    };

    $( document ).ready( close_menus );

    // Let navbar fade away when scrolling down
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (currentScrollPos > 10 && currentScrollPos > prevScrollpos) {
            // Hide navbar
            var cssmenu = document.getElementById("cssmenu")
            cssmenu.style.opacity = 0;

            // When scrolling, also close all sub-menus
            close_menus();
        }
        else {
            // Make navbar visible
            document.getElementById("cssmenu").style.opacity = 1;
        }
        prevScrollpos = currentScrollPos;
    };
    </script>
    
<nav>
<div id="cssmenu">
  <ul>
     <li class="has-sub"><a href="#"><span title="The Debugging Book"><i class="fa fa-fw fa-bars"></i> </span><span class="menu_1">The Debugging Book&nbsp;<i class="fa fa-fw fa-wrench"></i></span></a>
        <ol>
           
<li><a href="https://www.debuggingbook.org/beta/"><span class="part_number"><i class="fa fa-fw fa-home"></i></span> About this book</a></li>
<li><a href="https://www.debuggingbook.org/beta/html/00_Table_of_Contents.html"><i class="fa fa-fw fa-sitemap"></i></span> Sitemap</a></li>
<li class="has-sub"><a href="01_Intro.html" class="chapters"><span class="part_number">I</span> Whetting Your Appetite <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tours.html">Tours through the Book</a></li>
<li><a href="Intro_Debugging.html">Introduction to Debugging</a></li>
</ul><li class="has-sub"><a href="02_Observing.html" class="chapters"><span class="part_number">II</span> Observing Executions <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracer.html">Tracing Executions</a></li>
<li><a href="Debugger.html" class="this_page">How Debuggers Work</a></li>
<li><a href="Assertions.html">Asserting Expectations</a></li>
</ul><li class="has-sub"><a href="03_Dependencies.html" class="chapters"><span class="part_number">III</span> Flows and Dependencies <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Slicer.html">Tracking Failure Origins</a></li>
</ul><li class="has-sub"><a href="04_Reducing.html" class="chapters"><span class="part_number">IV</span> Reducing Failure Causes <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="DeltaDebugger.html">Reducing Failure-Inducing Inputs</a></li>
<li><a href="ChangeDebugger.html">Isolating Failure-Inducing Changes</a></li>
</ul><li class="has-sub"><a href="05_Abstracting.html" class="chapters"><span class="part_number">V</span> Abstracting Failures <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="StatisticalDebugger.html">Statistical Debugging</a></li>
<li><a href="DynamicInvariants.html">Mining Function Specifications</a></li>
<li><a href="DDSetDebugger.html">Generalizing Failure Circumstances</a></li>
<li><a href="PerformanceDebugger.html">Debugging Performance Issues</a></li>
</ul><li class="has-sub"><a href="06_Repairing.html" class="chapters"><span class="part_number">VI</span> Automatic Repair <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Repairer.html">Repairing Code Automatically</a></li>
</ul><li class="has-sub"><a href="07_In_the_Large.html" class="chapters"><span class="part_number">VII</span> Debugging in the Large <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracking.html">Tracking Bugs</a></li>
<li><a href="ChangeCounter.html">Where the Bugs are <strong class="new_chapter">&bull;</strong></a></li>
</ul><li class="has-sub"><a href="99_Appendices.html" class="chapters">Appendices <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="ExpectError.html">Error Handling</a></li>
<li><a href="Timer.html">Timer</a></li>
<li><a href="ClassDiagram.html">Class Diagrams</a></li>
<li><a href="StackInspector.html">Inspecting Call Stacks</a></li>
</ul>
           <li><a href="https://www.debuggingbook.org/beta/html/00_Index.html">Index (beta)</a></i></li>
        </ol>
     </li>
     <li class="has-sub"><a href="#"><span title="How Debuggers Work"><i class="fa fa-fw fa-list-ul"></i></span> <span class="menu_2">How Debuggers Work</span></a>
           <ul><li class="has-sub"><a href="#Synopsis"><i class="fa fa-fw fa-map"></i> Synopsis</a>
</li><li class="has-sub"><a href="#Debuggers">&nbsp;&bull;&nbsp;&nbsp; Debuggers</a>
</li><li class="has-sub"><a href="#Debugger-Interaction">&nbsp;&bull;&nbsp;&nbsp; Debugger Interaction</a>
<ul><li class="has-sub"><a href="#A-Command-Dispatcher">A Command Dispatcher</a>
</li><li class="has-sub"><a href="#Excursion:-Implementing-execute()">Excursion: Implementing execute()</a>
</ul></li><li class="has-sub"><a href="#Printing-Values">&nbsp;&bull;&nbsp;&nbsp; Printing Values</a>
</li><li class="has-sub"><a href="#Listing-Source-Code">&nbsp;&bull;&nbsp;&nbsp; Listing Source Code</a>
</li><li class="has-sub"><a href="#Setting-Breakpoints">&nbsp;&bull;&nbsp;&nbsp; Setting Breakpoints</a>
</li><li class="has-sub"><a href="#Deleting-Breakpoints">&nbsp;&bull;&nbsp;&nbsp; Deleting Breakpoints</a>
</li><li class="has-sub"><a href="#Listings-with-Benefits">&nbsp;&bull;&nbsp;&nbsp; Listings with Benefits</a>
<ul><li class="has-sub"><a href="#Quitting">Quitting</a>
</ul></li><li class="has-sub"><a href="#Lessons-Learned"><i class="fa fa-fw fa-trophy"></i> Lessons Learned</a>
</li><li class="has-sub"><a href="#Next-Steps"><i class="fa fa-fw fa-arrows"></i> Next Steps</a>
</li><li class="has-sub"><a href="#Background"><i class="fa fa-fw fa-mortar-board"></i> Background</a>
</li><li class="has-sub"><a href="#Exercises"><i class="fa fa-fw fa-edit"></i> Exercises</a>
<ul><li class="has-sub"><a href="#Exercise-1:-Changing-State">Exercise 1: Changing State</a>
</li><li class="has-sub"><a href="#Exercise-2:-More-Commands">Exercise 2: More Commands</a>
</li><li class="has-sub"><a href="#Exercise-3:-Time-Travel-Debugging">Exercise 3: Time-Travel Debugging</a>
</ul></li></ul></li>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Resources"><i class="fa fa-fw fa-cube"></i> </span><span class="menu_3">Resources</span></a>
     <ul>
     <li><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/Debugger.ipynb" target="_blank" class="edit_as_notebook"><i class="fa fa-fw fa-edit"></i> Edit as Notebook</a></li>
     <li><a href="https://www.debuggingbook.org/beta/slides/Debugger.slides.html" target="_blank"><i class="fa fa-fw fa-video-camera"></i> View Slides</a></li>
     <li><a href="https://www.debuggingbook.org/beta/code/Debugger.py"><i class="fa fa-fw fa-download"></i> Download Code (.py)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/notebooks/Debugger.ipynb"><i class="fa fa-fw fa-download"></i> Download Notebook (.ipynb)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-code.zip"><i class="fa fa-fw fa-cube"></i> All Code (.zip)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-notebooks.zip"><i class="fa fa-fw fa-cube"></i> All Notebooks (.zip)</a></li>
     <li><a href="https://github.com/uds-se/debuggingbook/" target="_blank"><i class="fa fa-fw fa-github"></i> Project Page</a></li>
     <li><a href="ReleaseNotes.html" target="_blank"><i class="fa fa-fw fa-calendar"></i> Release Notes</a></li>
     </ul>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Share"><i class="fa fa-fw fa-comments"></i> </span> <span class="menu_4">Share</span></a>
        <ul>
            <li><a href="https://twitter.com/intent/tweet?text=I%20just%20read%20%22How%20Debuggers%20Work%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDebugger.html" target="popup" 
onclick="window.open('https://twitter.com/intent/tweet?text=I%20just%20read%20%22How%20Debuggers%20Work%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-twitter"></i> Share on Twitter</a>
            <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDebugger.html" target="popup" 
onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-facebook"></i> Share on Facebook</a>
            <li><a href="mailto:?subject=How%20Debuggers%20Work&body=I%20just%20read%20%22How%20Debuggers%20Work%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDebugger.html"><i class="fa fa-fw fa-envelope"></i> Share by Email</a>
            <li><a href="#citation" id="cite" onclick="revealCitation()"><i class="fa fa-fw fa-mortar-board"></i> Cite</a>
        </ul>
     </li>
     <li class="has-sub"><a href="#"><span title="Help"><i class="fa fa-fw fa-question-circle"></i></span> <span class="menu_5">Help</span></a>
        <ul>
          <li><a href="https://www.debuggingbook.org/beta/#Troubleshooting"><i class="fa fa-fw fa-wrench"></i> Troubleshooting</a></li>
          <li><a href="https://docs.python.org/3/tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Python Tutorial</a>
          <li><a href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Jupyter Notebook Tutorial</a>
          <li><a href="https://github.com/uds-se/debuggingbook/issues/" target="_blank"><i class="fa fa-fw fa-commenting"></i> Report an Issue</a></li>
        </ul>
     </li>
  </ul>
</div>
</nav>

    <article>
   <div tabindex="-1" id="notebook" class="border-box-sizing">
     <div class="container" id="notebook-container">

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="How-Debuggers-Work">How Debuggers Work<a class="anchor-link" href="#How-Debuggers-Work">&#182;</a></h1><p>Interactive <em>debuggers</em> are tools that allow you to selectively observe the program state during an execution.  In this chapter, you will learn how such debuggers work – by building your own debugger.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;4aZ0t7CWSjA&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/4aZ0t7CWSjA"
            frameborder="0"
            allowfullscreen

        ></iframe>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>You should have read the <a href="Tracer.html">Chapter on Tracing Executions</a>.</li>
<li>Again, knowing a bit of <em>Python</em> is helpful for understanding the code examples in the book.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/sys.html" class="import" target="_blank">sys</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Tracer.html" class="import" target="_blank">Tracer</a></span> <span class="kn">import</span> <span class="n">Tracer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis">&#182;</a></h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="Debugger.html" class="import" target="_blank">debuggingbook.Debugger</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>This chapter provides an interactive debugger for Python functions. The debugger is invoked as</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">function_to_be_observed</span><span class="p">()</span>
    <span class="o">...</span>
</pre></div>
<p>While running, you can enter <em>debugger commands</em> at the <code>(debugger)</code> prompt. Here's an example session:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">ret</span> <span class="o">=</span> <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="n">Calling</span> <span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>
<p><samp>(debugger) <b>help</b></samp></p>

<pre><code>break      -- Set a breakoint in given line. If no line is given, list all breakpoints
continue   -- Resume execution
delete     -- Delete breakoint in line given by `arg`.
           Without given line, clear all breakpoints
help       -- Give help on given `command`. If no command is given, give help on all
list       -- Show current function. If `arg` is given, show its source code.
print      -- Print an expression. If no expression is given, print all variables
quit       -- Finish execution
step       -- Execute up to the next line</code></pre>
<p><samp>(debugger) <b>break 14</b></samp></p>

<pre><code>Breakpoints: {14}</code></pre>
<p><samp>(debugger) <b>list</b></samp></p>

<pre><code>   1&gt; def remove_html_markup(s):  # type: ignore
   2      tag = False
   3      quote = False
   4      out = ""
   5  
   6      for c in s:
   7          if c == '&lt;' and not quote:
   8              tag = True
   9          elif c == '&gt;' and not quote:
  10              tag = False
  11          elif c == '"' or c == "'" and tag:
  12              quote = not quote
  13          elif not tag:
  14#             out = out + c
  15  
  16      return out</code></pre>
<p><samp>(debugger) <b>continue</b></samp></p>

<pre><code>                                         # tag = False, quote = False, out = '', c = 'a'
14             out = out + c</code></pre>
<p><samp>(debugger) <b>step</b></samp></p>

<pre><code>                                         # out = 'a'
6     for c in s:</code></pre>
<p><samp>(debugger) <b>print out</b></samp></p>

<pre><code>out = 'a'</code></pre>
<p><samp>(debugger) <b>quit</b></samp></p>
<p>The <code>Debugger</code> class can be easily extended in subclasses. A new method <code>NAME_command(self, arg)</code> will be invoked whenever a command named <code>NAME</code> is entered, with <code>arg</code> holding given command arguments (empty string if none).</p>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.49.1 (20210923.0004)
 -->
<!-- Pages: 1 -->
<svg width="291pt" height="569pt"
 viewBox="0.00 0.00 290.50 569.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 565)">
<g id="a_graph0"><a xlink:title="Debugger class hierarchy">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-565 286.5,-565 286.5,4 -4,4"/>
</a>
</g>
<!-- Debugger -->
<g id="node1" class="node">
<title>Debugger</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class Debugger:&#10;Interactive Debugger">
<polygon fill="none" stroke="black" points="21,-0.5 21,-196.5 146,-196.5 146,-0.5 21,-0.5"/>
<text text-anchor="start" x="51.5" y="-182.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">Debugger</text>
<polyline fill="none" stroke="black" points="21,-173.5 146,-173.5 "/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="Debugger">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, *, file: &lt;class &#39;TextIO&#39;&gt; = &lt;ipykernel.iostream.OutStream object at 0x1051cd820&gt;) &#45;&gt; None:&#10;Create a new interactive debugger.">
<text text-anchor="start" x="29.5" y="-162" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="break_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Set a breakoint in given line. If no line is given, list all breakpoints">
<text text-anchor="start" x="29.5" y="-150" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">break_command()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="#" xlink:title="command_method(self, command: str) &#45;&gt; Optional[Callable[[str], NoneType]]:&#10;Convert `command` into the method to be called.&#10;If the method is not found, return `None` instead.">
<text text-anchor="start" x="29.5" y="-139" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">command_method()</text>
</a>
</g>
<g id="a_node1_4"><a xlink:href="#" xlink:title="commands(self) &#45;&gt; List[str]:&#10;Return a list of commands">
<text text-anchor="start" x="29.5" y="-128" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">commands()</text>
</a>
</g>
<g id="a_node1_5"><a xlink:href="#" xlink:title="continue_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Resume execution">
<text text-anchor="start" x="29.5" y="-117" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">continue_command()</text>
</a>
</g>
<g id="a_node1_6"><a xlink:href="#" xlink:title="delete_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Delete breakoint in line given by `arg`.&#10;Without given line, clear all breakpoints">
<text text-anchor="start" x="29.5" y="-106" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">delete_command()</text>
</a>
</g>
<g id="a_node1_7"><a xlink:href="#" xlink:title="execute(self, command: str) &#45;&gt; None:&#10;Execute `command`">
<text text-anchor="start" x="29.5" y="-95" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">execute()</text>
</a>
</g>
<g id="a_node1_8"><a xlink:href="#" xlink:title="help_command(self, command: str = &#39;&#39;) &#45;&gt; None:&#10;Give help on given `command`. If no command is given, give help on all">
<text text-anchor="start" x="29.5" y="-84" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">help_command()</text>
</a>
</g>
<g id="a_node1_9"><a xlink:href="#" xlink:title="interaction_loop(self) &#45;&gt; None:&#10;Interact with the user">
<text text-anchor="start" x="29.5" y="-73" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">interaction_loop()</text>
</a>
</g>
<g id="a_node1_10"><a xlink:href="#" xlink:title="list_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Show current function. If `arg` is given, show its source code.">
<text text-anchor="start" x="29.5" y="-62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">list_command()</text>
</a>
</g>
<g id="a_node1_11"><a xlink:href="#" xlink:title="print_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Print an expression. If no expression is given, print all variables">
<text text-anchor="start" x="29.5" y="-51" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">print_command()</text>
</a>
</g>
<g id="a_node1_12"><a xlink:href="#" xlink:title="quit_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Finish execution">
<text text-anchor="start" x="29.5" y="-40" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">quit_command()</text>
</a>
</g>
<g id="a_node1_13"><a xlink:href="#" xlink:title="step_command(self, arg: str = &#39;&#39;) &#45;&gt; None:&#10;Execute up to the next line">
<text text-anchor="start" x="29.5" y="-29" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">step_command()</text>
</a>
</g>
<g id="a_node1_14"><a xlink:href="#" xlink:title="stop_here(self) &#45;&gt; bool:&#10;Return True if we should stop">
<text text-anchor="start" x="29.5" y="-18" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">stop_here()</text>
</a>
</g>
<g id="a_node1_15"><a xlink:href="#" xlink:title="traceit(self, frame: frame, event: str, arg: Any) &#45;&gt; None:&#10;Tracing function; called at every line. To be overloaded in subclasses.">
<text text-anchor="start" x="29.5" y="-8" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">traceit()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Tracer -->
<g id="node2" class="node">
<title>Tracer</title>
<g id="a_node2"><a xlink:href="Tracer.html" xlink:title="class Tracer:&#10;A class for tracing a piece of code. Use as `with Tracer(): block()`">
<polygon fill="none" stroke="black" points="6,-233.5 6,-352.5 161,-352.5 161,-233.5 6,-233.5"/>
<text text-anchor="start" x="64" y="-338.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">Tracer</text>
<polyline fill="none" stroke="black" points="6,-329.5 161,-329.5 "/>
<g id="a_node2_16"><a xlink:href="#" xlink:title="Tracer">
<g id="a_node2_17"><a xlink:href="Tracer.html" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Called at begin of `with` block. Turn tracing on.">
<text text-anchor="start" x="14.5" y="-318.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__enter__()</text>
</a>
</g>
<g id="a_node2_18"><a xlink:href="Tracer.html" xlink:title="__exit__(self, exc_tp: Type, exc_value: BaseException, exc_traceback: traceback) &#45;&gt; Optional[bool]:&#10;Called at end of `with` block. Turn tracing off.&#10;Return `None` if ok, not `None` if internal error.">
<text text-anchor="start" x="14.5" y="-307.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__exit__()</text>
</a>
</g>
<g id="a_node2_19"><a xlink:href="Tracer.html" xlink:title="__init__(self, file: &lt;class &#39;TextIO&#39;&gt; = &lt;ipykernel.iostream.OutStream object at 0x1051cd820&gt;) &#45;&gt; None:&#10;Create a new tracer.&#10;If `file` is given, output to `file` instead of stdout.">
<text text-anchor="start" x="14.5" y="-296.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node2_20"><a xlink:href="Tracer.html" xlink:title="traceit(self, frame: frame, event: str, arg: Any) &#45;&gt; None:&#10;Tracing function; called at every line. To be overloaded in subclasses.">
<text text-anchor="start" x="14.5" y="-285.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">traceit()</text>
</a>
</g>
<g id="a_node2_21"><a xlink:href="Tracer.html" xlink:title="_traceit(self, frame: frame, event: str, arg: Any) &#45;&gt; Optional[Callable]:&#10;Internal tracing function.">
<text text-anchor="start" x="14.5" y="-273.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">_traceit()</text>
</a>
</g>
<g id="a_node2_22"><a xlink:href="Tracer.html" xlink:title="changed_vars(self, new_vars: Dict[str, Any]) &#45;&gt; Dict[str, Any]:&#10;Track changed variables, based on `new_vars` observed.">
<text text-anchor="start" x="14.5" y="-262.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">changed_vars()</text>
</a>
</g>
<g id="a_node2_23"><a xlink:href="Tracer.html" xlink:title="log(self, *objects: Any, sep: str = &#39; &#39;, end: str = &#39;\n&#39;, flush: bool = True) &#45;&gt; None:&#10;Like `print()`, but always sending to `file` given at initialization,&#10;and flushing by default.">
<text text-anchor="start" x="14.5" y="-251.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">log()</text>
</a>
</g>
<g id="a_node2_24"><a xlink:href="Tracer.html" xlink:title="print_debugger_status(self, frame: frame, event: str, arg: Any) &#45;&gt; None:&#10;Show current source line and changed vars">
<text text-anchor="start" x="14.5" y="-240.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">print_debugger_status()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Debugger&#45;&gt;Tracer -->
<g id="edge1" class="edge">
<title>Debugger&#45;&gt;Tracer</title>
<path fill="none" stroke="black" d="M83.5,-196.6C83.5,-205.6 83.5,-214.58 83.5,-223.25"/>
<polygon fill="none" stroke="black" points="80,-223.25 83.5,-233.25 87,-223.25 80,-223.25"/>
</g>
<!-- StackInspector -->
<g id="node3" class="node">
<title>StackInspector</title>
<g id="a_node3"><a xlink:href="StackInspector.html" xlink:title="class StackInspector:&#10;Provide functions to inspect the stack">
<polygon fill="none" stroke="black" points="0,-389.5 0,-560.5 167,-560.5 167,-389.5 0,-389.5"/>
<text text-anchor="start" x="37" y="-546.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">StackInspector</text>
<polyline fill="none" stroke="black" points="0,-537.5 167,-537.5 "/>
<g id="a_node3_25"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_26"><a xlink:href="StackInspector.html" xlink:title="_generated_function_cache = {}">
<text text-anchor="start" x="8.5" y="-525" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">_generated_function_cache</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="black" points="0,-518.5 167,-518.5 "/>
<g id="a_node3_27"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_28"><a xlink:href="StackInspector.html" xlink:title="caller_frame(self) &#45;&gt; frame:&#10;Return the frame of the caller.">
<text text-anchor="start" x="26.5" y="-506" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">caller_frame()</text>
</a>
</g>
<g id="a_node3_29"><a xlink:href="StackInspector.html" xlink:title="caller_function(self) &#45;&gt; Callable:&#10;Return the calling function">
<text text-anchor="start" x="26.5" y="-495" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">caller_function()</text>
</a>
</g>
<g id="a_node3_30"><a xlink:href="StackInspector.html" xlink:title="caller_globals(self) &#45;&gt; Dict[str, Any]:&#10;Return the globals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-484" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">caller_globals()</text>
</a>
</g>
<g id="a_node3_31"><a xlink:href="StackInspector.html" xlink:title="caller_locals(self) &#45;&gt; Dict[str, Any]:&#10;Return the locals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-473" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">caller_locals()</text>
</a>
</g>
<g id="a_node3_32"><a xlink:href="StackInspector.html" xlink:title="caller_location(self) &#45;&gt; Tuple[Callable, int]:&#10;Return the location (func, lineno) of the caller.">
<text text-anchor="start" x="26.5" y="-462" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">caller_location()</text>
</a>
</g>
<g id="a_node3_33"><a xlink:href="StackInspector.html" xlink:title="create_function(self, frame: frame) &#45;&gt; Callable:&#10;Create function for given frame">
<text text-anchor="start" x="26.5" y="-451" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">create_function()</text>
</a>
</g>
<g id="a_node3_34"><a xlink:href="StackInspector.html" xlink:title="is_internal_error(self, exc_tp: Type, exc_value: BaseException, exc_traceback: traceback) &#45;&gt; bool:&#10;Return True if exception was raised from `StackInspector` or a subclass.">
<text text-anchor="start" x="26.5" y="-440" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">is_internal_error()</text>
</a>
</g>
<g id="a_node3_35"><a xlink:href="StackInspector.html" xlink:title="our_frame(self, frame: frame) &#45;&gt; bool:&#10;Return true if `frame` is in the current (inspecting) class.">
<text text-anchor="start" x="26.5" y="-429" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">our_frame()</text>
</a>
</g>
<g id="a_node3_36"><a xlink:href="StackInspector.html" xlink:title="search_frame(self, name: str, frame: Optional[frame] = None) &#45;&gt; Tuple[Optional[frame], Optional[Callable]]:&#10;Return a pair (`frame`, `item`)&#10;in which the function `name` is defined as `item`.">
<text text-anchor="start" x="26.5" y="-418" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">search_frame()</text>
</a>
</g>
<g id="a_node3_37"><a xlink:href="StackInspector.html" xlink:title="search_func(self, name: str, frame: Optional[frame] = None) &#45;&gt; Optional[Callable]:&#10;Search in callers for a definition of the function `name`">
<text text-anchor="start" x="26.5" y="-407" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">search_func()</text>
</a>
</g>
<g id="a_node3_38"><a xlink:href="StackInspector.html" xlink:title="unknown(self) &#45;&gt; None">
<text text-anchor="start" x="26.5" y="-396" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">unknown()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Tracer&#45;&gt;StackInspector -->
<g id="edge2" class="edge">
<title>Tracer&#45;&gt;StackInspector</title>
<path fill="none" stroke="black" d="M83.5,-352.94C83.5,-361.43 83.5,-370.34 83.5,-379.32"/>
<polygon fill="none" stroke="black" points="80,-379.46 83.5,-389.46 87,-379.46 80,-379.46"/>
</g>
<!-- Legend -->
<g id="node4" class="node">
<title>Legend</title>
<text text-anchor="start" x="164.5" y="-116" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="10.00" fill="#6a0dad">Legend</text>
<text text-anchor="start" x="164.5" y="-106" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="171.5" y="-106" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text text-anchor="start" x="164.5" y="-96" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="171.5" y="-96" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text text-anchor="start" x="164.5" y="-86" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="171.5" y="-86" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text text-anchor="start" x="164.5" y="-76.8" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Debuggers">Debuggers<a class="anchor-link" href="#Debuggers">&#182;</a></h2><p><em>Interactive Debuggers</em> (or short <em>debuggers</em>) are tools that allow you to observe program executions. A debugger typically offers the following features:</p>
<ul>
<li><em>Run</em> the program</li>
<li>Define <em>conditions</em> under which the execution should <em>stop</em> and hand over control to the debugger. Conditions include<ul>
<li>a particular location is reached</li>
<li>a particular variable takes a particular value</li>
<li>a particular variables is accessed</li>
<li>or some other condition of choice.</li>
</ul>
</li>
<li>When the program stops, you can <em>observe</em> the current state, including<ul>
<li>the current location</li>
<li>variables and their values</li>
<li>the current function and its callers</li>
</ul>
</li>
<li>When the program stops, you can <em>step</em> through program execution, having it stop at the next instruction again.</li>
<li>Finally, you can also <em>resume</em> execution to the next stop.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This functionality often comes as a <em>command-line interface</em>, typing commands at a prompt; or as a <em>graphical user interface</em>, selecting commands from the screen. Debuggers can come as standalone tools, or be integrated into a programming environment of choice.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Debugger interaction typically follows a <em>loop</em> pattern. First, you identify the location(s) you want to inspect, and tell the debugger to stop execution once one of these <em>breakpoints</em> is reached. Here's a command that could instruct a command-line debugger to stop at Line 239:</p>

<pre><code>(debugger) break 239
(debugger) _</code></pre>
<p>Then you have the debugger resume or start execution. The debugger will stop at the given location.</p>

<pre><code>(debugger) continue
Line 239: s = x
(debugger) _</code></pre>
<p>When it stops at the given location, you use debugger commands to inspect the state (and check whether things are as expected).</p>

<pre><code>(debugger) print s
s = 'abc'
(debugger) _</code></pre>
<p>You can then step through the program, executing more lines.</p>

<pre><code>(debugger) step
Line 240: c = s[0]
(debugger) print c
c = 'a'
(debugger) _</code></pre>
<p>You can also define new stop conditions, investigating other locations, variables, and conditions.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Debugger-Interaction">Debugger Interaction<a class="anchor-link" href="#Debugger-Interaction">&#182;</a></h2><p>Let us now show how to build such a debugger.  The key idea of an <em>interactive</em> debugger is to set up the <em>tracing function</em> such that it actually <em>asks</em> what to do next, prompting you to enter a <em>command</em>. For the sake of simplicity, we collect such a command interactively from a command line, using the Python <code>input()</code> function.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our debugger holds a number of variables to indicate its current status:</p>
<ul>
<li><code>stepping</code> is True whenever the user wants to step into the next line.</li>
<li><code>breakpoints</code> is a set of breakpoints (line numbers)</li>
<li><code>interact</code> is True while the user stays at one position.</li>
</ul>
<p>We also store the current tracing information in three attributes <code>frame</code>, <code>event</code>, and <code>arg</code>. The variable <code>local_vars</code> holds local variables.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/types.html" class="import" target="_blank">types</a></span> <span class="kn">import</span> <span class="n">FrameType</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interactive Debugger&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">TextIO</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new interactive debugger.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stepping</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">:</span> <span class="n">FrameType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">local_vars</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>traceit()</code> method is the main entry point for our debugger. If we should stop, we go into user interaction.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">traceit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">FrameType</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Tracing function; called at every line. To be overloaded in subclasses.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_vars</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span>  <span class="c1"># Dereference exactly once</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event</span> <span class="o">=</span> <span class="n">event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_here</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interaction_loop</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We stop whenever we are stepping through the program or reach a breakpoint:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">stop_here</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return True if we should stop&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepping</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our interaction loop shows the current status, reads in commands, and executes them.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">interaction_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Interact with the user&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_debugger_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interact</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">interact</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;(debugger) &quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For a moment, let us implement two commands, <code>step</code> and <code>continue</code>. <code>step</code> steps through the program:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">step_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute up to the next line&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stepping</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interact</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">continue_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resume execution&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stepping</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interact</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>execute()</code> method dispatches between these two.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step_command</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">command</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continue_command</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our debugger is now ready to run! Let us invoke it on the buggy <code>remove_html_markup()</code> variant from the <a href="Intro_Debugging.html">Introduction to Debugging</a>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We invoke the debugger just like <code>Tracer</code>, using a <code>with</code> clause. The code</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>
<p>gives us a debugger prompt</p>

<pre><code>(debugger) _</code></pre>
<p>where we can enter one of our two commands.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us do two steps through the program and then resume execution:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="nb">input</span><span class="p">,</span> <span class="n">next_inputs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;step&#39;, &#39;step&#39;, &#39;continue&#39;]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2     tag = False
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # tag = False
3     quote = False
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Try this out for yourself by running the above invocation in the interactive notebook! If you are reading the Web version, the top menu entry <code>Resources</code> -&gt; <code>Edit as Notebook</code> will do the trick. Navigate to the above invocation and press <code>Shift</code>+<code>Enter</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="A-Command-Dispatcher">A Command Dispatcher<a class="anchor-link" href="#A-Command-Dispatcher">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>execute()</code> function is still a bit rudimentary. A true command-line tool should provide means to tell which commands are available (<code>help</code>), automatically split arguments, and not stand in line of extensibility.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We therefore implement a better <code>execute()</code> method which does all that. Our revised <code>execute()</code> method <em>inspects</em> its class for methods that end in <code>_command()</code>, and automatically registers their names as commands. Hence, with the above, we already get <code>step</code> and <code>continue</code> as possible commands.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Implementing-execute()">
<summary>Implementing execute()</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us detail how we implement <code>execute()</code>. The <code>commands()</code> method returns a list of all commands (as strings) from the class.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of commands&quot;&quot;&quot;</span>

        <span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="n">method</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_command&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_command&#39;</span><span class="p">)]</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cmds</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Debugger</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">commands</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;continue&#39;, &#39;step&#39;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>command_method()</code> method converts a given command (or its abbrevation) into a method to be called.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">help_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">command_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Convert `command` into the method to be called.</span>
<span class="sd">           If the method is not found, return `None` instead.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Comment</span>

        <span class="n">possible_cmds</span> <span class="o">=</span> <span class="p">[</span><span class="n">possible_cmd</span> <span class="k">for</span> <span class="n">possible_cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">()</span>
                         <span class="k">if</span> <span class="n">possible_cmd</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">command</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_cmds</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">help_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="n">possible_cmds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">+</span> <span class="s1">&#39;_command&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Debugger</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">command_method</span><span class="p">(</span><span class="s2">&quot;step&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&lt;bound method Debugger.step_command of &lt;__main__.Debugger object at 0x1056557c0&gt;&gt;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Debugger</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">command_method</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&lt;bound method Debugger.step_command of &lt;__main__.Debugger object at 0x105655520&gt;&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The revised <code>execute()</code> method now determines this method and executes it with the given argument.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute `command`&quot;&quot;&quot;</span>

        <span class="n">sep</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">command</span><span class="p">[:</span><span class="n">sep</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">command</span><span class="p">[</span><span class="n">sep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_method</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If <code>command_method()</code> cannot find the command, or finds more than one matching the prefix, it invokes the <code>help</code> command providing additional assistance. <code>help</code> draws extra info on each command from its documentation string.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">help_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Give help on given `command`. If no command is given, give help on all&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="n">possible_cmds</span> <span class="o">=</span> <span class="p">[</span><span class="n">possible_cmd</span> <span class="k">for</span> <span class="n">possible_cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">()</span>
                             <span class="k">if</span> <span class="n">possible_cmd</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">command</span><span class="p">)]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_cmds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown command </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">. Possible commands are:&quot;</span><span class="p">)</span>
                <span class="n">possible_cmds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_cmds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ambiguous command </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">. Possible expansions are:&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">possible_cmds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">possible_cmds</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_method</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cmd</span><span class="si">:</span><span class="s2">10</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="vm">__doc__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Debugger</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>continue   -- Resume execution
help       -- Give help on given `command`. If no command is given, give help on all
step       -- Execute up to the next line
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Debugger</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unknown command &#39;foo&#39;. Possible commands are:
continue   -- Resume execution
help       -- Give help on given `command`. If no command is given, give help on all
step       -- Execute up to the next line
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Printing-Values">Printing Values<a class="anchor-link" href="#Printing-Values">&#182;</a></h2><p>With <code>execute()</code>, we can now easily extend our class – all it takes is for a new command <code>NAME</code> is a new <code>NAME_command()</code> method. Let us start by providing a <code>print</code> command to print all variables. We use similar code as for the <code>Tracer</code> class in the <a href="Tracer.html">chapter on tracing</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">print_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Print an expression. If no expression is given, print all variables&quot;&quot;&quot;</span>

        <span class="nb">vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2     tag = False
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # tag = False
3     quote = False
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # quote = False
4     out = &#34;&#34;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>print</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s = &#39;abc&#39;
tag = False
quote = False
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us extend <code>print</code> such that if an argument is given, it only evaluates and prints out this argument.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">print_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Print an expression. If no expression is given, print all variables&quot;&quot;&quot;</span>

        <span class="nb">vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_vars</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">arg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">vars</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>p s</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s = &#39;abc&#39;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>c</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note how we would abbreviate commands to speed things up. The argument to <code>print</code> can be any Python expression:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>print (s[0], 2 + 2)</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(s[0], 2 + 2) = (&#39;a&#39;, 4)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>help</code> command also properly lists <code>print</code> as a possible command:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>help print</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>print      -- Print an expression. If no expression is given, print all variables
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Listing-Source-Code">Listing Source Code<a class="anchor-link" href="#Listing-Source-Code">&#182;</a></h2><p>We implement a <code>list</code> command that shows the source code of the current function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/inspect.html" class="import" target="_blank">inspect</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">getsourcelines</span>  <span class="c1"># like inspect.getsourcelines(), but in color</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">list_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Show current function.&quot;&quot;&quot;</span>

        <span class="n">source_lines</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">=</span> <span class="n">getsourcelines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">source_lines</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">line_number</span><span class="si">:</span><span class="s1">4</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>list</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>   1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
   2     tag = <span class="ansi-blue-fg">False</span>
   3     quote = <span class="ansi-blue-fg">False</span>
   4     out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
   5 
   6     <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
   7         <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
   8             tag = <span class="ansi-blue-fg">True</span>
   9         <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
  10             tag = <span class="ansi-blue-fg">False</span>
  11         <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
  12             quote = <span class="ansi-magenta-fg">not</span> quote
  13         <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
  14             out = out + c
  15 
  16     <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Setting-Breakpoints">Setting Breakpoints<a class="anchor-link" href="#Setting-Breakpoints">&#182;</a></h2><p>Stepping through the program line by line is a bit cumbersome. We therefore implement <em>breakpoints</em> – a set of lines that cause the program to be interrupted as soon as this line is met.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">break_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set a breakoint in given line. If no line is given, list all breakpoints&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">arg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Breakpoints:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's an example, setting a breakpoint at the end of the loop:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>break 14</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoints: {14}
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # tag = False, quote = False, out = &#39;&#39;, c = &#39;a&#39;
14             out = out + c
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>print</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s = &#39;abc&#39;
tag = False
quote = False
out = &#39;&#39;
c = &#39;a&#39;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # out = &#39;a&#39;, c = &#39;b&#39;
14             out = out + c
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # out = &#39;ab&#39;, c = &#39;c&#39;
14             out = out + c
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">quiz</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">What happens if we enter the command <code>break 2 + 3</code>?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="d3d94ab2-2c18-11ec-9d9d-acde48001122" id="d3d94ab2-2c18-11ec-9d9d-acde48001122-1" onclick="clear_selection('d3d94ab2-2c18-11ec-9d9d-acde48001122')">
        <label id="d3d94ab2-2c18-11ec-9d9d-acde48001122-1-label" for="d3d94ab2-2c18-11ec-9d9d-acde48001122-1">A breakpoint is set in Line 2.</label><br>

        <input type="radio" name="d3d94ab2-2c18-11ec-9d9d-acde48001122" id="d3d94ab2-2c18-11ec-9d9d-acde48001122-2" onclick="clear_selection('d3d94ab2-2c18-11ec-9d9d-acde48001122')">
        <label id="d3d94ab2-2c18-11ec-9d9d-acde48001122-2-label" for="d3d94ab2-2c18-11ec-9d9d-acde48001122-2">A breakpoint is set in Line 5.</label><br>

        <input type="radio" name="d3d94ab2-2c18-11ec-9d9d-acde48001122" id="d3d94ab2-2c18-11ec-9d9d-acde48001122-3" onclick="clear_selection('d3d94ab2-2c18-11ec-9d9d-acde48001122')">
        <label id="d3d94ab2-2c18-11ec-9d9d-acde48001122-3-label" for="d3d94ab2-2c18-11ec-9d9d-acde48001122-3">Two breakpoints are set in Lines 2 and 3.</label><br>

        <input type="radio" name="d3d94ab2-2c18-11ec-9d9d-acde48001122" id="d3d94ab2-2c18-11ec-9d9d-acde48001122-4" onclick="clear_selection('d3d94ab2-2c18-11ec-9d9d-acde48001122')">
        <label id="d3d94ab2-2c18-11ec-9d9d-acde48001122-4-label" for="d3d94ab2-2c18-11ec-9d9d-acde48001122-4">The debugger raises a <code>ValueError</code> exception.</label><br>

    </div>
    </p>
    <input id="d3d94ab2-2c18-11ec-9d9d-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('d3d94ab2-2c18-11ec-9d9d-acde48001122', 16, 0, '12345 % 7')">
    <span class="quiz_hint" id="d3d94ab2-2c18-11ec-9d9d-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Try it out yourself by executing the above code block!</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Deleting-Breakpoints">Deleting Breakpoints<a class="anchor-link" href="#Deleting-Breakpoints">&#182;</a></h2><p>To delete breakpoints, we introduce a <code>delete</code> command:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">delete_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Delete breakoint in line given by `arg`.</span>
<span class="sd">           Without given line, clear all breakpoints&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">arg</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No such breakpoint: </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Breakpoints:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>break 16</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoints: {16}
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # tag = False, quote = False, out = &#39;abc&#39;, c = &#39;c&#39;
16     return out
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>print</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s = &#39;abc&#39;
tag = False
quote = False
out = &#39;abc&#39;
c = &#39;c&#39;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>delete 16</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoints: set()
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">What does the command <code>delete</code> (without argument) do?</div>
    </p>
    <p>
    <div class="quiz_options" title="Check all that apply.">

        <input type="checkbox" name="d3e07850-2c18-11ec-9d9d-acde48001122" id="d3e07850-2c18-11ec-9d9d-acde48001122-1" onclick="clear_selection('d3e07850-2c18-11ec-9d9d-acde48001122')">
        <label id="d3e07850-2c18-11ec-9d9d-acde48001122-1-label" for="d3e07850-2c18-11ec-9d9d-acde48001122-1">It deletes all breakpoints</label><br>

        <input type="checkbox" name="d3e07850-2c18-11ec-9d9d-acde48001122" id="d3e07850-2c18-11ec-9d9d-acde48001122-2" onclick="clear_selection('d3e07850-2c18-11ec-9d9d-acde48001122')">
        <label id="d3e07850-2c18-11ec-9d9d-acde48001122-2-label" for="d3e07850-2c18-11ec-9d9d-acde48001122-2">It deletes the source code</label><br>

        <input type="checkbox" name="d3e07850-2c18-11ec-9d9d-acde48001122" id="d3e07850-2c18-11ec-9d9d-acde48001122-3" onclick="clear_selection('d3e07850-2c18-11ec-9d9d-acde48001122')">
        <label id="d3e07850-2c18-11ec-9d9d-acde48001122-3-label" for="d3e07850-2c18-11ec-9d9d-acde48001122-3">It lists all breakpoints</label><br>

        <input type="checkbox" name="d3e07850-2c18-11ec-9d9d-acde48001122" id="d3e07850-2c18-11ec-9d9d-acde48001122-4" onclick="clear_selection('d3e07850-2c18-11ec-9d9d-acde48001122')">
        <label id="d3e07850-2c18-11ec-9d9d-acde48001122-4-label" for="d3e07850-2c18-11ec-9d9d-acde48001122-4">It stops execution</label><br>

    </div>
    </p>
    <input id="d3e07850-2c18-11ec-9d9d-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('d3e07850-2c18-11ec-9d9d-acde48001122', 10, 1, '[n for n in range(2 // 2, 2 * 2) if n % 2 / 2]')">
    <span class="quiz_hint" id="d3e07850-2c18-11ec-9d9d-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Listings-with-Benefits">Listings with Benefits<a class="anchor-link" href="#Listings-with-Benefits">&#182;</a></h2><p>Let us extend <code>list</code> a bit such that</p>
<ol>
<li>it can also list a given function, and </li>
<li>it shows the current line (<code>&gt;</code>) as well as breakpoints (<code>#</code>)</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">list_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Show current function. If `arg` is given, show its source code.&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">source_lines</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">current_line</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">source_lines</span><span class="p">,</span> <span class="n">line_number</span> <span class="o">=</span> \
                    <span class="n">getsourcelines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="p">)</span>
                <span class="n">current_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">source_lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">line_number</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">source_lines</span><span class="p">:</span>
            <span class="n">spacer</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
            <span class="k">if</span> <span class="n">line_number</span> <span class="o">==</span> <span class="n">current_line</span><span class="p">:</span>
                <span class="n">spacer</span> <span class="o">=</span> <span class="s1">&#39;&gt;&#39;</span>
            <span class="k">elif</span> <span class="n">line_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span><span class="p">:</span>
                <span class="n">spacer</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">line_number</span><span class="si">:</span><span class="s1">4</span><span class="si">}{</span><span class="n">spacer</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">line_number</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>break 14</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoints: {14}
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>list</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>   1&gt; <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
   2      tag = <span class="ansi-blue-fg">False</span>
   3      quote = <span class="ansi-blue-fg">False</span>
   4      out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
   5  
   6      <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
   7          <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
   8              tag = <span class="ansi-blue-fg">True</span>
   9          <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
  10              tag = <span class="ansi-blue-fg">False</span>
  11          <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
  12              quote = <span class="ansi-magenta-fg">not</span> quote
  13          <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
  14#             out = out + c
  15  
  16      <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                         # tag = False, quote = False, out = &#39;&#39;, c = &#39;a&#39;
14             out = out + c
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>delete</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoints: set()
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>list</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>   1  <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
   2      tag = <span class="ansi-blue-fg">False</span>
   3      quote = <span class="ansi-blue-fg">False</span>
   4      out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
   5  
   6      <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
   7          <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
   8              tag = <span class="ansi-blue-fg">True</span>
   9          <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
  10              tag = <span class="ansi-blue-fg">False</span>
  11          <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
  12              quote = <span class="ansi-magenta-fg">not</span> quote
  13          <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
  14&gt;             out = out + c
  15  
  16      <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>continue</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Quitting">Quitting<a class="anchor-link" href="#Quitting">&#182;</a></h3><p>In the Python debugger interface, we can only observe, but not alter the control flow. To make sure we can always exit out of our debugging session, we introduce a <code>quit</code> command that deletes all breakpoints and resumes execution until the observed function finishes.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Debugger</span><span class="p">(</span><span class="n">Debugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">quit_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Finish execution&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">breakpoints</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stepping</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interact</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With this, our command palette is pretty complete, and we can use our debugger to happily inspect Python executions.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling remove_html_markup(s = &#39;abc&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>help</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>break      -- Set a breakoint in given line. If no line is given, list all breakpoints
continue   -- Resume execution
delete     -- Delete breakoint in line given by `arg`.
           Without given line, clear all breakpoints
help       -- Give help on given `command`. If no command is given, give help on all
list       -- Show current function. If `arg` is given, show its source code.
print      -- Print an expression. If no expression is given, print all variables
quit       -- Finish execution
step       -- Execute up to the next line
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>quit</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned<a class="anchor-link" href="#Lessons-Learned">&#182;</a></h2><ul>
<li><em>Debugging hooks</em> from interpreted languages allow for simple interactive debugging.</li>
<li>A command-line debugging framework can be very easily extended with additional functionality.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps<a class="anchor-link" href="#Next-Steps">&#182;</a></h2><p>In the next chapter, we will see how <a href="Assertions.html">assertions</a> check correctness at runtime.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background<a class="anchor-link" href="#Background">&#182;</a></h2><p>The command-line interface in this chapter is modeled after <a href="https://www.gnu.org/software/gdb/">GDB, the GNU debugger</a>, whose interface in turn goes back to earlier command-line debuggers such as <a href="https://en.wikipedia.org/wiki/Dbx_%28debugger%29">dbx</a>. All modern debuggers build on the functionality and concepts realized in these debuggers, be it breakpoints,  stepping through programs, or inspecting program state.</p>
<p>The concept of time travel debugging (see the Exercises, below) has been invented (and reinvented) many times. One of the most impactful tools comes from King et al. [<a href="https://www.usenix.org/conference/2005-usenix-annual-technical-conference/debugging-operating-systems-time-traveling">Samuel T. King <em>et al</em>, 2005</a>], integrating <em>a time-traveling virtual machine</em> (TTVM) for debugging operating systems, integrated into GDB. The recent <a href="https://rr-project.org">record+replay "rr" debugger</a> also implements time travel debugging on top of the GDB command line debugger; it is applicable for general-purpose programs and available as open source.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises<a class="anchor-link" href="#Exercises">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-Changing-State">Exercise 1: Changing State<a class="anchor-link" href="#Exercise-1:-Changing-State">&#182;</a></h3><p>Some Python implementations allow to alter the state, by assigning values to <code>frame.f_locals</code>. Implement a <code>assign VAR=VALUE</code> command that allows to change the value of (local) variable <code>VAR</code> to the new value <code>VALUE</code>.</p>
<p>Note: As detailed in <a href="https://utcc.utoronto.ca/~cks/space/blog/python/FLocalsAndTraceFunctions">this blog post</a>, 
<code>frame.f_locals</code> is re-populated with every access, so assign to our local alias <code>self.local_vars</code> instead.</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/Debugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-2:-More-Commands">Exercise 2: More Commands<a class="anchor-link" href="#Exercise-2:-More-Commands">&#182;</a></h3><p>Extending the <code>Debugger</code> class with extra features and commands is a breeze. The following commands are inspired from <a href="https://www.gnu.org/software/gdb/">the GNU command-line debugger (GDB)</a>:</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Named-breakpoints-(%22break%22)">Named breakpoints ("break")<a class="anchor-link" href="#Named-breakpoints-(%22break%22)">&#182;</a></h4><p>With <code>break FUNCTION</code> and <code>delete FUNCTION</code>, set and delete a breakpoint at <code>FUNCTION</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Step-over-functions-(%22next%22)">Step over functions ("next")<a class="anchor-link" href="#Step-over-functions-(%22next%22)">&#182;</a></h4><p>When stopped at a function call, the <code>next</code> command should execute the entire call, stopping when the function returns. (In contrast, <code>step</code> stops at the first line of the function called.)</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Print-call-stack-(%22where%22)">Print call stack ("where")<a class="anchor-link" href="#Print-call-stack-(%22where%22)">&#182;</a></h4><p>Implement a <code>where</code> command that shows the stack of calling functions.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Move-up-and-down-the-call-stack-(%22up%22-and-%22down%22)">Move up and down the call stack ("up" and "down")<a class="anchor-link" href="#Move-up-and-down-the-call-stack-(%22up%22-and-%22down%22)">&#182;</a></h4><p>After entering the <code>up</code> command, explore the source and variables of the <em>calling</em> function rather than the current function. Use <code>up</code> repeatedly to move further up the stack. <code>down</code> returns to the caller.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Execute-until-line-(%22until%22)">Execute until line ("until")<a class="anchor-link" href="#Execute-until-line-(%22until%22)">&#182;</a></h4><p>With <code>until LINE</code>, resume execution until a line greater than <code>LINE</code> is reached. If <code>LINE</code> is not given, resume execution until a line greater than the current is reached. This is useful to avoid stepping through multiple loop iterations.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Execute-until-return-(%22finish%22)">Execute until return ("finish")<a class="anchor-link" href="#Execute-until-return-(%22finish%22)">&#182;</a></h4><p>With <code>finish</code>, resume execution until the current function returns.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Watchpoints-(%22watch%22)">Watchpoints ("watch")<a class="anchor-link" href="#Watchpoints-(%22watch%22)">&#182;</a></h4><p>With <code>watch CONDITION</code>, stop execution as soon as <code>CONDITION</code> changes its value. (Use the code from our <code>EventTracer</code> class in the <a href="Tracer.html">chapter on Tracing</a>.) <code>delete CONDITION</code> removes the watchpoint. Keep in mind that some variable names may not exist at all times.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-3:-Time-Travel-Debugging">Exercise 3: Time-Travel Debugging<a class="anchor-link" href="#Exercise-3:-Time-Travel-Debugging">&#182;</a></h3><p>Rather than inspecting a function at the moment it executes, you can also <em>record</em> the entire state (call stack, local variables, etc.) during execution, and then run an interactive session to step through the recorded execution. Your time travel debugger would be invoked as</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">TimeTravelDebugger</span><span class="p">():</span>
    <span class="n">function_to_be_tracked</span><span class="p">()</span>
    <span class="o">...</span>
</pre></div>
<p>The interaction then starts at the end of the <code>with</code> block.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Part-1:-Recording-Values">Part 1: Recording Values<a class="anchor-link" href="#Part-1:-Recording-Values">&#182;</a></h4><p>Start with a subclass of <code>Tracer</code> from the <a href="Tracer.html">chapter on tracing</a> (say, <code>TimeTravelTracer</code>) to execute a program while recording all values. Keep in mind that recording even only local variables at each step quickly consumes large amounts of memory. As an alternative, consider recording only <em>changes</em> to variables, with the option to restore an entire state from a baseline and later changes.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Part-2:-Command-Line-Interface">Part 2: Command Line Interface<a class="anchor-link" href="#Part-2:-Command-Line-Interface">&#182;</a></h4><p>Create <code>TimeTravelDebugger</code> as subclass of both <code>TimeTravelTracer</code> and <code>Debugger</code> to provide a command line interface as with <code>Debugger</code>, including additional commands which get you back to earlier states:</p>
<ul>
<li><code>back</code> is like <code>step</code>, except that you go one line back</li>
<li><code>restart</code> gets you to the beginning of the execution</li>
<li><code>rewind</code> gets you to the beginning of the current function invocation</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Part-3:-Graphical-User-Interface">Part 3: Graphical User Interface<a class="anchor-link" href="#Part-3:-Graphical-User-Interface">&#182;</a></h4><p>Create <code>GUItimeTravelDebugger</code> to provide a <em>graphical user interface</em> that allows you to explore a recorded execution, using HTML and JavaScript.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's a simple example to get you started. Assume you have recorded the following line numbers and variable values:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recording</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;def&quot;</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;def&quot;</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;ghi&quot;</span><span class="p">}),</span>
    <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;ghi&quot;</span><span class="p">}),</span>
<span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Then, the following function will provide a <em>slider</em> that will allow you to explore these values:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">HTML</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">slider</span><span class="p">(</span><span class="n">rec</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">lines_over_time</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">]</span>
    <span class="n">vars_over_time</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">:</span>
        <span class="n">vars_over_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                                        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="c1"># print(lines_over_time)</span>
    <span class="c1"># print(vars_over_time)</span>

    <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    &lt;div class=&quot;time_travel_debugger&quot;&gt;</span>
<span class="s1">      &lt;input type=&quot;range&quot; min=&quot;0&quot; max=&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lines_over_time</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="si">}</span><span class="s1">&quot;</span>
<span class="s1">      value=&quot;0&quot; class=&quot;slider&quot; id=&quot;time_slider&quot;&gt;</span>
<span class="s1">      Line &lt;span id=&quot;line&quot;&gt;</span><span class="si">{</span><span class="n">lines_over_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;/span&gt;:</span>
<span class="s1">      &lt;span id=&quot;vars&quot;&gt;</span><span class="si">{</span><span class="n">vars_over_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;/span&gt;</span>
<span class="s1">    &lt;/div&gt;</span>
<span class="s1">    &lt;script&gt;</span>
<span class="s1">       var lines_over_time = </span><span class="si">{</span><span class="n">lines_over_time</span><span class="si">}</span><span class="s1">;</span>
<span class="s1">       var vars_over_time = </span><span class="si">{</span><span class="n">vars_over_time</span><span class="si">}</span><span class="s1">;</span>

<span class="s1">       var time_slider = document.getElementById(&quot;time_slider&quot;);</span>
<span class="s1">       var line = document.getElementById(&quot;line&quot;);</span>
<span class="s1">       var vars = document.getElementById(&quot;vars&quot;);</span>

<span class="s1">       time_slider.oninput = function() </span><span class="se">{{</span><span class="s1"></span>
<span class="s1">          line.innerHTML = lines_over_time[this.value];</span>
<span class="s1">          vars.innerHTML = vars_over_time[this.value];</span>
<span class="s1">       </span><span class="se">}}</span><span class="s1"></span>
<span class="s1">    &lt;/script&gt;</span>
<span class="s1">    &#39;&#39;&#39;</span>
    <span class="c1"># print(template)</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slider</span><span class="p">(</span><span class="n">recording</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <div class="time_travel_debugger">
      <input type="range" min="0" max="11"
      value="0" class="slider" id="time_slider">
      Line <span id="line">10</span>:
      <span id="vars">x = 25</span>
    </div>
    <script>
       var lines_over_time = [10, 11, 12, 13, 10, 11, 12, 13, 10, 11, 12, 13];
       var vars_over_time = ['x = 25', 'x = 25', "x = 26, a = 'abc'", "x = 26, a = 'abc'", 'x = 30', 'x = 30', "x = 31, a = 'def'", "x = 31, a = 'def'", 'x = 35', 'x = 35', "x = 36, a = 'ghi'", "x = 36, a = 'ghi'"];

       var time_slider = document.getElementById("time_slider");
       var line = document.getElementById("line");
       var vars = document.getElementById("vars");

       time_slider.oninput = function() {
          line.innerHTML = lines_over_time[this.value];
          vars.innerHTML = vars_over_time[this.value];
       }
    </script>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Explore the HTML and JavaScript details of how <code>slider()</code> works, and then expand it to a user interface where you can</p>
<ul>
<li>see the current source code (together with the line being executed)</li>
<li>search for specific events, such as a line being executed or a variable changing its value</li>
</ul>
<p>Just like <code>slider()</code>, your user interface should come in pure HTML and JavaScript such that it can run in a browser (or a Jupyter notebook) without interacting with a Python program.</p>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Creative Commons License">
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target=_blank>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/debuggingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/debuggingbook/commits/master/notebooks/Debugger.ipynb" target=_blank)>Last change: 2021-10-13 12:17:33+02:00</a> &bull; 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> &bull;
<a href="https://cispa.de/en/impressum" target=_blank>Imprint</a>
</p>

<script>
function revealCitation() {
    var c = document.getElementById("citation");
    c.style.display = "block";
}
</script>

<div id="citation" class="citation" style="display: none;">
<a name="citation"></a>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller: "<a href="https://www.debuggingbook.org/beta/html/Debugger.html">How Debuggers Work</a>".  In Andreas Zeller, "<a href="https://www.debuggingbook.org/beta/">The Debugging Book</a>", <a href="https://www.debuggingbook.org/beta/html/Debugger.html">https://www.debuggingbook.org/beta/html/Debugger.html</a>.  Retrieved 2021-10-13 12:17:33+02:00.
</p>
<pre>
@incollection{debuggingbook2021:Debugger,
    author = {Andreas Zeller},
    booktitle = {The Debugging Book},
    title = {How Debuggers Work},
    year = {2021},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.debuggingbook.org/beta/html/Debugger.html}},
    note = {Retrieved 2021-10-13 12:17:33+02:00},
    url = {https://www.debuggingbook.org/beta/html/Debugger.html},
    urldate = {2021-10-13 12:17:33+02:00}
}
</pre>
</div>

      </div>
    </div>
    </article>

 </body>

</html>
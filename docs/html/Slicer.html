
<!-- A html document -->
<!-- 
with standard nbconvert css layout
with standard nbconvert input/output content
standard html tag wrapping
with mathjax loaded
with jupyter wigets
 caption and label elements according to ipub meta tags  
with debuggingbook adaptations -->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /><title>Tracking Failure Origins - The Debugging Book</title>
<link rel="me" href="https://mastodon.social/@TheDebuggingBook">

<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.2.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.2.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.2.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.2.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.2.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.2.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2);
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1);
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1);
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
@media (max-width: 991px) {
  #ipython_notebook {
    margin-left: 10px;
  }
}
[dir="rtl"] #ipython_notebook {
  float: right !important;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#login_widget {
  float: right;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  text-align: center;
  vertical-align: middle;
  display: inline;
  opacity: 0;
  z-index: 2;
  width: 12ex;
  margin-right: -12ex;
}
.alternate_upload .btn-upload {
  height: 22px;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
[dir="rtl"] #tabs li {
  float: right;
}
ul#tabs {
  margin-bottom: 4px;
}
[dir="rtl"] ul#tabs {
  margin-right: 0px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons {
  float: left !important;
}
[dir="rtl"] .list_toolbar .pull-right {
  padding-top: 1px;
  float: left !important;
}
[dir="rtl"] .list_toolbar .pull-left {
  float: right !important;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: baseline;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
#tree-selector {
  padding-right: 0px;
}
[dir="rtl"] #tree-selector a {
  float: right;
}
#button-select-all {
  min-width: 50px;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
[dir="rtl"] #new-menu {
  text-align: right;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
[dir="rtl"] #running .col-sm-8 {
  float: right !important;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul {
  list-style: disc;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ul ul {
  list-style: square;
  margin: 0em 2em;
}
.rendered_html ul ul ul {
  list-style: circle;
  margin: 0em 2em;
}
.rendered_html ol {
  list-style: decimal;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
  margin: 0em 2em;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  background-color: #fff;
  color: #000;
  font-size: 100%;
  padding: 0px;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: 1px solid black;
  border-collapse: collapse;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  border: 1px solid black;
  border-collapse: collapse;
  margin: 1em 2em;
}
.rendered_html td,
.rendered_html th {
  text-align: left;
  vertical-align: middle;
  padding: 4px;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget {
  float: right !important;
  float: right;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  margin-top: 6px;
}
span.save_widget span.filename {
  height: 1em;
  line-height: 1em;
  padding: 3px;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  display: none;
}
.command-shortcut:before {
  content: "(command)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">

/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>
<!-- End of mathjax configuration --><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!--[if IE lte 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<style type="text/css">
.ipyfigure { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipyfigure>div { flex:1; }
.ipytable { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipytable>div { flex:1; }

</style>

<link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,500,700|Raleway:300|Source+Code+Pro|Open+Sans' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<meta name="theme-color" content="purple" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#4B0150" media="(prefers-color-scheme: dark)">

<meta property="og:url" content="https://www.debuggingbook.org/html/Slicer.html" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Tracking Failure Origins - The Debugging Book" />
<meta property="og:description" content="The question of &quot;Where does this value come from?&quot; is fundamental for debugging. Which earlier variables could possibly have influenced the current erroneous state? And how did their values come to be?When programmers read code during debugging, they scan it for potential origins of given values. This can be a tedious experience, notably, if the origins spread across multiple separate locations, possibly even in different modules. In this chapter, we thus investigate means to determine such origins automatically  by collecting data and control dependencies during program execution.Prerequisites You should have read the Introduction to Debugging. To understand how to compute dependencies automatically (the second half of this chapter), you will need     advanced knowledge of Python semantics     knowledge on how to instrument and transform code     knowledge on how an interpreter works" />
<meta property="og:image" content="https://www.debuggingbook.org/html/PICS/wordcloud.png" />

<meta name="twitter:dnt" content="on">

<link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon.png">

<meta name="msapplication-TileColor" content="#B03A2E">
<meta name="msapplication-config" content="favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">

<meta name="viewport" content="width=device-width, initial-scale=1"></head>
 <body>

    <script>
    var close_menus = function() {
        /* doesn't work yet - AZ
        console.log("Closing menus")
        var cssmenu = document.getElementById("cssmenu")
        var all_items = cssmenu.getElementsByTagName("li");
        var i;
        for (i = 0; i < all_items.length; i++) {
            item = all_items[i];
            // console.log("<li>: ")
            // console.log(item.innerHTML);
            var j;
            var all_ul = item.getElementsByTagName("ul");
            for (j = 0; j < all_ul.length; j++) {
                console.log("<ul>: ")
                console.log(all_ul[j].innerHTML);
                all_ul[j].style.display = "none";
            }
            var all_ol = item.getElementsByTagName("ol");
            for (j = 0; j < all_ol.length; j++) {
                console.log("<ol>: ")
                console.log(all_ol[j].innerHTML);
                all_ol[j].style.display = "none";
            }
        }
        */
    };

    $( document ).ready( close_menus );

    // Let navbar fade away when scrolling down
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (currentScrollPos > 10 && currentScrollPos > prevScrollpos) {
            // Hide navbar
            var cssmenu = document.getElementById("cssmenu")
            cssmenu.style.opacity = 0;

            // When scrolling, also close all sub-menus
            close_menus();
        }
        else {
            // Make navbar visible
            document.getElementById("cssmenu").style.opacity = 1;
        }
        prevScrollpos = currentScrollPos;
    };
    </script>
    
<nav>
<div id="cssmenu">
  <ul>
     <li class="has-sub"><a href="#"><span title="The Debugging Book"><i class="fa fa-fw fa-bars"></i> </span><span class="menu_1">The Debugging Book</span></a>
        <ol>
           
<li><a href="https://www.debuggingbook.org/"><span class="part_number"><i class="fa fa-fw fa-home"></i></span> About this book</a></li>
<li><a href="https://www.debuggingbook.org/html/00_Table_of_Contents.html"><i class="fa fa-fw fa-sitemap"></i></span> Sitemap</a></li>
<li class="has-sub"><a href="01_Intro.html" class="chapters"><span class="part_number">I</span> Whetting Your Appetite <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tours.html">Tours through the Book</a></li>
<li><a href="Intro_Debugging.html">Introduction to Debugging</a></li>
</ul><li class="has-sub"><a href="02_Observing.html" class="chapters"><span class="part_number">II</span> Observing Executions <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracer.html">Tracing Executions</a></li>
<li><a href="Debugger.html">How Debuggers Work</a></li>
<li><a href="Assertions.html">Asserting Expectations</a></li>
</ul><li class="has-sub"><a href="03_Dependencies.html" class="chapters"><span class="part_number">III</span> Flows and Dependencies <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Slicer.html" class="this_page">Tracking Failure Origins</a></li>
</ul><li class="has-sub"><a href="04_Reducing.html" class="chapters"><span class="part_number">IV</span> Reducing Failure Causes <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="DeltaDebugger.html">Reducing Failure-Inducing Inputs</a></li>
<li><a href="ChangeDebugger.html">Isolating Failure-Inducing Changes</a></li>
</ul><li class="has-sub"><a href="05_Abstracting.html" class="chapters"><span class="part_number">V</span> Abstracting Failures <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="StatisticalDebugger.html">Statistical Debugging</a></li>
<li><a href="DynamicInvariants.html">Mining Function Specifications</a></li>
<li><a href="DDSetDebugger.html">Generalizing Failure Circumstances</a></li>
<li><a href="Alhazen.html">Learning from Failures <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="PerformanceDebugger.html">Debugging Performance Issues</a></li>
</ul><li class="has-sub"><a href="06_Repairing.html" class="chapters"><span class="part_number">VI</span> Automatic Repair <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Repairer.html">Repairing Code Automatically</a></li>
</ul><li class="has-sub"><a href="07_In_the_Large.html" class="chapters"><span class="part_number">VII</span> Debugging in the Large <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracking.html">Tracking Bugs</a></li>
<li><a href="ChangeCounter.html">Where the Bugs are</a></li>
</ul><li class="has-sub"><a href="99_Appendices.html" class="chapters">Appendices <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="ExpectError.html">Error Handling</a></li>
<li><a href="Timer.html">Timer</a></li>
<li><a href="Timeout.html">Timeout</a></li>
<li><a href="ClassDiagram.html">Class Diagrams</a></li>
<li><a href="StackInspector.html">Inspecting Call Stacks</a></li>
</ul>
           <li><a href="https://www.debuggingbook.org/html/00_Index.html">Index (beta)</a></i></li>
        </ol>
     </li>
     <li class="has-sub"><a href="#"><span title="Tracking Failure Origins"><i class="fa fa-fw fa-list-ul"></i></span> <span class="menu_2">Tracking Failure Origins</span></a>
           <ul><li class="has-sub"><a href="#Synopsis"><i class="fa fa-fw fa-map"></i> Synopsis</a>
</li><li class="has-sub"><a href="#Dependencies">&nbsp;&bull;&nbsp;&nbsp; Dependencies</a>
<ul><li class="has-sub"><a href="#Excursion:-Visualizing-Dependencies">Excursion: Visualizing Dependencies</a>
</li><li class="has-sub"><a href="#Data-Dependencies">Data Dependencies</a>
</li><li class="has-sub"><a href="#Control-Dependencies">Control Dependencies</a>
</li><li class="has-sub"><a href="#Dependency-Graphs">Dependency Graphs</a>
</li><li class="has-sub"><a href="#Showing-Dependencies-with-Code">Showing Dependencies with Code</a>
</ul></li><li class="has-sub"><a href="#Slices">&nbsp;&bull;&nbsp;&nbsp; Slices</a>
</li><li class="has-sub"><a href="#Tracking-Techniques">&nbsp;&bull;&nbsp;&nbsp; Tracking Techniques</a>
<ul><li class="has-sub"><a href="#Wrapping-Data-Objects">Wrapping Data Objects</a>
</li><li class="has-sub"><a href="#Wrapping-Data-Accesses">Wrapping Data Accesses</a>
</ul></li><li class="has-sub"><a href="#A-Data-Tracker">&nbsp;&bull;&nbsp;&nbsp; A Data Tracker</a>
</li><li class="has-sub"><a href="#Instrumenting-Source-Code">&nbsp;&bull;&nbsp;&nbsp; Instrumenting Source Code</a>
<ul><li class="has-sub"><a href="#Tracking-Variable-Accesses">Tracking Variable Accesses</a>
</li><li class="has-sub"><a href="#Excursion:-Tracking-Assignments-and-Assertions">Excursion: Tracking Assignments and Assertions</a>
</li><li class="has-sub"><a href="#Excursion:-Tracking-Return-Values">Excursion: Tracking Return Values</a>
</li><li class="has-sub"><a href="#Excursion:-Tracking-Control">Excursion: Tracking Control</a>
</li><li class="has-sub"><a href="#Excursion:-Tracking-Calls-and-Arguments">Excursion: Tracking Calls and Arguments</a>
</li><li class="has-sub"><a href="#Excursion:-Tracking-Parameters">Excursion: Tracking Parameters</a>
</li><li class="has-sub"><a href="#Excursion:-Transformer-Stress-Test">Excursion: Transformer Stress Test</a>
</ul></li><li class="has-sub"><a href="#Tracking-Dependencies">&nbsp;&bull;&nbsp;&nbsp; Tracking Dependencies</a>
<ul><li class="has-sub"><a href="#Data-Dependencies">Data Dependencies</a>
</li><li class="has-sub"><a href="#Excursion:-Control-Dependencies">Excursion: Control Dependencies</a>
</li><li class="has-sub"><a href="#Excursion:-Calls-and-Returns">Excursion: Calls and Returns</a>
</li><li class="has-sub"><a href="#Excursion:-Function-Arguments">Excursion: Function Arguments</a>
</li><li class="has-sub"><a href="#Excursion:-Diagnostics">Excursion: Diagnostics</a>
</ul></li><li class="has-sub"><a href="#Slicing-Code">&nbsp;&bull;&nbsp;&nbsp; Slicing Code</a>
<ul><li class="has-sub"><a href="#An-Instrumenter-Base-Class">An Instrumenter Base Class</a>
</li><li class="has-sub"><a href="#The-Slicer-Class">The Slicer Class</a>
</li><li class="has-sub"><a href="#Diagnostics">Diagnostics</a>
</ul></li><li class="has-sub"><a href="#More-Examples">&nbsp;&bull;&nbsp;&nbsp; More Examples</a>
<ul><li class="has-sub"><a href="#Square-Root">Square Root</a>
</li><li class="has-sub"><a href="#Removing-HTML-Markup">Removing HTML Markup</a>
</li><li class="has-sub"><a href="#Calls-and-Augmented-Assign">Calls and Augmented Assign</a>
</ul></li><li class="has-sub"><a href="#Dynamic-Instrumentation">&nbsp;&bull;&nbsp;&nbsp; Dynamic Instrumentation</a>
<ul><li class="has-sub"><a href="#Excursion:-Implementing-Dynamic-Instrumentation">Excursion: Implementing Dynamic Instrumentation</a>
</ul></li><li class="has-sub"><a href="#More-Applications">&nbsp;&bull;&nbsp;&nbsp; More Applications</a>
<ul><li class="has-sub"><a href="#Verifying-Information-Flows">Verifying Information Flows</a>
</li><li class="has-sub"><a href="#Assessing-Test-Quality">Assessing Test Quality</a>
</li><li class="has-sub"><a href="#Use-in-Statistical-Debugging">Use in Statistical Debugging</a>
</ul></li><li class="has-sub"><a href="#Things-that-do-not-Work">&nbsp;&bull;&nbsp;&nbsp; Things that do not Work</a>
</li><li class="has-sub"><a href="#Lessons-Learned"><i class="fa fa-fw fa-trophy"></i> Lessons Learned</a>
</li><li class="has-sub"><a href="#Next-Steps"><i class="fa fa-fw fa-arrows"></i> Next Steps</a>
</li><li class="has-sub"><a href="#Background"><i class="fa fa-fw fa-mortar-board"></i> Background</a>
</li><li class="has-sub"><a href="#Exercises"><i class="fa fa-fw fa-edit"></i> Exercises</a>
<ul><li class="has-sub"><a href="#Exercise-1:-Control-Slices">Exercise 1: Control Slices</a>
</li><li class="has-sub"><a href="#Exercise-2:-Incremental-Exploration">Exercise 2: Incremental Exploration</a>
</li><li class="has-sub"><a href="#Exercise-3:-Forward-Slicing">Exercise 3: Forward Slicing</a>
</li><li class="has-sub"><a href="#Exercise-4:-Code-with-Forward-Dependencies">Exercise 4: Code with Forward Dependencies</a>
</li><li class="has-sub"><a href="#Exercise-5:-Flow-Assertions">Exercise 5: Flow Assertions</a>
</li><li class="has-sub"><a href="#Exercise-6:-Checked-Coverage">Exercise 6: Checked Coverage</a>
</ul></li></ul></li>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Resources"><i class="fa fa-fw fa-cube"></i> </span><span class="menu_3">Resources</span></a>
     <ul>
     <li><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/HEAD?labpath=docs%2Fnotebooks/Slicer.ipynb" target="_blank" class="edit_as_notebook"><i class="fa fa-fw fa-edit"></i> Edit as Notebook</a></li>
     <li><a href="https://www.debuggingbook.org/slides/Slicer.slides.html" target="_blank"><i class="fa fa-fw fa-video-camera"></i> View Slides</a></li>
     <li><a href="https://www.debuggingbook.org/code/Slicer.py"><i class="fa fa-fw fa-download"></i> Download Code (.py)</a></li>
     <li><a href="https://www.debuggingbook.org/notebooks/Slicer.ipynb"><i class="fa fa-fw fa-download"></i> Download Notebook (.ipynb)</a></li>
     <li><a href="https://www.debuggingbook.org/dist/debuggingbook-code.zip"><i class="fa fa-fw fa-cube"></i> All Code (.zip)</a></li>
     <li><a href="https://www.debuggingbook.org/dist/debuggingbook-notebooks.zip"><i class="fa fa-fw fa-cube"></i> All Notebooks (.zip)</a></li>
     <li><a href="https://github.com/uds-se/debuggingbook/" target="_blank"><i class="fa fa-fw fa-github"></i> Project Page</a></li>
     <li><a href="ReleaseNotes.html" target="_blank"><i class="fa fa-fw fa-calendar"></i> Release Notes</a></li>
     </ul>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Share"><i class="fa fa-fw fa-comments"></i> </span> <span class="menu_4">Share</span></a>
        <ul>
<!--
            <li><a href="https://twitter.com/intent/tweet?text=I%20just%20read%20%22Tracking%20Failure%20Origins%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fSlicer.html" target="popup" 
onclick="window.open('https://twitter.com/intent/tweet?text=I%20just%20read%20%22Tracking%20Failure%20Origins%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fSlicer.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-twitter"></i> Share on X</a>
            <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fSlicer.html" target="popup" 
onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fSlicer.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-facebook"></i> Share on Facebook</a>
-->
            <li><a href="mailto:?subject=Tracking%20Failure%20Origins&body=I%20just%20read%20%22Tracking%20Failure%20Origins%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fSlicer.html"><i class="fa fa-fw fa-envelope"></i> Share by Email</a>
            <li><a href="#citation" id="cite" onclick="revealCitation()"><i class="fa fa-fw fa-mortar-board"></i> Cite</a>
        </ul>
     </li>
     <li class="has-sub"><a href="#"><span title="Help"><i class="fa fa-fw fa-question-circle"></i></span> <span class="menu_5">Help</span></a>
        <ul>
          <li><a href="https://www.debuggingbook.org/#Troubleshooting"><i class="fa fa-fw fa-wrench"></i> Troubleshooting</a></li>
          <li><a href="https://docs.python.org/3/tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Python Tutorial</a>
          <li><a href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Jupyter Notebook Tutorial</a>
          <li><a href="https://github.com/uds-se/debuggingbook/issues/" target="_blank"><i class="fa fa-fw fa-commenting"></i> Report an Issue</a></li>
        </ul>
     </li>
  </ul>
</div>
</nav>

    <article>
   <div tabindex="-1" id="notebook" class="border-box-sizing">
     <div class="container" id="notebook-container">

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Tracking-Failure-Origins">Tracking Failure Origins<a class="anchor-link" href="#Tracking-Failure-Origins">&#182;</a></h1><p>The question of "Where does this value come from?" is fundamental for debugging. Which earlier variables could possibly have influenced the current erroneous state? And how did their values come to be?</p>
<p>When programmers read code during debugging, they scan it for potential <em>origins</em> of given values. This can be a tedious experience, notably, if the origins spread across multiple separate locations, possibly even in different modules. In this chapter, we thus investigate means to <em>determine such origins</em> automatically  by collecting data and control dependencies during program execution.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;sjf3cOR0lcI&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/sjf3cOR0lcI"
            frameborder="0"
            allowfullscreen

        ></iframe>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>You should have read the <a href="Intro_Debugging">Introduction to Debugging</a>.</li>
<li>To understand how to compute dependencies automatically (the second half of this chapter), you will need<ul>
<li>advanced knowledge of Python semantics</li>
<li>knowledge on how to instrument and transform code</li>
<li>knowledge on how an interpreter works</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils.setup</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">quiz</span><span class="p">,</span> <span class="n">next_inputs</span><span class="p">,</span> <span class="n">print_content</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/inspect.html" class="import" target="_blank">inspect</a></span>
<span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/warnings.html" class="import" target="_blank">warnings</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis">&#182;</a></h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="Slicer.html" class="import" target="_blank">debuggingbook.Slicer</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>This chapter provides a <code>Slicer</code> class to automatically determine and visualize dynamic flows and dependencies. When we say that a variable $x$ <em>depends</em> on a variable $y$ (and that $y$ <em>flows</em> into $x$), we distinguish two kinds of dependencies:</p>
<ul>
<li><strong>Data dependency</strong>: $x$ is assigned a value computed from $y$.</li>
<li><strong>Control dependency</strong>: A statement involving $x$ is executed <em>only</em> because a <em>condition</em> involving $y$ was evaluated, influencing the execution path.</li>
</ul>
<p>Such dependencies are crucial for debugging, as they allow determininh the origins of individual values (and notably incorrect values).</p>
<p>To determine dynamic dependencies in a function <code>func</code>, use</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">()</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">Some</span> <span class="n">call</span> <span class="n">to</span> <span class="n">func</span><span class="p">()</span><span class="o">&gt;</span>
</pre></div>
<p>and then <code>slicer.graph()</code> or <code>slicer.code()</code> to examine dependencies.</p>
<p>You can also explicitly specify the functions to be instrumented, as in</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">func_1</span><span class="p">,</span> <span class="n">func_2</span><span class="p">)</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">Some</span> <span class="n">call</span> <span class="n">to</span> <span class="n">func</span><span class="p">()</span><span class="o">&gt;</span>
</pre></div>
<p>Here is an example. The <code>demo()</code> function computes some number from <code>x</code>:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">z</span> <span class="o">=</span> <span class="n">x</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">64</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>         <span class="n">z</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">return</span> <span class="n">z</span>
</pre></div>
<p>By using <code>with Slicer()</code>, we first instrument <code>demo()</code> and then execute it:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">Slicer</span><span class="p">()</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">demo</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">n2</span><span class="o">/</span><span class="n">xd9445p97rb3xh7m1dfx8_4h0006ts</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_18911</span><span class="o">/</span><span class="mf">2454789564.</span><span class="n">py</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span> <span class="ne">DeprecationWarning</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Str</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="ow">in</span> <span class="n">Python</span> <span class="mf">3.14</span><span class="p">;</span> <span class="n">use</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="n">instead</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="n">value</span><span class="p">],</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">n2</span><span class="o">/</span><span class="n">xd9445p97rb3xh7m1dfx8_4h0006ts</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_18911</span><span class="o">/</span><span class="mf">3554319793.</span><span class="n">py</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span> <span class="ne">DeprecationWarning</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Str</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="ow">in</span> <span class="n">Python</span> <span class="mf">3.14</span><span class="p">;</span> <span class="n">use</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="n">instead</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">())],</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">n2</span><span class="o">/</span><span class="n">xd9445p97rb3xh7m1dfx8_4h0006ts</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_18911</span><span class="o">/</span><span class="mf">882995308.</span><span class="n">py</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span> <span class="ne">DeprecationWarning</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Num</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="ow">in</span> <span class="n">Python</span> <span class="mf">3.14</span><span class="p">;</span> <span class="n">use</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="n">instead</span>
  <span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))]</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">n2</span><span class="o">/</span><span class="n">xd9445p97rb3xh7m1dfx8_4h0006ts</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_18911</span><span class="o">/</span><span class="mf">882995308.</span><span class="n">py</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span> <span class="ne">DeprecationWarning</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">NameConstant</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="ow">in</span> <span class="n">Python</span> <span class="mf">3.14</span><span class="p">;</span> <span class="n">use</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="n">instead</span>
  <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">NameConstant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">n2</span><span class="o">/</span><span class="n">xd9445p97rb3xh7m1dfx8_4h0006ts</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_18911</span><span class="o">/</span><span class="mf">882995308.</span><span class="n">py</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span> <span class="ne">DeprecationWarning</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Str</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="ow">in</span> <span class="n">Python</span> <span class="mf">3.14</span><span class="p">;</span> <span class="n">use</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span> <span class="n">instead</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">arg</span><span class="p">),</span>
</pre></div>
<p>After execution is complete, you can output <code>slicer</code> to visualize the dependencies and flows as graph. Data dependencies are shown as black solid edges; control dependencies are shown as grey dashed edges. The arrows indicate influence: If $y$ depends on $x$ (and thus $x$ flows into $y$), then we have an arrow $x \rightarrow y$.
We see how the parameter <code>x</code> flows into <code>z</code>, which is returned after some computation that is control dependent on a <code>&lt;test&gt;</code> involving <code>z</code>.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">slicer</span>
</pre></div>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="332pt" height="276pt"
 viewBox="0.00 0.00 331.50 276.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 272)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-272 327.5,-272 327.5,4 -4,4"/>
<!-- z_functiondemoat0x1088747c0_2 -->
<g id="node1" class="node">
<title>z_functiondemoat0x1088747c0_2</title>
<g id="a_node1"><a xlink:title="demo:2">
<polygon fill="peachpuff" stroke="black" points="88.88,-192 34.88,-192 34.88,-152 88.88,-152 88.88,-192"/>
<text text-anchor="start" x="57.75" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="48.75" y="-157.45" font-family="Courier,monospace" font-size="9.00">z = x</text>
</a>
</g>
</g>
<!-- z_functiondemoat0x1088747c0_4 -->
<g id="node3" class="node">
<title>z_functiondemoat0x1088747c0_4</title>
<g id="a_node3"><a xlink:title="demo:4">
<polygon fill="peachpuff" stroke="black" points="148.88,-116 94.88,-116 94.88,-76 148.88,-76 148.88,-116"/>
<text text-anchor="start" x="117.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="106.12" y="-81.45" font-family="Courier,monospace" font-size="9.00">z *= 2</text>
</a>
</g>
</g>
<!-- z_functiondemoat0x1088747c0_2&#45;&gt;z_functiondemoat0x1088747c0_4 -->
<g id="edge2" class="edge">
<title>z_functiondemoat0x1088747c0_2&#45;&gt;z_functiondemoat0x1088747c0_4</title>
<path fill="none" stroke="black" d="M77.64,-151.56C84.18,-143.48 91.91,-133.96 99.05,-125.15"/>
<polygon fill="black" stroke="black" points="101.68,-127.46 105.26,-117.49 96.25,-123.05 101.68,-127.46"/>
</g>
<!-- test_functiondemoat0x1088747c0_3 -->
<g id="node4" class="node">
<title>test_functiondemoat0x1088747c0_3</title>
<g id="a_node4"><a xlink:title="demo:3">
<polygon fill="peachpuff" stroke="black" points="115.75,-40 0,-40 0,0 115.75,0 115.75,-40"/>
<text text-anchor="start" x="33.12" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="8" y="-5.45" font-family="Courier,monospace" font-size="9.00">while x &lt;= z &lt;= 64:</text>
</a>
</g>
</g>
<!-- z_functiondemoat0x1088747c0_2&#45;&gt;test_functiondemoat0x1088747c0_3 -->
<g id="edge5" class="edge">
<title>z_functiondemoat0x1088747c0_2&#45;&gt;test_functiondemoat0x1088747c0_3</title>
<path fill="none" stroke="black" d="M56.66,-151.7C53.58,-126.38 52.1,-81.68 53.12,-51.69"/>
<polygon fill="black" stroke="black" points="56.62,-51.9 53.62,-41.74 49.63,-51.55 56.62,-51.9"/>
</g>
<!-- z_functiondemoat0x1088747c0_2&#45;&gt;test_functiondemoat0x1088747c0_3 -->
<!-- x_functiondemoat0x1088747c0_5 -->
<g id="node2" class="node">
<title>x_functiondemoat0x1088747c0_5</title>
<g id="a_node2"><a xlink:title="demo:5">
<polygon fill="peachpuff" stroke="black" points="62.88,-268 4.88,-268 4.88,-228 62.88,-228 62.88,-268"/>
<text text-anchor="start" x="29.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="12.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">return z</text>
</a>
</g>
</g>
<!-- x_functiondemoat0x1088747c0_5&#45;&gt;z_functiondemoat0x1088747c0_2 -->
<g id="edge1" class="edge">
<title>x_functiondemoat0x1088747c0_5&#45;&gt;z_functiondemoat0x1088747c0_2</title>
<path fill="none" stroke="black" d="M41.23,-227.56C44.09,-219.99 47.44,-211.16 50.59,-202.83"/>
<polygon fill="black" stroke="black" points="53.77,-204.32 54.03,-193.73 47.22,-201.84 53.77,-204.32"/>
</g>
<!-- x_functiondemoat0x1088747c0_5&#45;&gt;test_functiondemoat0x1088747c0_3 -->
<g id="edge7" class="edge">
<title>x_functiondemoat0x1088747c0_5&#45;&gt;test_functiondemoat0x1088747c0_3</title>
<path fill="none" stroke="black" d="M30.38,-227.73C28.64,-217.21 26.74,-203.93 25.88,-192 24.59,-174.27 23.75,-169.65 25.88,-152 30.12,-116.77 40.55,-77.33 48.36,-51.02"/>
<polygon fill="black" stroke="black" points="51.63,-52.3 51.19,-41.71 44.93,-50.26 51.63,-52.3"/>
</g>
<!-- z_functiondemoat0x1088747c0_4&#45;&gt;z_functiondemoat0x1088747c0_4 -->
<g id="edge3" class="edge">
<title>z_functiondemoat0x1088747c0_4&#45;&gt;z_functiondemoat0x1088747c0_4</title>
<path fill="none" stroke="black" d="M149.12,-110.24C158.9,-110.54 166.88,-105.8 166.88,-96 166.88,-90.34 164.21,-86.36 160.07,-84.07"/>
<polygon fill="black" stroke="black" points="161.1,-80.71 150.6,-82.08 159.66,-87.56 161.1,-80.71"/>
</g>
<!-- z_functiondemoat0x1088747c0_4&#45;&gt;test_functiondemoat0x1088747c0_3 -->
<g id="edge6" class="edge">
<title>z_functiondemoat0x1088747c0_4&#45;&gt;test_functiondemoat0x1088747c0_3</title>
<path fill="none" stroke="black" d="M94.63,-77.09C85.74,-68.75 76.51,-58.62 69.18,-49.28"/>
<polygon fill="black" stroke="black" points="72.2,-47.49 63.45,-41.52 66.57,-51.65 72.2,-47.49"/>
</g>
<!-- demoreturnvalue_functiondemoat0x1088747c0_5 -->
<g id="node5" class="node">
<title>demoreturnvalue_functiondemoat0x1088747c0_5</title>
<g id="a_node5"><a xlink:title="demo:5">
<polygon fill="peachpuff" stroke="black" points="323.5,-40 134.25,-40 134.25,0 323.5,0 323.5,-40"/>
<text text-anchor="start" x="142.25" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;demo() return value&gt;</text>
<text text-anchor="start" x="207.88" y="-5.45" font-family="Courier,monospace" font-size="9.00">return z</text>
</a>
</g>
</g>
<!-- z_functiondemoat0x1088747c0_4&#45;&gt;demoreturnvalue_functiondemoat0x1088747c0_5 -->
<g id="edge8" class="edge">
<title>z_functiondemoat0x1088747c0_4&#45;&gt;demoreturnvalue_functiondemoat0x1088747c0_5</title>
<path fill="none" stroke="black" d="M143.96,-75.56C156.07,-66.63 171.39,-55.94 185.71,-46.39"/>
<polygon fill="black" stroke="black" points="187.25,-49.57 193.67,-41.15 183.4,-43.73 187.25,-49.57"/>
</g>
<!-- z_functiondemoat0x1088747c0_4&#45;&gt;demoreturnvalue_functiondemoat0x1088747c0_5 -->
<!-- test_functiondemoat0x1088747c0_3&#45;&gt;z_functiondemoat0x1088747c0_4 -->
<g id="edge4" class="edge">
<title>test_functiondemoat0x1088747c0_3&#45;&gt;z_functiondemoat0x1088747c0_4</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M74.58,-40.31C81.62,-48.45 89.95,-58.09 97.65,-66.99"/>
<polygon fill="grey" stroke="grey" points="94.88,-69.14 104.07,-74.41 100.18,-64.56 94.88,-69.14"/>
</g>
<!-- test_functiondemoat0x1088747c0_3&#45;&gt;z_functiondemoat0x1088747c0_4 -->
</g>
</svg>
</p>
<p>An alternate representation is <code>slicer.code()</code>, annotating the instrumented source code with (backward) dependencies. Data dependencies are shown with <code>&lt;=</code>, control dependencies with <code>&lt;-</code>; locations (lines) are shown in parentheses.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">slicer</span><span class="o">.</span><span class="n">code</span><span class="p">()</span>
     <span class="mi">1</span> <span class="k">def</span> <span class="nf">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="o">*</span>    <span class="mi">2</span>     <span class="n">z</span> <span class="o">=</span> <span class="n">x</span>  <span class="c1"># &lt;= x (5)</span>
<span class="o">*</span>    <span class="mi">3</span>     <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">64</span><span class="p">:</span>  <span class="c1"># &lt;= z (2), z (4), x (5)</span>
<span class="o">*</span>    <span class="mi">4</span>         <span class="n">z</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># &lt;= z (2), z (4); &lt;- &lt;test&gt; (3)</span>
<span class="o">*</span>    <span class="mi">5</span>     <span class="k">return</span> <span class="n">z</span>  <span class="c1"># &lt;= z (4)</span>
</pre></div>
<p>Dependencies can also be retrieved programmatically. The <code>dependencies()</code> method returns a <code>Dependencies</code> object encapsulating the dependency graph.</p>
<p>The method <code>all_vars()</code> returns all variables in the dependency graph. Each variable is encoded as a pair (<em>name</em>, <em>location</em>) where <em>location</em> is a pair (<em>codename</em>, <em>lineno</em>).</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">all_vars</span><span class="p">()</span>
<span class="p">{(</span><span class="s1">&#39;&lt;demo() return value&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">__main__</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
 <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">__main__</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
 <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">__main__</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
 <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">__main__</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
 <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">__main__</span><span class="o">.</span><span class="n">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))}</span>
</pre></div>
<p><code>code()</code> and <code>graph()</code> methods can also be applied on dependencies. The method <code>backward_slice(var)</code> returns a backward slice for the given variable (again given as a pair (<em>name</em>, <em>location</em>)). To retrieve where <code>z</code> in Line 2 came from, use:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="p">,</span> <span class="n">start_demo</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">demo</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">start_demo</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">backward_slice</span><span class="p">((</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">demo</span><span class="p">,</span> <span class="n">start_demo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
</pre></div>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="66pt" height="124pt"
 viewBox="0.00 0.00 66.00 124.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-120 62,-120 62,4 -4,4"/>
<!-- z_functiondemoat0x1088747c0_2 -->
<g id="node1" class="node">
<title>z_functiondemoat0x1088747c0_2</title>
<g id="a_node1"><a xlink:title="demo:2">
<polygon fill="peachpuff" stroke="black" points="56,-116 2,-116 2,-76 56,-76 56,-116"/>
<text text-anchor="start" x="24.88" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="15.88" y="-81.45" font-family="Courier,monospace" font-size="9.00">z = x</text>
</a>
</g>
</g>
<!-- x_functiondemoat0x1088747c0_5 -->
<g id="node2" class="node">
<title>x_functiondemoat0x1088747c0_5</title>
<g id="a_node2"><a xlink:title="demo:5">
<polygon fill="peachpuff" stroke="black" points="58,-40 0,-40 0,0 58,0 58,-40"/>
<text text-anchor="start" x="24.88" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="8" y="-5.45" font-family="Courier,monospace" font-size="9.00">return z</text>
</a>
</g>
</g>
<!-- z_functiondemoat0x1088747c0_2&#45;&gt;x_functiondemoat0x1088747c0_5 -->
<!-- x_functiondemoat0x1088747c0_5&#45;&gt;z_functiondemoat0x1088747c0_2 -->
<g id="edge1" class="edge">
<title>x_functiondemoat0x1088747c0_5&#45;&gt;z_functiondemoat0x1088747c0_2</title>
<path fill="none" stroke="black" d="M35.01,-40.31C35.67,-47.61 35.89,-56.1 35.67,-64.19"/>
<polygon fill="black" stroke="black" points="32.18,-63.86 35.11,-74.05 39.17,-64.26 32.18,-63.86"/>
</g>
</g>
</svg>
</p>
<p>Here are the classes defined in this chapter. A <code>Slicer</code> instruments a program, using a <code>DependencyTracker</code> at run time to collect <code>Dependencies</code>.</p>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="544pt" height="895pt"
 viewBox="0.00 0.00 543.62 895.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 891.25)">
<g id="a_graph0"><a xlink:title="Slicer class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-891.25 539.62,-891.25 539.62,4 -4,4"/>
</a>
</g>
<!-- Slicer -->
<g id="node1" class="node">
<title>Slicer</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class Slicer:&#10;Track dependencies in an execution">
<polygon fill="none" stroke="black" points="0,-30 0,-254.5 190,-254.5 190,-30 0,-30"/>
<text text-anchor="start" x="77.75" y="-238.2" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">Slicer</text>
<polyline fill="none" stroke="black" points="0,-229.25 190,-229.25"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="Slicer">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, *items_to_instrument: Any, dependency_tracker: Optional[DependencyTracker] = None, globals: Optional[Dict[str, Any]] = None, log: Union[bool, int] = False):&#10;Create a slicer.&#10;`items_to_instrument` are Python functions or modules with source code.&#10;`dependency_tracker` is the tracker to be used (default: DependencyTracker).&#10;`globals` is the namespace to be used(default: caller&#39;s `globals()`)&#10;`log`=True or `log` &gt; 0 turns on logging">
<text text-anchor="start" x="8" y="-216.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="_repr_mimebundle_(self, include: Any = None, exclude: Any = None) &#45;&gt; Any:&#10;If the object is output in Jupyter, render dependencies as a SVG graph">
<text text-anchor="start" x="8" y="-204" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">_repr_mimebundle_()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="#" xlink:title="code(self, *args: Any, **kwargs: Any) &#45;&gt; None:&#10;Show code of instrumented items, annotated with dependencies.">
<text text-anchor="start" x="8" y="-191.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">code()</text>
</a>
</g>
<g id="a_node1_4"><a xlink:href="#" xlink:title="dependencies(self) &#45;&gt; Dependencies:&#10;Return collected dependencies.">
<text text-anchor="start" x="8" y="-178.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">dependencies()</text>
</a>
</g>
<g id="a_node1_5"><a xlink:href="#" xlink:title="graph(self, *args: Any, **kwargs: Any) &#45;&gt; graphviz.graphs.Digraph:&#10;Show dependency graph.">
<text text-anchor="start" x="8" y="-165.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">graph()</text>
</a>
</g>
<g id="a_node1_6"><a xlink:href="#" xlink:title="calls_in_our_with_block(self) &#45;&gt; Set[str]:&#10;Return a set of function names called in the `with` block.">
<text text-anchor="start" x="8" y="-152" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">calls_in_our_with_block()</text>
</a>
</g>
<g id="a_node1_7"><a xlink:href="#" xlink:title="default_items_to_instrument(self) &#45;&gt; List[Callable]">
<text text-anchor="start" x="8" y="-140.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">default_items_to_instrument()</text>
</a>
</g>
<g id="a_node1_8"><a xlink:href="#" xlink:title="execute(self, tree: ast.AST, item: Any) &#45;&gt; None:&#10;Compile and execute `tree`. May be extended in subclasses.">
<text text-anchor="start" x="8" y="-127.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">execute()</text>
</a>
</g>
<g id="a_node1_9"><a xlink:href="#" xlink:title="funcs_in_our_with_block(self) &#45;&gt; List[Callable]">
<text text-anchor="start" x="8" y="-113.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">funcs_in_our_with_block()</text>
</a>
</g>
<g id="a_node1_10"><a xlink:href="#" xlink:title="instrument(self, item: Any) &#45;&gt; Any:&#10;Instrument `item`, transforming its source code, and re&#45;defining it.">
<text text-anchor="start" x="8" y="-102" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">instrument()</text>
</a>
</g>
<g id="a_node1_11"><a xlink:href="#" xlink:title="our_with_block(self) &#45;&gt; ast.With:&#10;Return the currently active `with` block.">
<text text-anchor="start" x="8" y="-88.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">our_with_block()</text>
</a>
</g>
<g id="a_node1_12"><a xlink:href="#" xlink:title="parse(self, item: Any) &#45;&gt; ast.AST:&#10;Parse `item`, returning its AST">
<text text-anchor="start" x="8" y="-75.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">parse()</text>
</a>
</g>
<g id="a_node1_13"><a xlink:href="#" xlink:title="restore(self) &#45;&gt; None:&#10;Restore original code.">
<text text-anchor="start" x="8" y="-63.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">restore()</text>
</a>
</g>
<g id="a_node1_14"><a xlink:href="#" xlink:title="transform(self, tree: ast.AST) &#45;&gt; ast.AST:&#10;Apply transformers on `tree`. May be extended in subclasses.">
<text text-anchor="start" x="8" y="-51" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">transform()</text>
</a>
</g>
<g id="a_node1_15"><a xlink:href="#" xlink:title="transformers(self) &#45;&gt; List[ast.NodeTransformer]:&#10;List of transformers to apply. To be extended in subclasses.">
<text text-anchor="start" x="8" y="-38.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">transformers()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Instrumenter -->
<g id="node2" class="node">
<title>Instrumenter</title>
<g id="a_node2"><a xlink:href="#" xlink:title="class Instrumenter:&#10;Instrument functions for dynamic tracking">
<polygon fill="none" stroke="black" points="18,-458.88 18,-568.62 208,-568.62 208,-458.88 18,-458.88"/>
<text text-anchor="start" x="75.5" y="-552.33" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-style="italic" font-size="14.00" fill="#6a0dad">Instrumenter</text>
<polyline fill="none" stroke="black" points="18,-543.38 208,-543.38"/>
<g id="a_node2_16"><a xlink:href="#" xlink:title="Instrumenter">
<g id="a_node2_17"><a xlink:href="#" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Instrument sources">
<text text-anchor="start" x="26" y="-530.88" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__enter__()</text>
</a>
</g>
<g id="a_node2_18"><a xlink:href="#" xlink:title="__exit__(self, exc_type: Type, exc_value: BaseException, traceback: traceback) &#45;&gt; Optional[bool]:&#10;Restore sources">
<text text-anchor="start" x="26" y="-518.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__exit__()</text>
</a>
</g>
<g id="a_node2_19"><a xlink:href="#" xlink:title="__init__(self, *items_to_instrument: Callable, globals: Optional[Dict[str, Any]] = None, log: Union[bool, int] = False) &#45;&gt; None:&#10;Create an instrumenter.&#10;`items_to_instrument` is a list of items to instrument.&#10;`globals` is a namespace to use (default: caller&#39;s globals())">
<text text-anchor="start" x="26" y="-505.38" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node2_20"><a xlink:href="#" xlink:title="instrument(self, item: Any) &#45;&gt; Any:&#10;Instrument `item`. To be overloaded in subclasses.">
<text text-anchor="start" x="26" y="-492.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">instrument()</text>
</a>
</g>
<g id="a_node2_21"><a xlink:href="#" xlink:title="default_items_to_instrument(self) &#45;&gt; List[Callable]">
<text text-anchor="start" x="26" y="-479.88" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">default_items_to_instrument()</text>
</a>
</g>
<g id="a_node2_22"><a xlink:href="#" xlink:title="restore(self) &#45;&gt; None">
<text text-anchor="start" x="26" y="-467.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">restore()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Slicer&#45;&gt;Instrumenter -->
<g id="edge1" class="edge">
<title>Slicer&#45;&gt;Instrumenter</title>
<path fill="none" stroke="black" d="M100.44,-254.86C103.5,-317.71 107.22,-394.01 109.81,-447.25"/>
<polygon fill="none" stroke="black" points="106.31,-447.25 110.29,-457.07 113.3,-446.91 106.31,-447.25"/>
</g>
<!-- StackInspector -->
<g id="node3" class="node">
<title>StackInspector</title>
<g id="a_node3"><a xlink:href="StackInspector.html" xlink:title="class StackInspector:&#10;Provide functions to inspect the stack">
<polygon fill="none" stroke="black" points="211,-743.5 211,-886.75 377,-886.75 377,-743.5 211,-743.5"/>
<text text-anchor="start" x="248.62" y="-870.45" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-style="italic" font-size="14.00" fill="#6a0dad">StackInspector</text>
<polyline fill="none" stroke="black" points="211,-861.5 377,-861.5"/>
<g id="a_node3_23"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_24"><a xlink:href="StackInspector.html" xlink:title="_generated_function_cache = {(&#39;&lt;module&gt;&#39;, 2): &lt;function &lt;module&gt;&gt;, (&#39;&lt;module&gt;&#39;, 1): &lt;function &lt;module&gt;&gt;, (&#39;&lt;module&gt;&#39;, 3): &lt;function &lt;module&gt;&gt;, (&#39;&lt;module&gt;&#39;, 4): &lt;function &lt;module&gt;&gt;}">
<text text-anchor="start" x="219" y="-848" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">_generated_function_cache</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="black" points="211,-840.75 377,-840.75"/>
<g id="a_node3_25"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_26"><a xlink:href="StackInspector.html" xlink:title="caller_frame(self) &#45;&gt; frame:&#10;Return the frame of the caller.">
<text text-anchor="start" x="243" y="-828.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_frame()</text>
</a>
</g>
<g id="a_node3_27"><a xlink:href="StackInspector.html" xlink:title="caller_function(self) &#45;&gt; Callable:&#10;Return the calling function">
<text text-anchor="start" x="243" y="-815.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_function()</text>
</a>
</g>
<g id="a_node3_28"><a xlink:href="StackInspector.html" xlink:title="caller_globals(self) &#45;&gt; Dict[str, Any]:&#10;Return the globals() environment of the caller.">
<text text-anchor="start" x="243" y="-802.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_globals()</text>
</a>
</g>
<g id="a_node3_29"><a xlink:href="StackInspector.html" xlink:title="caller_locals(self) &#45;&gt; Dict[str, Any]:&#10;Return the locals() environment of the caller.">
<text text-anchor="start" x="243" y="-790" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_locals()</text>
</a>
</g>
<g id="a_node3_30"><a xlink:href="StackInspector.html" xlink:title="caller_location(self) &#45;&gt; Tuple[Callable, int]:&#10;Return the location (func, lineno) of the caller.">
<text text-anchor="start" x="243" y="-777.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_location()</text>
</a>
</g>
<g id="a_node3_31"><a xlink:href="StackInspector.html" xlink:title="search_frame(self, name: str, frame: Optional[frame] = None) &#45;&gt; Tuple[Optional[frame], Optional[Callable]]:&#10;Return a pair (`frame`, `item`)&#10;in which the function `name` is defined as `item`.">
<text text-anchor="start" x="243" y="-764.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">search_frame()</text>
</a>
</g>
<g id="a_node3_32"><a xlink:href="StackInspector.html" xlink:title="search_func(self, name: str, frame: Optional[frame] = None) &#45;&gt; Optional[Callable]:&#10;Search in callers for a definition of the function `name`">
<text text-anchor="start" x="243" y="-751.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">search_func()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Instrumenter&#45;&gt;StackInspector -->
<g id="edge2" class="edge">
<title>Instrumenter&#45;&gt;StackInspector</title>
<path fill="none" stroke="black" d="M144.17,-568.91C166.59,-607.59 197.74,-660.75 226,-707 231.27,-715.63 236.84,-724.61 242.43,-733.53"/>
<polygon fill="none" stroke="black" points="239.4,-735.29 247.68,-741.89 245.32,-731.56 239.4,-735.29"/>
</g>
<!-- DependencyTracker -->
<g id="node4" class="node">
<title>DependencyTracker</title>
<g id="a_node4"><a xlink:href="#" xlink:title="class DependencyTracker:&#10;Track dependencies during execution">
<polygon fill="none" stroke="black" points="208,-0.5 208,-284 398,-284 398,-0.5 208,-0.5"/>
<text text-anchor="start" x="239.25" y="-267.7" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">DependencyTracker</text>
<polyline fill="none" stroke="black" points="208,-258.75 398,-258.75"/>
<g id="a_node4_33"><a xlink:href="#" xlink:title="DependencyTracker">
<g id="a_node4_34"><a xlink:href="#" xlink:title="TEST = &#39;&lt;test&gt;&#39;">
<text text-anchor="start" x="291" y="-245.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">TEST</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="black" points="208,-238 398,-238"/>
<g id="a_node4_35"><a xlink:href="#" xlink:title="DependencyTracker">
<g id="a_node4_36"><a xlink:href="#" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Track entering an if/while/for block">
<text text-anchor="start" x="216" y="-225.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__enter__()</text>
</a>
</g>
<g id="a_node4_37"><a xlink:href="#" xlink:title="__exit__(self, exc_type: Type, exc_value: BaseException, traceback: traceback) &#45;&gt; Optional[bool]:&#10;Track exiting an if/while/for block">
<text text-anchor="start" x="216" y="-212.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__exit__()</text>
</a>
</g>
<g id="a_node4_38"><a xlink:href="#" xlink:title="__init__(self, *args: Any, **kwargs: Any) &#45;&gt; None:&#10;Constructor. Arguments are passed to DataTracker.__init__()">
<text text-anchor="start" x="216" y="-200" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node4_39"><a xlink:href="#" xlink:title="arg(self, value: Any, pos: Optional[int] = None, kw: Optional[str] = None) &#45;&gt; Any:&#10;Track passing an argument `value`&#10;(with given position `pos` 1..n or keyword `kw`)">
<text text-anchor="start" x="216" y="-187.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">arg()</text>
</a>
</g>
<g id="a_node4_40"><a xlink:href="#" xlink:title="call(self, func: Callable) &#45;&gt; Callable:&#10;Track a call of function `func`">
<text text-anchor="start" x="216" y="-174.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">call()</text>
</a>
</g>
<g id="a_node4_41"><a xlink:href="#" xlink:title="get(self, name: str, value: Any) &#45;&gt; Any:&#10;Track a read access for variable `name` with value `value`">
<text text-anchor="start" x="216" y="-161.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">get()</text>
</a>
</g>
<g id="a_node4_42"><a xlink:href="#" xlink:title="param(self, name: str, value: Any, pos: Optional[int] = None, vararg: str = &#39;&#39;, last: bool = False) &#45;&gt; Any:&#10;Track getting a parameter `name` with value `value`&#10;(with given position `pos`).&#10;vararg parameters are indicated by setting `varargs` to&#10;&#39;*&#39; (*args) or &#39;**&#39; (**kwargs)">
<text text-anchor="start" x="216" y="-149" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">param()</text>
</a>
</g>
<g id="a_node4_43"><a xlink:href="#" xlink:title="ret(self, value: Any) &#45;&gt; Any:&#10;Track a function return">
<text text-anchor="start" x="216" y="-136.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">ret()</text>
</a>
</g>
<g id="a_node4_44"><a xlink:href="#" xlink:title="set(self, name: str, value: Any, loads: Optional[Set[str]] = None) &#45;&gt; Any:&#10;Add a dependency for `name` = `value`">
<text text-anchor="start" x="216" y="-123.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">set()</text>
</a>
</g>
<g id="a_node4_45"><a xlink:href="#" xlink:title="test(self, value: Any) &#45;&gt; Any:&#10;Track a test for condition `value`">
<text text-anchor="start" x="216" y="-110.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">test()</text>
</a>
</g>
<g id="a_node4_46"><a xlink:href="#" xlink:title="call_generator(self, func: Callable) &#45;&gt; Callable:&#10;Track a call of a generator function">
<text text-anchor="start" x="216" y="-97" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">call_generator()</text>
</a>
</g>
<g id="a_node4_47"><a xlink:href="#" xlink:title="check_location(self) &#45;&gt; None:&#10;If we are in a new location, clear set of read variables">
<text text-anchor="start" x="216" y="-84.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">check_location()</text>
</a>
</g>
<g id="a_node4_48"><a xlink:href="#" xlink:title="clear_read(self) &#45;&gt; None:&#10;Clear set of read variables">
<text text-anchor="start" x="216" y="-71.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">clear_read()</text>
</a>
</g>
<g id="a_node4_49"><a xlink:href="#" xlink:title="dependencies(self) &#45;&gt; Dependencies:&#10;Return dependencies">
<text text-anchor="start" x="216" y="-58.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">dependencies()</text>
</a>
</g>
<g id="a_node4_50"><a xlink:href="#" xlink:title="ignore_location_change(self) &#45;&gt; None">
<text text-anchor="start" x="216" y="-46" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">ignore_location_change()</text>
</a>
</g>
<g id="a_node4_51"><a xlink:href="#" xlink:title="ignore_next_location_change(self) &#45;&gt; None">
<text text-anchor="start" x="216" y="-33.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">ignore_next_location_change()</text>
</a>
</g>
<g id="a_node4_52"><a xlink:href="#" xlink:title="in_generator(self) &#45;&gt; bool:&#10;True if we are calling a generator function">
<text text-anchor="start" x="216" y="-20.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">in_generator()</text>
</a>
</g>
<g id="a_node4_53"><a xlink:href="#" xlink:title="ret_generator(self, generator: Any) &#45;&gt; Any:&#10;Track the return of a generator function">
<text text-anchor="start" x="216" y="-7.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">ret_generator()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- DataTracker -->
<g id="node5" class="node">
<title>DataTracker</title>
<g id="a_node5"><a xlink:href="#" xlink:title="class DataTracker:&#10;Track data accesses during execution">
<polygon fill="none" stroke="black" points="235,-420.62 235,-606.88 353,-606.88 353,-420.62 235,-420.62"/>
<text text-anchor="start" x="257.25" y="-590.58" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">DataTracker</text>
<polyline fill="none" stroke="black" points="235,-581.62 353,-581.62"/>
<g id="a_node5_54"><a xlink:href="#" xlink:title="DataTracker">
<g id="a_node5_55"><a xlink:href="#" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Enter `with` block. To be overloaded in subclasses.">
<text text-anchor="start" x="243" y="-569.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__enter__()</text>
</a>
</g>
<g id="a_node5_56"><a xlink:href="#" xlink:title="__exit__(self, exc_type: Type, exc_value: BaseException, traceback: traceback) &#45;&gt; Optional[bool]:&#10;Exit `with` block. To be overloaded in subclasses.">
<text text-anchor="start" x="243" y="-556.38" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__exit__()</text>
</a>
</g>
<g id="a_node5_57"><a xlink:href="#" xlink:title="__init__(self, log: bool = False) &#45;&gt; None:&#10;Constructor. If `log` is set, turn on logging.">
<text text-anchor="start" x="243" y="-543.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node5_58"><a xlink:href="#" xlink:title="arg(self, value: Any, pos: Optional[int] = None, kw: Optional[str] = None) &#45;&gt; Any:&#10;Track `value` being passed as argument.&#10;`pos` (if given) is the argument position (starting with 1).&#10;`kw` (if given) is the argument keyword.">
<text text-anchor="start" x="243" y="-530.88" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">arg()</text>
</a>
</g>
<g id="a_node5_59"><a xlink:href="#" xlink:title="augment(self, name: str, value: Any) &#45;&gt; Any:&#10;Track augmenting `name` with `value`.&#10;To be overloaded in subclasses.">
<text text-anchor="start" x="243" y="-518.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">augment()</text>
</a>
</g>
<g id="a_node5_60"><a xlink:href="#" xlink:title="call(self, func: Callable) &#45;&gt; Callable:&#10;Track a call to `func`.">
<text text-anchor="start" x="243" y="-505.38" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">call()</text>
</a>
</g>
<g id="a_node5_61"><a xlink:href="#" xlink:title="get(self, name: str, value: Any) &#45;&gt; Any:&#10;Track getting `value` from `name`.">
<text text-anchor="start" x="243" y="-492.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">get()</text>
</a>
</g>
<g id="a_node5_62"><a xlink:href="#" xlink:title="param(self, name: str, value: Any, pos: Optional[int] = None, vararg: str = &#39;&#39;, last: bool = False) &#45;&gt; Any:&#10;At the beginning of a function, track parameter `name` being set to `value`.&#10;`pos` is the position of the argument (starting with 1).&#10;`vararg` is &quot;*&quot; if `name` is a vararg parameter (as in *args),&#10;and &quot;**&quot; is `name` is a kwargs parameter (as in *kwargs).&#10;`last` is True if `name` is the last parameter.">
<text text-anchor="start" x="243" y="-479.88" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">param()</text>
</a>
</g>
<g id="a_node5_63"><a xlink:href="#" xlink:title="ret(self, value: Any) &#45;&gt; Any:&#10;Track `value` being used as return value.">
<text text-anchor="start" x="243" y="-467.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">ret()</text>
</a>
</g>
<g id="a_node5_64"><a xlink:href="#" xlink:title="set(self, name: str, value: Any, loads: Optional[Set[str]] = None) &#45;&gt; Any:&#10;Track setting `name` to `value`.">
<text text-anchor="start" x="243" y="-454.38" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">set()</text>
</a>
</g>
<g id="a_node5_65"><a xlink:href="#" xlink:title="test(self, cond: ast.AST) &#45;&gt; ast.AST:&#10;Test condition `cond`. To be overloaded in subclasses.">
<text text-anchor="start" x="243" y="-441.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">test()</text>
</a>
</g>
<g id="a_node5_66"><a xlink:href="#" xlink:title="instrument_call(self, func: Callable) &#45;&gt; Callable:&#10;Instrument a call to `func`. To be implemented in subclasses.">
<text text-anchor="start" x="243" y="-428.88" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">instrument_call()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- DependencyTracker&#45;&gt;DataTracker -->
<g id="edge3" class="edge">
<title>DependencyTracker&#45;&gt;DataTracker</title>
<path fill="none" stroke="black" d="M299.57,-284.26C298.56,-325.73 297.47,-370.31 296.53,-408.99"/>
<polygon fill="none" stroke="black" points="293.03,-408.67 296.29,-418.75 300.03,-408.84 293.03,-408.67"/>
</g>
<!-- DataTracker&#45;&gt;StackInspector -->
<g id="edge4" class="edge">
<title>DataTracker&#45;&gt;StackInspector</title>
<path fill="none" stroke="black" d="M294,-607.02C294,-646.89 294,-693.17 294,-731.86"/>
<polygon fill="none" stroke="black" points="290.5,-731.56 294,-741.56 297.5,-731.56 290.5,-731.56"/>
</g>
<!-- Dependencies -->
<g id="node6" class="node">
<title>Dependencies</title>
<g id="a_node6"><a xlink:href="#" xlink:title="class Dependencies:&#10;A dependency graph">
<polygon fill="none" stroke="black" points="371,-321 371,-706.5 501,-706.5 501,-321 371,-321"/>
<text text-anchor="start" x="389.5" y="-690.2" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">Dependencies</text>
<polyline fill="none" stroke="black" points="371,-681.25 501,-681.25"/>
<g id="a_node6_67"><a xlink:href="#" xlink:title="Dependencies">
<g id="a_node6_68"><a xlink:href="#" xlink:title="FONT_NAME = &#39;Courier&#39;">
<text text-anchor="start" x="406" y="-667.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">FONT_NAME</text>
</a>
</g>
<g id="a_node6_69"><a xlink:href="#" xlink:title="NODE_COLOR = &#39;peachpuff&#39;">
<text text-anchor="start" x="406" y="-655" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">NODE_COLOR</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="black" points="371,-647.75 501,-647.75"/>
<g id="a_node6_70"><a xlink:href="#" xlink:title="Dependencies">
<g id="a_node6_71"><a xlink:href="#" xlink:title="__init__(self, data: Optional[Dict[Tuple[str, Tuple[Callable, int]], Set[Tuple[str, Tuple[Callable, int]]]]] = None, control: Optional[Dict[Tuple[str, Tuple[Callable, int]], Set[Tuple[str, Tuple[Callable, int]]]]] = None) &#45;&gt; None:&#10;Create a dependency graph from `data` and `control`.&#10;Both `data` and `control` are dictionaries&#10;holding _nodes_ as keys and sets of nodes as values.&#10;Each node comes as a tuple (variable_name, location)&#10;where `variable_name` is a string&#10;and `location` is a pair (function, lineno)&#10;where `function` is a callable and `lineno` is a line number&#10;denoting a unique location in the code.">
<text text-anchor="start" x="379" y="-635.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node6_72"><a xlink:href="#" xlink:title="__repr__(self) &#45;&gt; str:&#10;Represent dependencies as a Python expression">
<text text-anchor="start" x="379" y="-622.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__repr__()</text>
</a>
</g>
<g id="a_node6_73"><a xlink:href="#" xlink:title="__str__(self) &#45;&gt; str:&#10;Return string representation of dependencies">
<text text-anchor="start" x="379" y="-609.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__str__()</text>
</a>
</g>
<g id="a_node6_74"><a xlink:href="#" xlink:title="_repr_mimebundle_(self, include: Any = None, exclude: Any = None) &#45;&gt; Any:&#10;If the object is output in Jupyter, render dependencies as a SVG graph">
<text text-anchor="start" x="379" y="-597" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">_repr_mimebundle_()</text>
</a>
</g>
<g id="a_node6_75"><a xlink:href="#" xlink:title="all_functions(self) &#45;&gt; Dict[Callable, List[Tuple[int, Tuple[str, Tuple[Callable, int]]]]]:&#10;Return mapping&#10;{`function`: [(`lineno`, `var`), (`lineno`, `var`), ...], ...}&#10;for all functions in the dependencies.">
<text text-anchor="start" x="379" y="-584.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">all_functions()</text>
</a>
</g>
<g id="a_node6_76"><a xlink:href="#" xlink:title="all_vars(self) &#45;&gt; Set[Tuple[str, Tuple[Callable, int]]]:&#10;Return a set of all variables (as `var_name`, `location`) in the dependencies">
<text text-anchor="start" x="379" y="-571.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">all_vars()</text>
</a>
</g>
<g id="a_node6_77"><a xlink:href="#" xlink:title="backward_slice(self, *criteria: Union[str, Tuple[Callable, int], Tuple[str, Tuple[Callable, int]]], mode: str = &#39;cd&#39;, depth: int = &#45;1) &#45;&gt; Dependencies:&#10;Create a backward slice from nodes `criteria`.&#10;`mode` can contain &#39;c&#39; (draw control dependencies)&#10;and &#39;d&#39; (draw data dependencies) (default: &#39;cd&#39;)">
<text text-anchor="start" x="379" y="-558.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">backward_slice()</text>
</a>
</g>
<g id="a_node6_78"><a xlink:href="#" xlink:title="code(self, *items: Callable, mode: str = &#39;cd&#39;) &#45;&gt; None:&#10;List `items` on standard output, including dependencies as comments.&#10;If `items` is empty, all included functions are listed.&#10;`mode` can contain &#39;c&#39; (draw control dependencies) and &#39;d&#39; (draw data dependencies)&#10;(default: &#39;cd&#39;).">
<text text-anchor="start" x="379" y="-546" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">code()</text>
</a>
</g>
<g id="a_node6_79"><a xlink:href="#" xlink:title="graph(self, *, mode: str = &#39;flow&#39;) &#45;&gt; graphviz.graphs.Digraph:&#10;Draw dependencies. `mode` is either&#10;* `&#39;flow&#39;`: arrows indicate information flow (from A to B); or&#10;* `&#39;depend&#39;`: arrows indicate dependencies (B depends on A)">
<text text-anchor="start" x="379" y="-533.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">graph()</text>
</a>
</g>
<g id="a_node6_80"><a xlink:href="#" xlink:title="_code(self, item: Callable, mode: str) &#45;&gt; None">
<text text-anchor="start" x="379" y="-519.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">_code()</text>
</a>
</g>
<g id="a_node6_81"><a xlink:href="#" xlink:title="_source(self, node: Tuple[str, Tuple[Callable, int]]) &#45;&gt; str">
<text text-anchor="start" x="379" y="-506.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">_source()</text>
</a>
</g>
<g id="a_node6_82"><a xlink:href="#" xlink:title="add_hierarchy(self, g: graphviz.graphs.Digraph) &#45;&gt; graphviz.graphs.Digraph:&#10;Add invisible edges for a proper hierarchy.">
<text text-anchor="start" x="379" y="-494" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">add_hierarchy()</text>
</a>
</g>
<g id="a_node6_83"><a xlink:href="#" xlink:title="draw_dependencies(self, g: graphviz.graphs.Digraph, mode: str) &#45;&gt; None">
<text text-anchor="start" x="379" y="-481.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">draw_dependencies()</text>
</a>
</g>
<g id="a_node6_84"><a xlink:href="#" xlink:title="draw_edge(self, g: graphviz.graphs.Digraph, mode: str, node_from: str, node_to: str, **kwargs: Any) &#45;&gt; None">
<text text-anchor="start" x="379" y="-468.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">draw_edge()</text>
</a>
</g>
<g id="a_node6_85"><a xlink:href="#" xlink:title="expand_criteria(self, criteria: List[Union[str, Tuple[Callable, int], Tuple[str, Tuple[Callable, int]]]]) &#45;&gt; List[Tuple[str, Tuple[Callable, int]]]:&#10;Return list of vars matched by `criteria`.">
<text text-anchor="start" x="379" y="-455.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">expand_criteria()</text>
</a>
</g>
<g id="a_node6_86"><a xlink:href="#" xlink:title="format_var(self, var: Tuple[str, Tuple[Callable, int]], current_func: Optional[Callable] = None) &#45;&gt; str:&#10;Return string for `var` in `current_func`.">
<text text-anchor="start" x="379" y="-443" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">format_var()</text>
</a>
</g>
<g id="a_node6_87"><a xlink:href="#" xlink:title="id(self, var: Tuple[str, Tuple[Callable, int]]) &#45;&gt; str:&#10;Return a unique ID for `var`.">
<text text-anchor="start" x="379" y="-430.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">id()</text>
</a>
</g>
<g id="a_node6_88"><a xlink:href="#" xlink:title="label(self, var: Tuple[str, Tuple[Callable, int]]) &#45;&gt; str:&#10;Render node `var` using HTML style.">
<text text-anchor="start" x="379" y="-417.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">label()</text>
</a>
</g>
<g id="a_node6_89"><a xlink:href="#" xlink:title="make_graph(self, name: str = &#39;dependencies&#39;, comment: str = &#39;Dependencies&#39;) &#45;&gt; graphviz.graphs.Digraph">
<text text-anchor="start" x="379" y="-404.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">make_graph()</text>
</a>
</g>
<g id="a_node6_90"><a xlink:href="#" xlink:title="repr_dependencies(self, vars: Dict[Tuple[str, Tuple[Callable, int]], Set[Tuple[str, Tuple[Callable, int]]]]) &#45;&gt; str">
<text text-anchor="start" x="379" y="-392" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">repr_dependencies()</text>
</a>
</g>
<g id="a_node6_91"><a xlink:href="#" xlink:title="repr_deps(self, var_set: Set[Tuple[str, Tuple[Callable, int]]]) &#45;&gt; str">
<text text-anchor="start" x="379" y="-379.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">repr_deps()</text>
</a>
</g>
<g id="a_node6_92"><a xlink:href="#" xlink:title="repr_var(self, var: Tuple[str, Tuple[Callable, int]]) &#45;&gt; str">
<text text-anchor="start" x="379" y="-366.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">repr_var()</text>
</a>
</g>
<g id="a_node6_93"><a xlink:href="#" xlink:title="source(self, node: Tuple[str, Tuple[Callable, int]]) &#45;&gt; str:&#10;Return the source code for a given node.">
<text text-anchor="start" x="379" y="-353.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">source()</text>
</a>
</g>
<g id="a_node6_94"><a xlink:href="#" xlink:title="tooltip(self, var: Tuple[str, Tuple[Callable, int]]) &#45;&gt; str:&#10;Return a tooltip for node `var`.">
<text text-anchor="start" x="379" y="-341" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">tooltip()</text>
</a>
</g>
<g id="a_node6_95"><a xlink:href="#" xlink:title="validate(self) &#45;&gt; None:&#10;Perform a simple syntactic validation of dependencies">
<text text-anchor="start" x="379" y="-328.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">validate()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Dependencies&#45;&gt;StackInspector -->
<g id="edge5" class="edge">
<title>Dependencies&#45;&gt;StackInspector</title>
<path fill="none" stroke="black" d="M370.55,-689.37C367.75,-695.36 364.9,-701.25 362,-707 357.61,-715.72 352.7,-724.63 347.58,-733.41"/>
<polygon fill="none" stroke="black" points="344.61,-731.55 342.51,-741.94 350.63,-735.13 344.61,-731.55"/>
</g>
<!-- Legend -->
<g id="node7" class="node">
<title>Legend</title>
<text text-anchor="start" x="416.38" y="-158.25" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="10.00" fill="#6a0dad">Legend</text>
<text text-anchor="start" x="416.38" y="-148.25" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00"></text>
<text text-anchor="start" x="422.38" y="-148.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text text-anchor="start" x="416.38" y="-138.25" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00"></text>
<text text-anchor="start" x="422.38" y="-138.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text text-anchor="start" x="416.38" y="-128.25" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00"></text>
<text text-anchor="start" x="422.38" y="-128.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text text-anchor="start" x="416.38" y="-119.2" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Dependencies">Dependencies<a class="anchor-link" href="#Dependencies">&#182;</a></h2><p>In the <a href="Intro_Debugging.html">Introduction to debugging</a>, we have seen how faults in a program state propagate to eventually become visible as failures. This induces a debugging strategy called <em>tracking origins</em>:</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><ol>
<li>We start with a single faulty state <em>f</em> the failure.</li>
<li>We determine <em>f</em>'s <em>origins</em>  the parts of earlier states that could have caused the faulty state <em>f</em>.</li>
<li>For each of these origins <em>e</em>, we determine whether they are faulty or not.</li>
<li>For each of the faulty origins, we in turn determine <em>their</em> origins.</li>
<li>If we find a part of the state that is faulty, yet has only correct origins, we have found the defect.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In all generality, a "part of the state" can be anything that can influence the program  some configuration setting, some database content, or the state of a device. Almost always, though, it is through <em>individual variables</em> that a part of the state manifests itself.</p>
<p>The good news is that variables do not take arbitrary values at arbitrary times instead, they are set and accessed at precise moments in time, as determined by the program's semantics. This allows us to determine their <em>origins</em> by reading program code.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us assume you have a piece of code that reads as follows. The <code>middle()</code> function is supposed to return the "middle" number of three values <code>x</code>, <code>y</code>, and <code>z</code>  that is, the one number that neither is the minimum nor the maximum.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">middle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">z</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">z</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">z</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">z</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In most cases, <code>middle()</code> runs just fine:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>2
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In others, however, it returns the wrong value:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is a typical debugging situation: You see a value that is erroneous; and you want to find out where it came from.</p>
<ul>
<li>In our case, we see that the erroneous value was returned from <code>middle()</code>, so we identify the five <code>return</code> statements in <code>middle()</code> that the value could have come from.</li>
<li>The value returned is the value of <code>y</code>, and neither <code>x</code>, <code>y</code>, nor <code>z</code> are altered during the execution of <code>middle()</code>. Hence, it must be one of the three <code>return y</code> statements that is the origin of <code>m</code>. But which one?</li>
</ul>
<p>For our small example, we can fire up an interactive debugger and simply step through the function; this reveals us the conditions evaluated and the <code>return</code> statement executed.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="Debugger.html" class="import" target="_blank">Debugger</a></span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Debugger</span><span class="o">.</span><span class="n">Debugger</span><span class="p">():</span>
    <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling middle(x = 2, y = 1, z = 3)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2     if y &lt; z:
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3         if x &lt; y:
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5         elif x &lt; z:
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>step</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>6             return y
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>quit</b></samp>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We now see that it was the second <code>return</code> statement that returned the incorrect value. But why was it executed after all? To this end, we can resort to the <code>middle()</code> source code and have a look at those conditions that caused the <code>return y</code> statement to be executed. Indeed, the conditions <code>y &lt; z</code>, <code>x &gt; y</code>, and finally <code>x &lt; z</code> again are <em>origins</em> of the returned value  and in turn have <code>x</code>, <code>y</code>, and <code>z</code> as origins.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In our above reasoning about origins, we have encountered two kinds of origins:</p>
<ul>
<li>earlier <em>data values</em> (such as the value of <code>y</code> being returned) and</li>
<li>earlier <em>control conditions</em> (such as the <code>if</code> conditions governing the <code>return y</code> statement).</li>
</ul>
<p>The later parts of the state that can be influenced by such origins are said to be <em>dependent</em> on these origins. Speaking of variables, a variable $x$ <em>depends</em> on the value of a variable $y$ (written as $x \leftarrow y$) if a change in $y$ could affect the value of $x$.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We distinguish two kinds of dependencies $x \leftarrow y$, aligned with the two kinds of origins as outlined above:</p>
<ul>
<li><strong>Data dependency</strong>: $x$ is assigned a value computed from $y$. In our example, <code>m</code> is data dependent on the return value of <code>middle()</code>.</li>
<li><strong>Control dependency</strong>: A statement involving $x$ is executed <em>only</em> because a <em>condition</em> involving $y$ was evaluated, influencing the execution path. In our example, the value returned by <code>return y</code> is control dependent on the several conditions along its path, which involve <code>x</code>, <code>y</code>, and <code>z</code>.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us examine these dependencies in more detail.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Visualizing-Dependencies">
<summary>Visualizing Dependencies</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note: This is an excursion, diverting away from the main flow of the chapter. Unless you know what you are doing, you are encouraged to skip this part.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To illustrate our examples, we introduce a <code>Dependencies</code> class that captures dependencies between variables at specific locations.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="A-Class-for-Dependencies">A Class for Dependencies<a class="anchor-link" href="#A-Class-for-Dependencies">&#182;</a></h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>Dependencies</code> holds two dependency graphs. <code>data</code> holds data dependencies, <code>control</code> holds control dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Each of the two is organized as a dictionary holding <em>nodes</em> as keys and sets of nodes as values. Each node comes as a tuple</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
</pre></div>
<p>where <code>variable_name</code> is a string and <code>location</code> is a pair</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span>
</pre></div>
<p>denoting a unique location in the code.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is also reflected in the following type definitions:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Location</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">Node</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Location</span><span class="p">]</span>
<span class="n">Dependency</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">]]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In this chapter, for many purposes, we need to lookup a function's location, source code, or simply definition. The class <code>StackInspector</code> provides a number of convenience functions for this purpose.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="StackInspector.html" class="import" target="_blank">StackInspector</a></span> <span class="kn">import</span> <span class="n">StackInspector</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>Dependencies</code> class builds on <code>StackInspector</code> to capture dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">StackInspector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A dependency graph&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dependency</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">control</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dependency</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a dependency graph from `data` and `control`.</span>
<span class="sd">        Both `data` and `control` are dictionaries</span>
<span class="sd">        holding _nodes_ as keys and sets of nodes as values.</span>
<span class="sd">        Each node comes as a tuple (variable_name, location)</span>
<span class="sd">        where `variable_name` is a string </span>
<span class="sd">        and `location` is a pair (function, lineno)</span>
<span class="sd">        where `function` is a callable and `lineno` is a line number</span>
<span class="sd">        denoting a unique location in the code.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">control</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">control</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="o">=</span> <span class="n">control</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>validate()</code> method checks for consistency.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check dependency structure.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">var_name</span><span class="p">,</span> <span class="n">location</span> <span class="o">=</span> <span class="n">node</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>
            <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>source()</code> method returns the source code for a given node.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_deps</span> <span class="o">=</span> <span class="n">Dependencies</span><span class="p">()</span>
<span class="n">test_deps</span><span class="o">.</span><span class="n">source</span><span class="p">((</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;def middle(x, y, z):  # type: ignore&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Drawing-Dependencies">Drawing Dependencies<a class="anchor-link" href="#Drawing-Dependencies">&#182;</a></h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Both data and control form a graph between nodes, and can be visualized as such. We use the <code>graphviz</code> package for creating such visualizations.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>make_graph()</code> sets the basic graph attributes.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/html.html" class="import" target="_blank">html</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="n">NODE_COLOR</span> <span class="o">=</span> <span class="s1">&#39;peachpuff&#39;</span>
    <span class="n">FONT_NAME</span> <span class="o">=</span> <span class="s1">&#39;Courier&#39;</span>  <span class="c1"># &#39;Fira Mono&#39; may produce warnings in &#39;dot&#39;</span>

    <span class="k">def</span> <span class="nf">make_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;dependencies&quot;</span><span class="p">,</span>
                   <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Dependencies&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Digraph</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Digraph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
            <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span>
            <span class="p">},</span>
            <span class="n">node_attr</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;filled&#39;</span><span class="p">,</span>
                <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span>
                <span class="s1">&#39;fillcolor&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">NODE_COLOR</span><span class="p">,</span>
                <span class="s1">&#39;fontname&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">FONT_NAME</span>
            <span class="p">},</span>
            <span class="n">edge_attr</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;fontname&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">FONT_NAME</span>
            <span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>graph()</code> returns a graph visualization.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;flow&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Digraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw dependencies. `mode` is either</span>
<span class="sd">        * `&#39;flow&#39;`: arrows indicate information flow (from A to B); or</span>
<span class="sd">        * `&#39;depend&#39;`: arrows indicate dependencies (B depends on A)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_graph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_dependencies</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_hierarchy</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>

    <span class="k">def</span> <span class="nf">_repr_mimebundle_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If the object is output in Jupyter, render dependencies as a SVG graph&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span><span class="o">.</span><span class="n">_repr_mimebundle_</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The main part of graph drawing takes place in two methods, <code>draw_dependencies()</code> and <code>add_hierarchy()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>draw_dependencies()</code> processes through the graph, adding nodes and edges from the dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">all_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a set of all variables (as `var_name`, `location`) in the dependencies&quot;&quot;&quot;</span>
        <span class="n">all_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">all_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                <span class="n">all_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">:</span>
            <span class="n">all_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                <span class="n">all_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_vars</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">draw_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Digraph</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                  <span class="n">node_from</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">node_to</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;flow&#39;</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">node_from</span><span class="p">,</span> <span class="n">node_to</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;depend&#39;</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">node_from</span><span class="p">,</span> <span class="n">node_to</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;back&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`mode` must be &#39;flow&#39; or &#39;depend&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Digraph</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_vars</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
                   <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
                   <span class="n">tooltip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tooltip</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_edge</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">source</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_edge</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">source</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
                                   <span class="n">style</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>draw_dependencies()</code> makes use of a few helper functions.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a unique ID for `var`.&quot;&quot;&quot;</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># Avoid non-identifier characters</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
                <span class="nb">id</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;,&#39;</span><span class="p">:</span>
                <span class="nb">id</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span>
        <span class="k">return</span> <span class="nb">id</span>

    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Render node `var` using HTML style.&quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span>
        <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">):</span>
            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;I&gt;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&lt;/I&gt;&#39;</span>

        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;B&gt;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&lt;/B&gt;&#39;</span>
        <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">+=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;FONT POINT-SIZE=&quot;9.0&quot;&gt;&lt;BR/&gt;&lt;BR/&gt;&#39;</span>
                      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
                      <span class="sa">f</span><span class="s1">&#39;&lt;/FONT&gt;&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
        <span class="k">return</span> <span class="n">label</span>

    <span class="k">def</span> <span class="nf">tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tooltip for node `var`.&quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span>
        <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In the second part of graph drawing, <code>add_hierarchy()</code> adds invisible edges to ensure that nodes with lower line numbers are drawn above nodes with higher line numbers.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">add_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Digraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Digraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add invisible edges for a proper hierarchy.&quot;&quot;&quot;</span>
        <span class="n">functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
            <span class="n">last_var</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">last_lineno</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">lineno</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">[</span><span class="n">func</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">last_var</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lineno</span> <span class="o">&gt;</span> <span class="n">last_lineno</span><span class="p">:</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">last_var</span><span class="p">),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
                           <span class="n">style</span><span class="o">=</span><span class="s1">&#39;invis&#39;</span><span class="p">)</span>

                <span class="n">last_var</span> <span class="o">=</span> <span class="n">var</span>
                <span class="n">last_lineno</span> <span class="o">=</span> <span class="n">lineno</span>

        <span class="k">return</span> <span class="n">g</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">all_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Node</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return mapping </span>
<span class="sd">        {`function`: [(`lineno`, `var`), (`lineno`, `var`), ...], ...}</span>
<span class="sd">        for all functions in the dependencies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Node</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_vars</span><span class="p">():</span>
            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span>
            <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>
            <span class="k">if</span> <span class="n">func</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
                <span class="n">functions</span><span class="p">[</span><span class="n">func</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">functions</span><span class="p">[</span><span class="n">func</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lineno</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
            <span class="n">functions</span><span class="p">[</span><span class="n">func</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">functions</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here comes the graph in all its glory:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">middle_deps</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dependencies</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Dependencies</span><span class="p">({(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">))},</span> <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">))},</span> <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">5</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">))},</span> <span class="p">(</span><span class="s1">&#39;&lt;middle() return value&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">6</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">))}},</span> <span class="p">{(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">2</span><span class="p">))},</span> <span class="p">(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">5</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">3</span><span class="p">))},</span> <span class="p">(</span><span class="s1">&#39;&lt;middle() return value&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">6</span><span class="p">)):</span> <span class="p">{(</span><span class="s1">&#39;&lt;test&gt;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="mi">5</span><span class="p">))}})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">middle_deps</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="463pt" height="352pt"
 viewBox="0.00 0.00 462.65 352.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-348 458.65,-348 458.65,4 -4,4"/>
<!-- test_functionmiddleat0x10700d120_2 -->
<g id="node1" class="node">
<title>test_functionmiddleat0x10700d120_2</title>
<g id="a_node1"><a xlink:title="middle:2">
<polygon fill="peachpuff" stroke="black" points="215.25,-268 149.75,-268 149.75,-228 215.25,-228 215.25,-268"/>
<text text-anchor="start" x="157.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="158.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">if y &lt; z:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_3 -->
<g id="node7" class="node">
<title>test_functionmiddleat0x10700d120_3</title>
<g id="a_node7"><a xlink:title="middle:3">
<polygon fill="peachpuff" stroke="black" points="215.25,-192 149.75,-192 149.75,-152 215.25,-152 215.25,-192"/>
<text text-anchor="start" x="157.75" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="158.88" y="-157.45" font-family="Courier,monospace" font-size="9.00">if x &lt; y:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge10" class="edge">
<title>test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M176.48,-227.56C175.82,-220.25 175.61,-211.75 175.84,-203.67"/>
<polygon fill="grey" stroke="grey" points="179.32,-204.01 176.4,-193.82 172.34,-203.61 179.32,-204.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<!-- z_functionmiddleat0x10700d120_1 -->
<g id="node2" class="node">
<title>z_functionmiddleat0x10700d120_1</title>
<g id="a_node2"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="428,-344 223,-344 223,-304 428,-304 428,-344"/>
<text text-anchor="start" x="321.38" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="231" y="-309.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<g id="edge1" class="edge">
<title>z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2</title>
<path fill="none" stroke="black" d="M281.91,-303.56C263.44,-294.42 242.06,-283.43 223.85,-273.71"/>
<polygon fill="black" stroke="black" points="225.61,-270.68 215.14,-269.03 222.29,-276.85 225.61,-270.68"/>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<!-- test_functionmiddleat0x10700d120_5 -->
<g id="node5" class="node">
<title>test_functionmiddleat0x10700d120_5</title>
<g id="a_node5"><a xlink:title="middle:5">
<polygon fill="peachpuff" stroke="black" points="219.38,-116 145.62,-116 145.62,-76 219.38,-76 219.38,-116"/>
<text text-anchor="start" x="157.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="153.62" y="-81.45" font-family="Courier,monospace" font-size="9.00">elif x &lt; z:</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge6" class="edge">
<title>z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="black" d="M403.32,-303.64C420.73,-295.53 437.1,-284.1 447.5,-268 457.15,-253.07 456.88,-243.1 447.5,-228 400.08,-151.66 293.55,-118.47 230.96,-105.11"/>
<polygon fill="black" stroke="black" points="231.79,-101.71 221.29,-103.14 230.39,-108.56 231.79,-101.71"/>
</g>
<!-- y_functionmiddleat0x10700d120_1 -->
<g id="node3" class="node">
<title>y_functionmiddleat0x10700d120_1</title>
<g id="a_node3"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="205,-344 0,-344 0,-304 205,-304 205,-344"/>
<text text-anchor="start" x="98.38" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="8" y="-309.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<g id="edge2" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2</title>
<path fill="none" stroke="black" d="M123.52,-303.56C132.61,-295.14 143.41,-285.16 153.27,-276.04"/>
<polygon fill="black" stroke="black" points="155.55,-278.7 160.51,-269.34 150.79,-273.56 155.55,-278.7"/>
</g>
<!-- middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="node4" class="node">
<title>middlereturnvalue_functionmiddleat0x10700d120_6</title>
<g id="a_node4"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="285.38,-40 79.62,-40 79.62,0 285.38,0 285.38,-40"/>
<text text-anchor="start" x="87.62" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="161.5" y="-5.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge3" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="black" d="M101.63,-303.76C100.43,-260.86 101.55,-154.97 136.5,-76 140.83,-66.22 147.43,-56.81 154.3,-48.62"/>
<polygon fill="black" stroke="black" points="156.71,-51.18 160.75,-41.39 151.48,-46.52 156.71,-51.18"/>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge9" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="black" d="M108.48,-303.74C114.99,-284.03 126.38,-252.87 140.5,-228 145.67,-218.89 152.19,-209.61 158.54,-201.32"/>
<polygon fill="black" stroke="black" points="161.16,-203.66 164.62,-193.65 155.67,-199.31 161.16,-203.66"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge4" class="edge">
<title>test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M176.48,-75.56C175.82,-68.25 175.61,-59.75 175.84,-51.67"/>
<polygon fill="grey" stroke="grey" points="179.32,-52.01 176.4,-41.82 172.34,-51.61 179.32,-52.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<!-- x_functionmiddleat0x10700d120_1 -->
<g id="node6" class="node">
<title>x_functionmiddleat0x10700d120_1</title>
<g id="a_node6"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="438,-268 233,-268 233,-228 438,-228 438,-268"/>
<text text-anchor="start" x="331.38" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="241" y="-233.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge5" class="edge">
<title>x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="black" d="M315.81,-227.7C288.96,-201.37 240.71,-154.07 210.21,-124.17"/>
<polygon fill="black" stroke="black" points="212.79,-121.79 203.19,-117.29 207.88,-126.79 212.79,-121.79"/>
</g>
<!-- x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge8" class="edge">
<title>x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="black" d="M295.3,-227.56C274,-217.25 247.8,-204.58 226.02,-194.05"/>
<polygon fill="black" stroke="black" points="227.61,-190.93 217.08,-189.73 224.56,-197.23 227.61,-190.93"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge7" class="edge">
<title>test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M176.48,-151.56C175.82,-144.25 175.61,-135.75 175.84,-127.67"/>
<polygon fill="grey" stroke="grey" points="179.32,-128.01 176.4,-117.82 172.34,-127.61 179.32,-128.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>By default, the arrow direction indicates <em>flows</em>  an arrow <em>A</em>  <em>B</em> indicates that information from <em>A</em> <em>flows</em> into <em>B</em> (and thus the state in <em>A</em> <em>causes</em> the state in <em>B</em>). By setting the extra keyword parameter <code>mode</code> to <code>depend</code> instead of <code>flow</code> (default), you can reverse these arrows; then an arrow <em>A</em>  <em>B</em> indicates <em>A</em> <em>depends</em> on <em>B</em>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">middle_deps</span><span class="p">()</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;depend&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="463pt" height="352pt"
 viewBox="0.00 0.00 462.65 352.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-348 458.65,-348 458.65,4 -4,4"/>
<!-- test_functionmiddleat0x10700d120_2 -->
<g id="node1" class="node">
<title>test_functionmiddleat0x10700d120_2</title>
<g id="a_node1"><a xlink:title="middle:2">
<polygon fill="peachpuff" stroke="black" points="215.25,-268 149.75,-268 149.75,-228 215.25,-228 215.25,-268"/>
<text text-anchor="start" x="157.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="158.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">if y &lt; z:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_3 -->
<g id="node7" class="node">
<title>test_functionmiddleat0x10700d120_3</title>
<g id="a_node7"><a xlink:title="middle:3">
<polygon fill="peachpuff" stroke="black" points="215.25,-192 149.75,-192 149.75,-152 215.25,-152 215.25,-192"/>
<text text-anchor="start" x="157.75" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="158.88" y="-157.45" font-family="Courier,monospace" font-size="9.00">if x &lt; y:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge10" class="edge">
<title>test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M175.83,-216.19C175.61,-208.1 175.83,-199.61 176.49,-192.31"/>
<polygon fill="grey" stroke="grey" points="172.33,-216.26 176.39,-226.05 179.32,-215.86 172.33,-216.26"/>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<!-- z_functionmiddleat0x10700d120_1 -->
<g id="node2" class="node">
<title>z_functionmiddleat0x10700d120_1</title>
<g id="a_node2"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="428,-344 223,-344 223,-304 428,-304 428,-344"/>
<text text-anchor="start" x="321.38" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="231" y="-309.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<g id="edge1" class="edge">
<title>z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2</title>
<path fill="none" stroke="black" d="M271.6,-298.42C252.1,-288.63 230.76,-277.51 213.81,-268.31"/>
<polygon fill="black" stroke="black" points="270.04,-301.55 280.55,-302.88 273.16,-295.29 270.04,-301.55"/>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<!-- test_functionmiddleat0x10700d120_5 -->
<g id="node5" class="node">
<title>test_functionmiddleat0x10700d120_5</title>
<g id="a_node5"><a xlink:title="middle:5">
<polygon fill="peachpuff" stroke="black" points="219.38,-116 145.62,-116 145.62,-76 219.38,-76 219.38,-116"/>
<text text-anchor="start" x="157.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="153.62" y="-81.45" font-family="Courier,monospace" font-size="9.00">elif x &lt; z:</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge6" class="edge">
<title>z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="black" d="M413.37,-298.5C426.9,-290.89 439.13,-280.96 447.5,-268 457.15,-253.07 456.88,-243.1 447.5,-228 397.13,-146.91 280.06,-114.5 219.81,-102.84"/>
<polygon fill="black" stroke="black" points="411.98,-295.28 404.67,-302.95 415.17,-301.51 411.98,-295.28"/>
</g>
<!-- y_functionmiddleat0x10700d120_1 -->
<g id="node3" class="node">
<title>y_functionmiddleat0x10700d120_1</title>
<g id="a_node3"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="205,-344 0,-344 0,-304 205,-304 205,-344"/>
<text text-anchor="start" x="98.38" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="8" y="-309.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<g id="edge2" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2</title>
<path fill="none" stroke="black" d="M131.88,-295.82C141.75,-286.69 152.54,-276.71 161.62,-268.31"/>
<polygon fill="black" stroke="black" points="129.59,-293.17 124.63,-302.53 134.35,-298.31 129.59,-293.17"/>
</g>
<!-- middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="node4" class="node">
<title>middlereturnvalue_functionmiddleat0x10700d120_6</title>
<g id="a_node4"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="285.38,-40 79.62,-40 79.62,0 285.38,0 285.38,-40"/>
<text text-anchor="start" x="87.62" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="161.5" y="-5.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge3" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="black" d="M101.4,-292.29C100.82,-244.07 104.35,-148.64 136.5,-76 142.39,-62.68 152.51,-50.05 161.76,-40.26"/>
<polygon fill="black" stroke="black" points="97.9,-292.31 101.6,-302.24 104.9,-292.18 97.9,-292.31"/>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge9" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="black" d="M112.16,-292.92C118.89,-273.74 128.75,-248.69 140.5,-228 147.62,-215.46 157.29,-202.59 165.56,-192.46"/>
<polygon fill="black" stroke="black" points="108.88,-291.71 108.97,-302.3 115.51,-293.97 108.88,-291.71"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge4" class="edge">
<title>test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M175.83,-64.19C175.61,-56.1 175.83,-47.61 176.49,-40.31"/>
<polygon fill="grey" stroke="grey" points="172.33,-64.26 176.39,-74.05 179.32,-63.86 172.33,-64.26"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<!-- x_functionmiddleat0x10700d120_1 -->
<g id="node6" class="node">
<title>x_functionmiddleat0x10700d120_1</title>
<g id="a_node6"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="438,-268 233,-268 233,-228 438,-228 438,-268"/>
<text text-anchor="start" x="331.38" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="241" y="-233.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge5" class="edge">
<title>x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="black" d="M307.7,-219.75C277.17,-189.82 228.93,-142.52 202.11,-116.23"/>
<polygon fill="black" stroke="black" points="305.14,-222.14 314.73,-226.64 310.04,-217.14 305.14,-222.14"/>
</g>
<!-- x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge8" class="edge">
<title>x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="black" d="M285.11,-222.63C262.31,-211.6 235.99,-198.87 215.72,-189.07"/>
<polygon fill="black" stroke="black" points="283.41,-225.7 293.94,-226.9 286.46,-219.39 283.41,-225.7"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge7" class="edge">
<title>test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M175.83,-140.19C175.61,-132.1 175.83,-123.61 176.49,-116.31"/>
<polygon fill="grey" stroke="grey" points="172.33,-140.26 176.39,-150.05 179.32,-139.86 172.33,-140.26"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Slices">Slices<a class="anchor-link" href="#Slices">&#182;</a></h4><p>The method <code>backward_slice(*critera, mode='cd')</code> returns a subset of dependencies, following dependencies backward from the given <em>slicing criteria</em> <code>criteria</code>. These criteria can be</p>
<ul>
<li>variable names (such as <code>&lt;test&gt;</code>); or</li>
<li><code>(function, lineno)</code> pairs (such as <code>(middle, 3)</code>); or</li>
<li><code>(var_name, (function, lineno))</code> (such as <code>(</code>x<code>, (middle, 1))</code>) locations.</li>
</ul>
<p>The extra parameter <code>mode</code> controls which dependencies are to be followed:</p>
<ul>
<li><strong><code>d</code></strong> = data dependencies</li>
<li><strong><code>c</code></strong> = control dependencies</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Criterion</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">expand_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criteria</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Criterion</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of vars matched by `criteria`.&quot;&quot;&quot;</span>
        <span class="n">all_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">criterion_var</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">criterion_func</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">criterion_lineno</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">criterion_var</span> <span class="o">=</span> <span class="n">criterion</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">criterion_func</span><span class="p">,</span> <span class="n">criterion_lineno</span> <span class="o">=</span> <span class="n">criterion</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">criterion_var</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">criterion_func</span><span class="p">,</span> <span class="n">criterion_lineno</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid argument&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_vars</span><span class="p">():</span>
                <span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span>
                <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>

                <span class="n">name_matches</span> <span class="o">=</span> <span class="p">(</span><span class="n">criterion_func</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                                <span class="n">criterion_func</span> <span class="o">==</span> <span class="n">func</span> <span class="ow">or</span>
                                <span class="n">criterion_func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

                <span class="n">location_matches</span> <span class="o">=</span> <span class="p">(</span><span class="n">criterion_lineno</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                                    <span class="n">criterion_lineno</span> <span class="o">==</span> <span class="n">lineno</span><span class="p">)</span>

                <span class="n">var_matches</span> <span class="o">=</span> <span class="p">(</span><span class="n">criterion_var</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                               <span class="n">criterion_var</span> <span class="o">==</span> <span class="n">var_name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">name_matches</span> <span class="ow">and</span> <span class="n">location_matches</span> <span class="ow">and</span> <span class="n">var_matches</span><span class="p">:</span>
                    <span class="n">all_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_vars</span>

    <span class="k">def</span> <span class="nf">backward_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">criteria</span><span class="p">:</span> <span class="n">Criterion</span><span class="p">,</span> 
                       <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dependencies</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a backward slice from nodes `criteria`.</span>
<span class="sd">        `mode` can contain &#39;c&#39; (draw control dependencies)</span>
<span class="sd">        and &#39;d&#39; (draw data dependencies) (default: &#39;cd&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">control</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_criteria</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">queue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">queue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">queue</span> <span class="o">=</span> <span class="n">queue</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
                <span class="c1"># Follow data dependencies</span>
                <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">next_var</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">next_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                        <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_var</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="k">if</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
                <span class="c1"># Follow control dependencies</span>
                <span class="n">control</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">next_var</span> <span class="ow">in</span> <span class="n">control</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">next_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                        <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_var</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">control</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">depth</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">Dependencies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">control</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Data-Dependencies">Data Dependencies<a class="anchor-link" href="#Data-Dependencies">&#182;</a></h3><p>Here is an example of a data dependency in our <code>middle()</code> program. The value <code>y</code> returned by <code>middle()</code> comes from the value <code>y</code> as originally passed as argument. We use arrows $x \leftarrow y$ to indicate that a variable $x$ depends on an earlier variable $y$:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="214pt" height="124pt"
 viewBox="0.00 0.00 213.75 124.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-120 209.75,-120 209.75,4 -4,4"/>
<!-- middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="node1" class="node">
<title>middlereturnvalue_functionmiddleat0x10700d120_6</title>
<g id="a_node1"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="205.75,-40 0,-40 0,0 205.75,0 205.75,-40"/>
<text text-anchor="start" x="8" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="81.88" y="-5.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1 -->
<g id="node2" class="node">
<title>y_functionmiddleat0x10700d120_1</title>
<g id="a_node2"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="205.38,-116 0.38,-116 0.38,-76 205.38,-76 205.38,-116"/>
<text text-anchor="start" x="98.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="8.38" y="-81.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge1" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="black" d="M96.85,-75.56C96.2,-68.25 95.99,-59.75 96.21,-51.67"/>
<polygon fill="black" stroke="black" points="99.7,-52.01 96.78,-41.82 92.71,-51.61 99.7,-52.01"/>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here, we can see that the value <code>y</code> in the return statement is data dependent on the value of <code>y</code> as passed to <code>middle()</code>. An alternate interpretation of this graph is a <em>data flow</em>: The value of <code>y</code> in the upper node <em>flows</em> into the value of <code>y</code> in the lower node.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Since we consider the values of variables at specific locations in the program, such data dependencies can also be interpreted as dependencies between <em>statements</em>  the above <code>return</code> statement thus is data dependent on the initialization of <code>y</code> in the upper node.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Control-Dependencies">Control Dependencies<a class="anchor-link" href="#Control-Dependencies">&#182;</a></h3><p>Here is an example of a control dependency. The execution of the above <code>return</code> statement is controlled by the earlier test <code>x &lt; z</code>. We use gray dashed lines to indicate control dependencies:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="214pt" height="124pt"
 viewBox="0.00 0.00 213.75 124.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-120 209.75,-120 209.75,4 -4,4"/>
<!-- middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="node1" class="node">
<title>middlereturnvalue_functionmiddleat0x10700d120_6</title>
<g id="a_node1"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="205.75,-40 0,-40 0,0 205.75,0 205.75,-40"/>
<text text-anchor="start" x="8" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="81.88" y="-5.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_5 -->
<g id="node2" class="node">
<title>test_functionmiddleat0x10700d120_5</title>
<g id="a_node2"><a xlink:title="middle:5">
<polygon fill="peachpuff" stroke="black" points="139.75,-116 66,-116 66,-76 139.75,-76 139.75,-116"/>
<text text-anchor="start" x="78.12" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="74" y="-81.45" font-family="Courier,monospace" font-size="9.00">elif x &lt; z:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge1" class="edge">
<title>test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M96.85,-75.56C96.2,-68.25 95.99,-59.75 96.21,-51.67"/>
<polygon fill="grey" stroke="grey" points="99.7,-52.01 96.78,-41.82 92.71,-51.61 99.7,-52.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This test in turn is controlled by earlier tests, so the full chain of control dependencies looks like this:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="214pt" height="276pt"
 viewBox="0.00 0.00 213.75 276.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 272)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-272 209.75,-272 209.75,4 -4,4"/>
<!-- middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="node1" class="node">
<title>middlereturnvalue_functionmiddleat0x10700d120_6</title>
<g id="a_node1"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="205.75,-40 0,-40 0,0 205.75,0 205.75,-40"/>
<text text-anchor="start" x="8" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="81.88" y="-5.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_5 -->
<g id="node2" class="node">
<title>test_functionmiddleat0x10700d120_5</title>
<g id="a_node2"><a xlink:title="middle:5">
<polygon fill="peachpuff" stroke="black" points="139.75,-116 66,-116 66,-76 139.75,-76 139.75,-116"/>
<text text-anchor="start" x="78.12" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="74" y="-81.45" font-family="Courier,monospace" font-size="9.00">elif x &lt; z:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge1" class="edge">
<title>test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M96.85,-75.56C96.2,-68.25 95.99,-59.75 96.21,-51.67"/>
<polygon fill="grey" stroke="grey" points="99.7,-52.01 96.78,-41.82 92.71,-51.61 99.7,-52.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<!-- test_functionmiddleat0x10700d120_3 -->
<g id="node3" class="node">
<title>test_functionmiddleat0x10700d120_3</title>
<g id="a_node3"><a xlink:title="middle:3">
<polygon fill="peachpuff" stroke="black" points="135.62,-192 70.12,-192 70.12,-152 135.62,-152 135.62,-192"/>
<text text-anchor="start" x="78.12" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="79.25" y="-157.45" font-family="Courier,monospace" font-size="9.00">if x &lt; y:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge3" class="edge">
<title>test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M96.85,-151.56C96.2,-144.25 95.99,-135.75 96.21,-127.67"/>
<polygon fill="grey" stroke="grey" points="99.7,-128.01 96.78,-117.82 92.71,-127.61 99.7,-128.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<!-- test_functionmiddleat0x10700d120_2 -->
<g id="node4" class="node">
<title>test_functionmiddleat0x10700d120_2</title>
<g id="a_node4"><a xlink:title="middle:2">
<polygon fill="peachpuff" stroke="black" points="135.62,-268 70.12,-268 70.12,-228 135.62,-228 135.62,-268"/>
<text text-anchor="start" x="78.12" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="79.25" y="-233.45" font-family="Courier,monospace" font-size="9.00">if y &lt; z:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge2" class="edge">
<title>test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M96.85,-227.56C96.2,-220.25 95.99,-211.75 96.21,-203.67"/>
<polygon fill="grey" stroke="grey" points="99.7,-204.01 96.78,-193.82 92.71,-203.61 99.7,-204.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Dependency-Graphs">Dependency Graphs<a class="anchor-link" href="#Dependency-Graphs">&#182;</a></h3><p>The above <code>&lt;test&gt;</code> values (and their statements) are in turn also dependent on earlier data, namely the <code>x</code>, <code>y</code>, and <code>z</code> values as originally passed. We can draw all data and control dependencies in a single graph, called a <em>program dependency graph</em>:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="463pt" height="352pt"
 viewBox="0.00 0.00 462.65 352.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-348 458.65,-348 458.65,4 -4,4"/>
<!-- test_functionmiddleat0x10700d120_2 -->
<g id="node1" class="node">
<title>test_functionmiddleat0x10700d120_2</title>
<g id="a_node1"><a xlink:title="middle:2">
<polygon fill="peachpuff" stroke="black" points="215.25,-268 149.75,-268 149.75,-228 215.25,-228 215.25,-268"/>
<text text-anchor="start" x="157.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="158.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">if y &lt; z:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_3 -->
<g id="node7" class="node">
<title>test_functionmiddleat0x10700d120_3</title>
<g id="a_node7"><a xlink:title="middle:3">
<polygon fill="peachpuff" stroke="black" points="215.25,-192 149.75,-192 149.75,-152 215.25,-152 215.25,-192"/>
<text text-anchor="start" x="157.75" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="158.88" y="-157.45" font-family="Courier,monospace" font-size="9.00">if x &lt; y:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge10" class="edge">
<title>test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M176.48,-227.56C175.82,-220.25 175.61,-211.75 175.84,-203.67"/>
<polygon fill="grey" stroke="grey" points="179.32,-204.01 176.4,-193.82 172.34,-203.61 179.32,-204.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_2&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<!-- z_functionmiddleat0x10700d120_1 -->
<g id="node2" class="node">
<title>z_functionmiddleat0x10700d120_1</title>
<g id="a_node2"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="428,-344 223,-344 223,-304 428,-304 428,-344"/>
<text text-anchor="start" x="321.38" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="231" y="-309.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<g id="edge1" class="edge">
<title>z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2</title>
<path fill="none" stroke="black" d="M281.91,-303.56C263.44,-294.42 242.06,-283.43 223.85,-273.71"/>
<polygon fill="black" stroke="black" points="225.61,-270.68 215.14,-269.03 222.29,-276.85 225.61,-270.68"/>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<!-- test_functionmiddleat0x10700d120_5 -->
<g id="node5" class="node">
<title>test_functionmiddleat0x10700d120_5</title>
<g id="a_node5"><a xlink:title="middle:5">
<polygon fill="peachpuff" stroke="black" points="219.38,-116 145.62,-116 145.62,-76 219.38,-76 219.38,-116"/>
<text text-anchor="start" x="157.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="153.62" y="-81.45" font-family="Courier,monospace" font-size="9.00">elif x &lt; z:</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge6" class="edge">
<title>z_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="black" d="M403.32,-303.64C420.73,-295.53 437.1,-284.1 447.5,-268 457.15,-253.07 456.88,-243.1 447.5,-228 400.08,-151.66 293.55,-118.47 230.96,-105.11"/>
<polygon fill="black" stroke="black" points="231.79,-101.71 221.29,-103.14 230.39,-108.56 231.79,-101.71"/>
</g>
<!-- y_functionmiddleat0x10700d120_1 -->
<g id="node3" class="node">
<title>y_functionmiddleat0x10700d120_1</title>
<g id="a_node3"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="205,-344 0,-344 0,-304 205,-304 205,-344"/>
<text text-anchor="start" x="98.38" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="8" y="-309.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2 -->
<g id="edge2" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_2</title>
<path fill="none" stroke="black" d="M123.52,-303.56C132.61,-295.14 143.41,-285.16 153.27,-276.04"/>
<polygon fill="black" stroke="black" points="155.55,-278.7 160.51,-269.34 150.79,-273.56 155.55,-278.7"/>
</g>
<!-- middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="node4" class="node">
<title>middlereturnvalue_functionmiddleat0x10700d120_6</title>
<g id="a_node4"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="285.38,-40 79.62,-40 79.62,0 285.38,0 285.38,-40"/>
<text text-anchor="start" x="87.62" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="161.5" y="-5.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge3" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="black" d="M101.63,-303.76C100.43,-260.86 101.55,-154.97 136.5,-76 140.83,-66.22 147.43,-56.81 154.3,-48.62"/>
<polygon fill="black" stroke="black" points="156.71,-51.18 160.75,-41.39 151.48,-46.52 156.71,-51.18"/>
</g>
<!-- y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge9" class="edge">
<title>y_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="black" d="M108.48,-303.74C114.99,-284.03 126.38,-252.87 140.5,-228 145.67,-218.89 152.19,-209.61 158.54,-201.32"/>
<polygon fill="black" stroke="black" points="161.16,-203.66 164.62,-193.65 155.67,-199.31 161.16,-203.66"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<g id="edge4" class="edge">
<title>test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M176.48,-75.56C175.82,-68.25 175.61,-59.75 175.84,-51.67"/>
<polygon fill="grey" stroke="grey" points="179.32,-52.01 176.4,-41.82 172.34,-51.61 179.32,-52.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_5&#45;&gt;middlereturnvalue_functionmiddleat0x10700d120_6 -->
<!-- x_functionmiddleat0x10700d120_1 -->
<g id="node6" class="node">
<title>x_functionmiddleat0x10700d120_1</title>
<g id="a_node6"><a xlink:title="middle:1">
<polygon fill="peachpuff" stroke="black" points="438,-268 233,-268 233,-228 438,-228 438,-268"/>
<text text-anchor="start" x="331.38" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="241" y="-233.45" font-family="Courier,monospace" font-size="9.00">def middle(x, y, z): &#160;# type: ignore</text>
</a>
</g>
</g>
<!-- x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge5" class="edge">
<title>x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="black" d="M315.81,-227.7C288.96,-201.37 240.71,-154.07 210.21,-124.17"/>
<polygon fill="black" stroke="black" points="212.79,-121.79 203.19,-117.29 207.88,-126.79 212.79,-121.79"/>
</g>
<!-- x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3 -->
<g id="edge8" class="edge">
<title>x_functionmiddleat0x10700d120_1&#45;&gt;test_functionmiddleat0x10700d120_3</title>
<path fill="none" stroke="black" d="M295.3,-227.56C274,-217.25 247.8,-204.58 226.02,-194.05"/>
<polygon fill="black" stroke="black" points="227.61,-190.93 217.08,-189.73 224.56,-197.23 227.61,-190.93"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
<g id="edge7" class="edge">
<title>test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M176.48,-151.56C175.82,-144.25 175.61,-135.75 175.84,-127.67"/>
<polygon fill="grey" stroke="grey" points="179.32,-128.01 176.4,-117.82 172.34,-127.61 179.32,-128.01"/>
</g>
<!-- test_functionmiddleat0x10700d120_3&#45;&gt;test_functionmiddleat0x10700d120_5 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This graph now gives us an idea on how to proceed to track the origins of the <code>middle()</code> return value at the bottom. Its value can come from any of the origins namely the initialization of <code>y</code> at the function call, or from the <code>&lt;test&gt;</code> that controls it. This test in turn depends on <code>x</code> and <code>z</code> and their associated statements, which we now can check one after the other.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note that all these dependencies in the graph are <em>dynamic</em> dependencies that is, they refer to statements actually evaluated in the run at hand, as well as the decisions made in that very run. There also are <em>static</em> dependency graphs coming from static analysis of the code; but for debugging, <em>dynamic</em> dependencies specific to the failing run are more useful.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Showing-Dependencies-with-Code">Showing Dependencies with Code<a class="anchor-link" href="#Showing-Dependencies-with-Code">&#182;</a></h3><p>While a graph gives us a representation about which possible data and control flows to track, integrating dependencies with actual program code results in a compact representation that is easy to reason about.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Listing-Dependencies">
<summary>Listing Dependencies</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To show dependencies as text, we introduce a method <code>format_var()</code> that shows a single node (a variable) as text. By default, a node is referenced as</p>
<div class="highlight"><pre><span></span><span class="n">NAME</span> <span class="p">(</span><span class="n">FUNCTION</span><span class="p">:</span><span class="n">LINENO</span><span class="p">)</span>
</pre></div>
<p>However, within a given function, it makes no sense to re-state the function name again and again, so we have a shorthand</p>
<div class="highlight"><pre><span></span><span class="n">NAME</span> <span class="p">(</span><span class="n">LINENO</span><span class="p">)</span>
</pre></div>
<p>to state a dependency to variable <code>NAME</code> in line <code>LINENO</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">format_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">current_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string for `var` in `current_func`.&quot;&quot;&quot;</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">location</span> <span class="o">=</span> <span class="n">var</span>
        <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>
        <span class="k">if</span> <span class="n">current_func</span> <span class="ow">and</span> <span class="p">(</span><span class="n">func</span> <span class="o">==</span> <span class="n">current_func</span> <span class="ow">or</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">current_func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">)&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>format_var()</code> is used extensively in the <code>__str__()</code> string representation of dependencies, listing all nodes and their data (<code>&lt;=</code>) and control (<code>&lt;-</code>) dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string representation of dependencies&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">():</span>
            <span class="n">code_name</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>

            <span class="k">if</span> <span class="n">out</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">code_name</span><span class="si">}</span><span class="s2">():</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="n">all_vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">all_vars</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">var</span><span class="p">:</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="p">:</span>
                <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span>
                <span class="n">var_func</span><span class="p">,</span> <span class="n">var_lineno</span> <span class="o">=</span> <span class="n">location</span>
                <span class="n">var_code_name</span> <span class="o">=</span> <span class="n">var_func</span><span class="o">.</span><span class="vm">__name__</span>

                <span class="k">if</span> <span class="n">var_code_name</span> <span class="o">!=</span> <span class="n">code_name</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">all_deps</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">arrow</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="s2">&quot;&lt;-&quot;</span><span class="p">)]:</span>
                    <span class="n">deps</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">data_dep</span> <span class="ow">in</span> <span class="n">source</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">deps</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">deps</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">arrow</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">deps</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span>
                        <span class="n">deps</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_var</span><span class="p">(</span><span class="n">data_dep</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">deps</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">all_deps</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">all_deps</span> <span class="o">+=</span> <span class="s2">&quot;;&quot;</span>
                        <span class="n">all_deps</span> <span class="o">+=</span> <span class="n">deps</span>

                <span class="k">if</span> <span class="n">all_deps</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">out</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">+</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">format_var</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">all_deps</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is a compact string representation of dependencies. We see how the (last) <code>middle() return value</code> has a data dependency to <code>y</code> in Line 1, and to the <code>&lt;test&gt;</code> in Line 5.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">middle_deps</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle():
    &lt;test&gt; (2) &lt;= z (1), y (1)
    &lt;test&gt; (3) &lt;= x (1), y (1); &lt;- &lt;test&gt; (2)
    &lt;test&gt; (5) &lt;= x (1), z (1); &lt;- &lt;test&gt; (3)
    &lt;middle() return value&gt; (6) &lt;= y (1); &lt;- &lt;test&gt; (5)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>__repr__()</code> method shows a raw form of dependencies, useful for creating dependencies from scratch.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">repr_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">location</span> <span class="o">=</span> <span class="n">var</span>
        <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">, (</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">))&quot;</span>

    <span class="k">def</span> <span class="nf">repr_deps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_set</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_set</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;set()&quot;</span>

        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_var</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                          <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">var_set</span><span class="p">)</span> <span class="o">+</span>
                <span class="s2">&quot;}&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">repr_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">vars</span><span class="p">:</span> <span class="n">Dependency</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;{</span><span class="se">\n</span><span class="s2">        &quot;</span> <span class="o">+</span>
                <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">        &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_var</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_deps</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="n">var</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">)</span> <span class="o">+</span>
                <span class="s2">&quot;}&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Represent dependencies as a Python expression&quot;&quot;&quot;</span>
        <span class="c1"># Useful for saving and restoring values</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dependencies(</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="sa">f</span><span class="s2">&quot;    data=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="sa">f</span><span class="s2">&quot; control=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">middle_deps</span><span class="p">()))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dependencies(
    data={
        (&#39;z&#39;, (middle, 1)): set(),
        (&#39;y&#39;, (middle, 1)): set(),
        (&#39;x&#39;, (middle, 1)): set(),
        (&#39;&lt;test&gt;&#39;, (middle, 2)): {(&#39;z&#39;, (middle, 1)), (&#39;y&#39;, (middle, 1))},
        (&#39;&lt;test&gt;&#39;, (middle, 3)): {(&#39;x&#39;, (middle, 1)), (&#39;y&#39;, (middle, 1))},
        (&#39;&lt;test&gt;&#39;, (middle, 5)): {(&#39;x&#39;, (middle, 1)), (&#39;z&#39;, (middle, 1))},
        (&#39;&lt;middle() return value&gt;&#39;, (middle, 6)): {(&#39;y&#39;, (middle, 1))}},
 control={
        (&#39;z&#39;, (middle, 1)): set(),
        (&#39;y&#39;, (middle, 1)): set(),
        (&#39;x&#39;, (middle, 1)): set(),
        (&#39;&lt;test&gt;&#39;, (middle, 2)): set(),
        (&#39;&lt;test&gt;&#39;, (middle, 3)): {(&#39;&lt;test&gt;&#39;, (middle, 2))},
        (&#39;&lt;test&gt;&#39;, (middle, 5)): {(&#39;&lt;test&gt;&#39;, (middle, 3))},
        (&#39;&lt;middle() return value&gt;&#39;, (middle, 6)): {(&#39;&lt;test&gt;&#39;, (middle, 5))}})
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>An even more useful representation comes when integrating these dependencies as comments into the code. The method <code>code(item_1, item_2, ...)</code> lists the given (function) items, including their dependencies; <code>code()</code> lists <em>all</em> functions contained in the dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Dependencies</span><span class="p">(</span><span class="n">Dependencies</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cd&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List `items` on standard output, including dependencies as comments. </span>
<span class="sd">        If `items` is empty, all included functions are listed.</span>
<span class="sd">        `mode` can contain &#39;c&#39; (draw control dependencies) and &#39;d&#39; (draw data dependencies)</span>
<span class="sd">        (default: &#39;cd&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_code</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># The functions in dependencies may be (instrumented) copies</span>
        <span class="c1"># of the original function. Find the function with the same name.</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">fn</span> <span class="o">==</span> <span class="n">item</span> <span class="ow">or</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">item</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">fn</span>
                <span class="k">break</span>

        <span class="n">all_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_vars</span><span class="p">()</span>
        <span class="n">slice_locations</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">location</span> <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="p">)</span>

        <span class="n">source_lines</span><span class="p">,</span> <span class="n">first_lineno</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">first_lineno</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">source_lines</span><span class="p">:</span>
            <span class="n">line_location</span> <span class="o">=</span> <span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line_location</span> <span class="ow">in</span> <span class="n">slice_locations</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;* &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">n</span><span class="si">:</span><span class="s2">4</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">mode_control</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">arrow</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="s1">&#39;&lt;-&#39;</span><span class="p">)</span>
            <span class="p">]:</span>
                <span class="k">if</span> <span class="n">mode_control</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">deps</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">location</span> <span class="o">=</span> <span class="n">var</span>
                    <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="n">line_location</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">dep_var</span> <span class="ow">in</span> <span class="n">source</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">deps</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                                <span class="n">deps</span> <span class="o">=</span> <span class="n">arrow</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">deps</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span>
                            <span class="n">deps</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_var</span><span class="p">(</span><span class="n">dep_var</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">deps</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">comment</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;; &quot;</span>
                    <span class="n">comment</span> <span class="o">+=</span> <span class="n">deps</span>

            <span class="k">if</span> <span class="n">comment</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;  # &quot;</span> <span class="o">+</span> <span class="n">comment</span>

            <span class="n">print_content</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

</div>
</div></div>
</div>
</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The following listing shows such an integration. For each executed line (<code>*</code>), we see its data (<code>&lt;=</code>) and control (<code>&lt;-</code>) dependencies, listing the associated variables and line numbers. The comment</p>
<div class="highlight"><pre><span></span><span class="c1"># &lt;= y (1); &lt;- &lt;test&gt; (5)</span>
</pre></div>
<p>for Line 6, for instance, states that the return value is data dependent on the value of <code>y</code> in Line 1, and control dependent on the test in Line 5.</p>
<p>Again, one can easily follow these dependencies back to track where a value came from (data dependencies) and why a statement was executed (control dependency).</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>*    1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):  <span class="ansi-white-fg"># type: ignore</span>
*    2     <span class="ansi-blue-fg">if</span> y &lt; z:  <span class="ansi-white-fg"># &lt;= z (1), y (1)</span>
*    3         <span class="ansi-blue-fg">if</span> x &lt; y:  <span class="ansi-white-fg"># &lt;= x (1), y (1); &lt;- &lt;test&gt; (2)</span>
     4             <span class="ansi-blue-fg">return</span> y
*    5         <span class="ansi-blue-fg">elif</span> x &lt; z:  <span class="ansi-white-fg"># &lt;= x (1), z (1); &lt;- &lt;test&gt; (3)</span>
*    6             <span class="ansi-blue-fg">return</span> y  <span class="ansi-white-fg"># &lt;= y (1); &lt;- &lt;test&gt; (5)</span>
     7     <span class="ansi-blue-fg">else</span>:
     8         <span class="ansi-blue-fg">if</span> x &gt; y:
     9             <span class="ansi-blue-fg">return</span> y
    10         <span class="ansi-blue-fg">elif</span> x &gt; z:
    11             <span class="ansi-blue-fg">return</span> x
    12     <span class="ansi-blue-fg">return</span> z
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One important aspect of dependencies is that they not only point to specific sources and causes of failures  but that they also <em>rule out</em> parts of program and state as failures.</p>
<ul>
<li>In the above code, Lines 8 and later have no influence on the output, simply because they were not executed.</li>
<li>Furthermore, we see that we can start our investigation with Line 6, because that is the last one executed.</li>
<li>The data dependencies tell us that no statement has interfered with the value of <code>y</code> between the function call and its return.</li>
<li>Hence, the error must be in the conditions or the final <code>return</code> statement.</li>
</ul>
<p>With this in mind, recall that our original invocation was <code>middle(2, 1, 3)</code>. Why and how is the above code wrong?</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Which of the following <code>middle()</code> code lines should be fixed?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="4b33e096-cce7-11ef-87e4-6298cf1a578f" id="4b33e096-cce7-11ef-87e4-6298cf1a578f-1" onclick="clear_selection('4b33e096-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4b33e096-cce7-11ef-87e4-6298cf1a578f-1-label" for="4b33e096-cce7-11ef-87e4-6298cf1a578f-1">Line 2: <code>if y &lt; z:</code></label><br>

        <input type="radio" name="4b33e096-cce7-11ef-87e4-6298cf1a578f" id="4b33e096-cce7-11ef-87e4-6298cf1a578f-2" onclick="clear_selection('4b33e096-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4b33e096-cce7-11ef-87e4-6298cf1a578f-2-label" for="4b33e096-cce7-11ef-87e4-6298cf1a578f-2">Line 3: <code>if x &lt; y:</code></label><br>

        <input type="radio" name="4b33e096-cce7-11ef-87e4-6298cf1a578f" id="4b33e096-cce7-11ef-87e4-6298cf1a578f-3" onclick="clear_selection('4b33e096-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4b33e096-cce7-11ef-87e4-6298cf1a578f-3-label" for="4b33e096-cce7-11ef-87e4-6298cf1a578f-3">Line 5: <code>elif x &lt; z:</code></label><br>

        <input type="radio" name="4b33e096-cce7-11ef-87e4-6298cf1a578f" id="4b33e096-cce7-11ef-87e4-6298cf1a578f-4" onclick="clear_selection('4b33e096-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4b33e096-cce7-11ef-87e4-6298cf1a578f-4-label" for="4b33e096-cce7-11ef-87e4-6298cf1a578f-4">Line 6: <code>return z</code></label><br>

    </div>
    </p>
    <input id="4b33e096-cce7-11ef-87e4-6298cf1a578f-submit" type="submit" value="Submit" onclick="check_selection('4b33e096-cce7-11ef-87e4-6298cf1a578f', 16, 0, '(1 ** 0 + 1 ** 1) ** (1 ** 2 + 1 ** 3)')">
    <span class="quiz_hint" id="4b33e096-cce7-11ef-87e4-6298cf1a578f-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Indeed, from the controlling conditions, we see that <code>y &lt; z</code>, <code>x &gt;= y</code>, and <code>x &lt; z</code> all hold. Hence, <code>y &lt;= x &lt; z</code> holds, and it is <code>x</code>, not <code>y</code>, that should be returned.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Slices">Slices<a class="anchor-link" href="#Slices">&#182;</a></h2><p>Given a dependency graph for a particular variable, we can identify the subset of the program that could have influenced it  the so-called <em>slice</em>. In the above code listing, these code locations are highlighted with <code>*</code> characters. Only these locations are part of the slice.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Slices are central to debugging for two reasons:</p>
<ul>
<li>First, they <em>rule out</em> those locations of the program that could <em>not</em> have an effect on the failure. Hence, these locations need not be investigated as it comes to searching for the defect. Nor do they need to be considered for a fix, as any change outside the program slice by construction cannot affect the failure.</li>
<li>Second, they bring together possible origins that may be scattered across the code. Many dependencies in program code are <em>non-local</em>, with references to functions, classes, and modules defined in other locations, files, or libraries. A slice brings together all those locations in a single whole.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is an example of a slice this time for our well-known <code>remove_html_markup()</code> function from <a href="Intro_Debugging.html">the introduction to debugging</a>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Intro_Debugging.html" class="import" target="_blank">Intro_Debugging</a></span> <span class="kn">import</span> <span class="n">remove_html_markup</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">assert</span> tag <span class="ansi-magenta-fg">or</span> <span class="ansi-magenta-fg">not</span> quote

        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> (c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span>) <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When we invoke <code>remove_html_markup()</code> as follows...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&lt;foo&gt;bar&lt;/foo&gt;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;bar&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... we obtain the following dependencies:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="395pt" height="960pt"
 viewBox="0.00 0.00 394.79 960.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 956)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-956 390.79,-956 390.79,4 -4,4"/>
<!-- tag_functionremove_html_markupat0x10700ede0_145 -->
<g id="node1" class="node">
<title>tag_functionremove_html_markupat0x10700ede0_145</title>
<g id="a_node1"><a xlink:title="remove_html_markup:145">
<polygon fill="peachpuff" stroke="black" points="254.79,-496 123.29,-496 123.29,-456 254.79,-456 254.79,-496"/>
<text text-anchor="start" x="176.66" y="-479.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="131.29" y="-461.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_146 -->
<g id="node5" class="node">
<title>test_functionremove_html_markupat0x10700ede0_146</title>
<g id="a_node5"><a xlink:title="remove_html_markup:146">
<polygon fill="peachpuff" stroke="black" points="160.79,-420 29.29,-420 29.29,-380 160.79,-380 160.79,-420"/>
<text text-anchor="start" x="70.29" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="37.29" y="-385.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- tag_functionremove_html_markupat0x10700ede0_145&#45;&gt;test_functionremove_html_markupat0x10700ede0_146 -->
<!-- test_functionremove_html_markupat0x10700ede0_150 -->
<g id="node6" class="node">
<title>test_functionremove_html_markupat0x10700ede0_150</title>
<g id="a_node6"><a xlink:title="remove_html_markup:150">
<polygon fill="peachpuff" stroke="black" points="254.79,-192 123.29,-192 123.29,-152 254.79,-152 254.79,-192"/>
<text text-anchor="start" x="164.29" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="131.29" y="-157.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- tag_functionremove_html_markupat0x10700ede0_145&#45;&gt;test_functionremove_html_markupat0x10700ede0_150 -->
<g id="edge4" class="edge">
<title>tag_functionremove_html_markupat0x10700ede0_145&#45;&gt;test_functionremove_html_markupat0x10700ede0_150</title>
<path fill="none" stroke="black" d="M204.53,-455.55C236.67,-412.68 304.35,-307.55 264.04,-228 258.17,-216.41 248.58,-206.68 238.19,-198.78"/>
<polygon fill="black" stroke="black" points="240.38,-196.03 230.17,-193.17 236.36,-201.77 240.38,-196.03"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_144 -->
<g id="node2" class="node">
<title>test_functionremove_html_markupat0x10700ede0_144</title>
<g id="a_node2"><a xlink:title="remove_html_markup:144">
<polygon fill="peachpuff" stroke="black" points="254.79,-572 123.29,-572 123.29,-532 254.79,-532 254.79,-572"/>
<text text-anchor="start" x="164.29" y="-555.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="131.29" y="-537.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_144&#45;&gt;tag_functionremove_html_markupat0x10700ede0_145 -->
<g id="edge1" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_144&#45;&gt;tag_functionremove_html_markupat0x10700ede0_145</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M183.02,-531.56C182.36,-524.25 182.15,-515.75 182.38,-507.67"/>
<polygon fill="grey" stroke="grey" points="185.86,-508.01 182.94,-497.82 178.87,-507.61 185.86,-508.01"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_144&#45;&gt;tag_functionremove_html_markupat0x10700ede0_145 -->
<!-- test_functionremove_html_markupat0x10700ede0_144&#45;&gt;test_functionremove_html_markupat0x10700ede0_146 -->
<g id="edge19" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_144&#45;&gt;test_functionremove_html_markupat0x10700ede0_146</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M151.83,-531.6C137.95,-522.57 123.33,-510.57 114.04,-496 101.83,-476.86 97.21,-451.49 95.58,-431.78"/>
<polygon fill="grey" stroke="grey" points="99.07,-431.64 94.99,-421.86 92.09,-432.05 99.07,-431.64"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_148 -->
<g id="node3" class="node">
<title>test_functionremove_html_markupat0x10700ede0_148</title>
<g id="a_node3"><a xlink:title="remove_html_markup:148">
<polygon fill="peachpuff" stroke="black" points="254.79,-268 123.29,-268 123.29,-228 254.79,-228 254.79,-268"/>
<text text-anchor="start" x="164.29" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="131.29" y="-233.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_148&#45;&gt;test_functionremove_html_markupat0x10700ede0_150 -->
<g id="edge6" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_148&#45;&gt;test_functionremove_html_markupat0x10700ede0_150</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M183.02,-227.56C182.36,-220.25 182.15,-211.75 182.38,-203.67"/>
<polygon fill="grey" stroke="grey" points="185.86,-204.01 182.94,-193.82 178.87,-203.61 185.86,-204.01"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_148&#45;&gt;test_functionremove_html_markupat0x10700ede0_150 -->
<!-- c_functionremove_html_markupat0x10700ede0_141 -->
<g id="node4" class="node">
<title>c_functionremove_html_markupat0x10700ede0_141</title>
<g id="a_node4"><a xlink:title="remove_html_markup:141">
<polygon fill="peachpuff" stroke="black" points="292.79,-648 161.29,-648 161.29,-608 292.79,-608 292.79,-648"/>
<text text-anchor="start" x="222.91" y="-631.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">c</text>
<text text-anchor="start" x="169.29" y="-613.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_144 -->
<g id="edge16" class="edge">
<title>c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_144</title>
<path fill="none" stroke="black" d="M211.03,-607.56C206.42,-599.91 201.62,-590.96 197.58,-582.55"/>
<polygon fill="black" stroke="black" points="200.89,-581.35 193.57,-573.69 194.51,-584.24 200.89,-581.35"/>
</g>
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_144 -->
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_148 -->
<g id="edge2" class="edge">
<title>c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_148</title>
<path fill="none" stroke="black" d="M244.25,-607.61C251.91,-597.69 260.08,-584.99 264.04,-572 279.08,-522.69 272.95,-506.78 264.04,-456 252.5,-390.27 221.82,-317.92 203.47,-278.55"/>
<polygon fill="black" stroke="black" points="206.73,-277.26 199.29,-269.72 200.4,-280.26 206.73,-277.26"/>
</g>
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_146 -->
<g id="edge18" class="edge">
<title>c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_146</title>
<path fill="none" stroke="black" d="M163.19,-607.53C145.03,-599.2 126.75,-587.68 114.04,-572 81.78,-532.22 84.21,-469.03 89.33,-431.62"/>
<polygon fill="black" stroke="black" points="92.76,-432.36 90.82,-421.94 85.84,-431.3 92.76,-432.36"/>
</g>
<!-- out_functionremove_html_markupat0x10700ede0_151 -->
<g id="node8" class="node">
<title>out_functionremove_html_markupat0x10700ede0_151</title>
<g id="a_node8"><a xlink:title="remove_html_markup:151">
<polygon fill="peachpuff" stroke="black" points="254.79,-116 123.29,-116 123.29,-76 254.79,-76 254.79,-116"/>
<text text-anchor="start" x="176.66" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">out</text>
<text text-anchor="start" x="131.29" y="-81.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;out_functionremove_html_markupat0x10700ede0_151 -->
<g id="edge8" class="edge">
<title>c_functionremove_html_markupat0x10700ede0_141&#45;&gt;out_functionremove_html_markupat0x10700ede0_151</title>
<path fill="none" stroke="black" d="M250.33,-607.59C261.04,-597.77 273.28,-585.15 282.04,-572 307.34,-534.01 321.04,-522.64 321.04,-477 321.04,-477 321.04,-477 321.04,-247 321.04,-192.64 271.57,-148.62 233.2,-122.65"/>
<polygon fill="black" stroke="black" points="235.27,-119.82 224.99,-117.27 231.43,-125.68 235.27,-119.82"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_146&#45;&gt;test_functionremove_html_markupat0x10700ede0_148 -->
<g id="edge3" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_146&#45;&gt;test_functionremove_html_markupat0x10700ede0_148</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M132.24,-379.6C146.12,-370.57 160.75,-358.57 170.04,-344 182.25,-324.86 186.86,-299.49 188.5,-279.78"/>
<polygon fill="grey" stroke="grey" points="191.99,-280.05 189.09,-269.86 185,-279.64 191.99,-280.05"/>
</g>
<!-- tag_functionremove_html_markupat0x10700ede0_147 -->
<g id="node7" class="node">
<title>tag_functionremove_html_markupat0x10700ede0_147</title>
<g id="a_node7"><a xlink:title="remove_html_markup:147">
<polygon fill="peachpuff" stroke="black" points="160.79,-344 29.29,-344 29.29,-304 160.79,-304 160.79,-344"/>
<text text-anchor="start" x="82.66" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="37.29" y="-309.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_146&#45;&gt;tag_functionremove_html_markupat0x10700ede0_147 -->
<g id="edge7" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_146&#45;&gt;tag_functionremove_html_markupat0x10700ede0_147</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M89.02,-379.56C88.36,-372.25 88.15,-363.75 88.38,-355.67"/>
<polygon fill="grey" stroke="grey" points="91.86,-356.01 88.94,-345.82 84.87,-355.61 91.86,-356.01"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_146&#45;&gt;tag_functionremove_html_markupat0x10700ede0_147 -->
<!-- remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153 -->
<g id="node13" class="node">
<title>remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153</title>
<g id="a_node13"><a xlink:title="remove_html_markup:153">
<polygon fill="peachpuff" stroke="black" points="341.41,-40 36.66,-40 36.66,0 341.41,0 341.41,-40"/>
<text text-anchor="start" x="44.66" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;remove_html_markup() return value&gt;</text>
<text text-anchor="start" x="131.29" y="-5.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_146&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153 -->
<g id="edge14" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_146&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153</title>
<path fill="none" stroke="black" d="M57.83,-379.6C43.95,-370.57 29.33,-358.57 20.04,-344 -3.11,-307.7 1.04,-292.06 1.04,-249 1.04,-249 1.04,-249 1.04,-171 1.04,-108.56 65.18,-67.89 118.53,-44.86"/>
<polygon fill="black" stroke="black" points="119.75,-48.14 127.64,-41.07 117.06,-41.68 119.75,-48.14"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_150&#45;&gt;out_functionremove_html_markupat0x10700ede0_151 -->
<g id="edge11" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_150&#45;&gt;out_functionremove_html_markupat0x10700ede0_151</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M183.02,-151.56C182.36,-144.25 182.15,-135.75 182.38,-127.67"/>
<polygon fill="grey" stroke="grey" points="185.86,-128.01 182.94,-117.82 178.87,-127.61 185.86,-128.01"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_150&#45;&gt;out_functionremove_html_markupat0x10700ede0_151 -->
<!-- tag_functionremove_html_markupat0x10700ede0_147&#45;&gt;test_functionremove_html_markupat0x10700ede0_148 -->
<!-- tag_functionremove_html_markupat0x10700ede0_147&#45;&gt;test_functionremove_html_markupat0x10700ede0_150 -->
<g id="edge5" class="edge">
<title>tag_functionremove_html_markupat0x10700ede0_147&#45;&gt;test_functionremove_html_markupat0x10700ede0_150</title>
<path fill="none" stroke="black" d="M94.9,-303.65C95.62,-283.31 99.3,-251.12 114.04,-228 121.3,-216.62 131.81,-206.81 142.68,-198.75"/>
<polygon fill="black" stroke="black" points="144.37,-201.84 150.59,-193.27 140.38,-196.09 144.37,-201.84"/>
</g>
<!-- out_functionremove_html_markupat0x10700ede0_151&#45;&gt;out_functionremove_html_markupat0x10700ede0_151 -->
<g id="edge10" class="edge">
<title>out_functionremove_html_markupat0x10700ede0_151&#45;&gt;out_functionremove_html_markupat0x10700ede0_151</title>
<path fill="none" stroke="black" d="M255.04,-109.12C265.58,-107.2 272.79,-102.83 272.79,-96 272.79,-91.95 270.25,-88.76 265.98,-86.43"/>
<polygon fill="black" stroke="black" points="267.07,-83.11 256.48,-83.35 264.91,-89.77 267.07,-83.11"/>
</g>
<!-- out_functionremove_html_markupat0x10700ede0_151&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153 -->
<g id="edge13" class="edge">
<title>out_functionremove_html_markupat0x10700ede0_151&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153</title>
<path fill="none" stroke="black" d="M183.02,-75.56C182.36,-68.25 182.15,-59.75 182.38,-51.67"/>
<polygon fill="black" stroke="black" points="185.86,-52.01 182.94,-41.82 178.87,-51.61 185.86,-52.01"/>
</g>
<!-- out_functionremove_html_markupat0x10700ede0_151&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x10700ede0_153 -->
<!-- out_functionremove_html_markupat0x10700ede0_139 -->
<g id="node9" class="node">
<title>out_functionremove_html_markupat0x10700ede0_139</title>
<g id="a_node9"><a xlink:title="remove_html_markup:139">
<polygon fill="peachpuff" stroke="black" points="386.79,-724 255.29,-724 255.29,-684 386.79,-684 386.79,-724"/>
<text text-anchor="start" x="308.66" y="-707.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">out</text>
<text text-anchor="start" x="263.29" y="-689.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- out_functionremove_html_markupat0x10700ede0_139&#45;&gt;c_functionremove_html_markupat0x10700ede0_141 -->
<!-- out_functionremove_html_markupat0x10700ede0_139&#45;&gt;out_functionremove_html_markupat0x10700ede0_151 -->
<g id="edge9" class="edge">
<title>out_functionremove_html_markupat0x10700ede0_139&#45;&gt;out_functionremove_html_markupat0x10700ede0_151</title>
<path fill="none" stroke="black" d="M329.28,-683.5C340.46,-655.26 359.04,-601.09 359.04,-553 359.04,-553 359.04,-553 359.04,-247 359.04,-186.92 298.6,-145.16 249.8,-121.23"/>
<polygon fill="black" stroke="black" points="251.49,-118.16 240.95,-117.04 248.49,-124.48 251.49,-118.16"/>
</g>
<!-- s_functionremove_html_markupat0x10700ede0_136 -->
<g id="node10" class="node">
<title>s_functionremove_html_markupat0x10700ede0_136</title>
<g id="a_node10"><a xlink:title="remove_html_markup:136">
<polygon fill="peachpuff" stroke="black" points="245.79,-952 114.29,-952 114.29,-912 245.79,-912 245.79,-952"/>
<text text-anchor="start" x="175.91" y="-935.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">s</text>
<text text-anchor="start" x="122.29" y="-917.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- s_functionremove_html_markupat0x10700ede0_136&#45;&gt;c_functionremove_html_markupat0x10700ede0_141 -->
<g id="edge12" class="edge">
<title>s_functionremove_html_markupat0x10700ede0_136&#45;&gt;c_functionremove_html_markupat0x10700ede0_141</title>
<path fill="none" stroke="black" d="M192.26,-911.66C198.09,-901.45 204.53,-888.48 208.04,-876 229.28,-800.39 229.88,-706.97 228.49,-659.62"/>
<polygon fill="black" stroke="black" points="231.99,-659.73 228.14,-649.86 225,-659.98 231.99,-659.73"/>
</g>
<!-- tag_functionremove_html_markupat0x10700ede0_137 -->
<g id="node11" class="node">
<title>tag_functionremove_html_markupat0x10700ede0_137</title>
<g id="a_node11"><a xlink:title="remove_html_markup:137">
<polygon fill="peachpuff" stroke="black" points="198.79,-876 67.29,-876 67.29,-836 198.79,-836 198.79,-876"/>
<text text-anchor="start" x="120.66" y="-859.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="75.29" y="-841.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- s_functionremove_html_markupat0x10700ede0_136&#45;&gt;tag_functionremove_html_markupat0x10700ede0_137 -->
<!-- quote_functionremove_html_markupat0x10700ede0_138 -->
<g id="node12" class="node">
<title>quote_functionremove_html_markupat0x10700ede0_138</title>
<g id="a_node12"><a xlink:title="remove_html_markup:138">
<polygon fill="peachpuff" stroke="black" points="198.79,-800 67.29,-800 67.29,-760 198.79,-760 198.79,-800"/>
<text text-anchor="start" x="112.41" y="-783.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">quote</text>
<text text-anchor="start" x="75.29" y="-765.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- tag_functionremove_html_markupat0x10700ede0_137&#45;&gt;quote_functionremove_html_markupat0x10700ede0_138 -->
<!-- quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;test_functionremove_html_markupat0x10700ede0_144 -->
<g id="edge15" class="edge">
<title>quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;test_functionremove_html_markupat0x10700ede0_144</title>
<path fill="none" stroke="black" d="M132.24,-759.6C131.54,-727.15 132.86,-660.3 152.04,-608 155.39,-598.86 160.57,-589.75 166,-581.66"/>
<polygon fill="black" stroke="black" points="168.8,-583.75 171.76,-573.58 163.1,-579.69 168.8,-583.75"/>
</g>
<!-- quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;test_functionremove_html_markupat0x10700ede0_146 -->
<g id="edge17" class="edge">
<title>quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;test_functionremove_html_markupat0x10700ede0_146</title>
<path fill="none" stroke="black" d="M104.57,-759.54C70.8,-733.91 19.04,-685.42 19.04,-629 19.04,-629 19.04,-629 19.04,-551 19.04,-504.37 48.62,-457.54 70.87,-428.91"/>
<polygon fill="black" stroke="black" points="73.32,-431.45 76.85,-421.46 67.86,-427.07 73.32,-431.45"/>
</g>
<!-- quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;out_functionremove_html_markupat0x10700ede0_139 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, we can read such a graph <em>forward</em> (starting from, say, <code>s</code>) or <em>backward</em> (starting from the return value). Starting forward, we see how the passed string <code>s</code> flows into the <code>for</code> loop, breaking <code>s</code> into individual characters <code>c</code> that are then checked on various occasions, before flowing into the <code>out</code> return value. We also see how the various <code>if</code> conditions are all influenced by <code>c</code>, <code>tag</code>, and <code>quote</code>.</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Why does the first line <code>tag = False</code> not influence anything?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="4bb9b824-cce7-11ef-87e4-6298cf1a578f" id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-1" onclick="clear_selection('4bb9b824-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-1-label" for="4bb9b824-cce7-11ef-87e4-6298cf1a578f-1">Because the input contains only tags</label><br>

        <input type="radio" name="4bb9b824-cce7-11ef-87e4-6298cf1a578f" id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-2" onclick="clear_selection('4bb9b824-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-2-label" for="4bb9b824-cce7-11ef-87e4-6298cf1a578f-2">Because <code>tag</code> is set to True with the first character</label><br>

        <input type="radio" name="4bb9b824-cce7-11ef-87e4-6298cf1a578f" id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-3" onclick="clear_selection('4bb9b824-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-3-label" for="4bb9b824-cce7-11ef-87e4-6298cf1a578f-3">Because <code>tag</code> is not read by any variable</label><br>

        <input type="radio" name="4bb9b824-cce7-11ef-87e4-6298cf1a578f" id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-4" onclick="clear_selection('4bb9b824-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-4-label" for="4bb9b824-cce7-11ef-87e4-6298cf1a578f-4">Because the input contains no tags</label><br>

    </div>
    </p>
    <input id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-submit" type="submit" value="Submit" onclick="check_selection('4bb9b824-cce7-11ef-87e4-6298cf1a578f', 4, 0, '(1 &lt;&lt; 1 + 1 &gt;&gt; 1)')">
    <span class="quiz_hint" id="4bb9b824-cce7-11ef-87e4-6298cf1a578f-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Which are the locations that set <code>tag</code> to True? To this end, we compute the slice of <code>tag</code> at <code>tag = True</code>:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="234pt" height="352pt"
 viewBox="0.00 0.00 233.50 352.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-348 229.5,-348 229.5,4 -4,4"/>
<!-- tag_functionremove_html_markupat0x10700ede0_145 -->
<g id="node1" class="node">
<title>tag_functionremove_html_markupat0x10700ede0_145</title>
<g id="a_node1"><a xlink:title="remove_html_markup:145">
<polygon fill="peachpuff" stroke="black" points="131.5,-40 0,-40 0,0 131.5,0 131.5,-40"/>
<text text-anchor="start" x="53.38" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="8" y="-5.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_144 -->
<g id="node2" class="node">
<title>test_functionremove_html_markupat0x10700ede0_144</title>
<g id="a_node2"><a xlink:title="remove_html_markup:144">
<polygon fill="peachpuff" stroke="black" points="131.5,-116 0,-116 0,-76 131.5,-76 131.5,-116"/>
<text text-anchor="start" x="41" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="8" y="-81.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_144&#45;&gt;tag_functionremove_html_markupat0x10700ede0_145 -->
<g id="edge1" class="edge">
<title>test_functionremove_html_markupat0x10700ede0_144&#45;&gt;tag_functionremove_html_markupat0x10700ede0_145</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M59.73,-75.56C59.07,-68.25 58.86,-59.75 59.09,-51.67"/>
<polygon fill="grey" stroke="grey" points="62.57,-52.01 59.65,-41.82 55.59,-51.61 62.57,-52.01"/>
</g>
<!-- test_functionremove_html_markupat0x10700ede0_144&#45;&gt;tag_functionremove_html_markupat0x10700ede0_145 -->
<!-- c_functionremove_html_markupat0x10700ede0_141 -->
<g id="node3" class="node">
<title>c_functionremove_html_markupat0x10700ede0_141</title>
<g id="a_node3"><a xlink:title="remove_html_markup:141">
<polygon fill="peachpuff" stroke="black" points="131.5,-192 0,-192 0,-152 131.5,-152 131.5,-192"/>
<text text-anchor="start" x="61.62" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">c</text>
<text text-anchor="start" x="8" y="-157.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_144 -->
<g id="edge4" class="edge">
<title>c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_144</title>
<path fill="none" stroke="black" d="M59.73,-151.56C59.07,-144.25 58.86,-135.75 59.09,-127.67"/>
<polygon fill="black" stroke="black" points="62.57,-128.01 59.65,-117.82 55.59,-127.61 62.57,-128.01"/>
</g>
<!-- c_functionremove_html_markupat0x10700ede0_141&#45;&gt;test_functionremove_html_markupat0x10700ede0_144 -->
<!-- s_functionremove_html_markupat0x10700ede0_136 -->
<g id="node4" class="node">
<title>s_functionremove_html_markupat0x10700ede0_136</title>
<g id="a_node4"><a xlink:title="remove_html_markup:136">
<polygon fill="peachpuff" stroke="black" points="178.5,-344 47,-344 47,-304 178.5,-304 178.5,-344"/>
<text text-anchor="start" x="108.62" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">s</text>
<text text-anchor="start" x="55" y="-309.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- s_functionremove_html_markupat0x10700ede0_136&#45;&gt;c_functionremove_html_markupat0x10700ede0_141 -->
<g id="edge2" class="edge">
<title>s_functionremove_html_markupat0x10700ede0_136&#45;&gt;c_functionremove_html_markupat0x10700ede0_141</title>
<path fill="none" stroke="black" d="M101.29,-303.72C95.6,-293.42 89.04,-280.35 84.75,-268 77.48,-247.05 72.65,-222.47 69.69,-203.57"/>
<polygon fill="black" stroke="black" points="73.17,-203.22 68.26,-193.83 66.25,-204.23 73.17,-203.22"/>
</g>
<!-- quote_functionremove_html_markupat0x10700ede0_138 -->
<g id="node5" class="node">
<title>quote_functionremove_html_markupat0x10700ede0_138</title>
<g id="a_node5"><a xlink:title="remove_html_markup:138">
<polygon fill="peachpuff" stroke="black" points="225.5,-268 94,-268 94,-228 225.5,-228 225.5,-268"/>
<text text-anchor="start" x="139.12" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">quote</text>
<text text-anchor="start" x="102" y="-233.45" font-family="Courier,monospace" font-size="9.00">&lt;remove_html_markup()&gt;</text>
</a>
</g>
</g>
<!-- s_functionremove_html_markupat0x10700ede0_136&#45;&gt;quote_functionremove_html_markupat0x10700ede0_138 -->
<!-- quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;test_functionremove_html_markupat0x10700ede0_144 -->
<g id="edge3" class="edge">
<title>quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;test_functionremove_html_markupat0x10700ede0_144</title>
<path fill="none" stroke="black" d="M159.89,-227.65C159.16,-207.31 155.49,-175.12 140.75,-152 133.49,-140.62 122.98,-130.81 112.11,-122.75"/>
<polygon fill="black" stroke="black" points="114.41,-120.09 104.2,-117.27 110.42,-125.84 114.41,-120.09"/>
</g>
<!-- quote_functionremove_html_markupat0x10700ede0_138&#45;&gt;c_functionremove_html_markupat0x10700ede0_141 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see where the value of <code>tag</code> comes from: from the characters <code>c</code> in <code>s</code> as well as <code>quote</code>, which all cause it to be set. Again, we can combine these dependencies and the listing in a single, compact view. Note, again, that there are no other locations in the code that could possibly have affected <code>tag</code> in our run.</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>   238 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
   239     tag = <span class="ansi-blue-fg">False</span>
   240     quote = <span class="ansi-blue-fg">False</span>
   241     out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
   242 
   243     <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
   244         <span class="ansi-blue-fg">assert</span> tag <span class="ansi-magenta-fg">or</span> <span class="ansi-magenta-fg">not</span> quote
   245 
   246         <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
   247             tag = <span class="ansi-blue-fg">True</span>
   248         <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
   249             tag = <span class="ansi-blue-fg">False</span>
   250         <span class="ansi-blue-fg">elif</span> (c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span>) <span class="ansi-magenta-fg">and</span> tag:
   251             quote = <span class="ansi-magenta-fg">not</span> quote
   252         <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
   253             out = out + c
   254 
   255     <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">How does the slice of <code>tag = True</code> change for a different value of <code>s</code>?</div>
    </p>
    <p>
    <div class="quiz_options" title="Check all that apply.">

        <input type="checkbox" name="4c2e2b82-cce7-11ef-87e4-6298cf1a578f" id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-1" onclick="clear_selection('4c2e2b82-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-1-label" for="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-1">Not at all</label><br>

        <input type="checkbox" name="4c2e2b82-cce7-11ef-87e4-6298cf1a578f" id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-2" onclick="clear_selection('4c2e2b82-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-2-label" for="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-2">If <code>s</code> contains a quote, the <code>quote</code> slice is included, too</label><br>

        <input type="checkbox" name="4c2e2b82-cce7-11ef-87e4-6298cf1a578f" id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-3" onclick="clear_selection('4c2e2b82-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-3-label" for="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-3">If <code>s</code> contains no HTML tag, the slice will be empty</label><br>

    </div>
    </p>
    <input id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-submit" type="submit" value="Submit" onclick="check_selection('4c2e2b82-cce7-11ef-87e4-6298cf1a578f', 12, 1, '[1, 2, 3][1:]')">
    <span class="quiz_hint" id="4c2e2b82-cce7-11ef-87e4-6298cf1a578f-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Indeed, our dynamic slices reflect dependencies as they occurred within a single execution. As the execution changes, so do the dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Tracking-Techniques">Tracking Techniques<a class="anchor-link" href="#Tracking-Techniques">&#182;</a></h2><p>For the remainder of this chapter, let us investigate means to <em>determine such dependencies</em> automatically  by <em>collecting</em> them during program execution. The idea is that with a single Python call, we can collect the dependencies for some computation, and present them to programmers  as graphs or as code annotations, as shown above.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To track dependencies, for every variable, we need to keep track of its <em>origins</em> where it obtained its value, and which tests controlled its assignments. There are two ways to do so:</p>
<ul>
<li>Wrapping Data Objects</li>
<li>Wrapping Data Accesses</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Wrapping-Data-Objects">Wrapping Data Objects<a class="anchor-link" href="#Wrapping-Data-Objects">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One way to track origins is to <em>wrap</em> each value in a class that stores both a value and the origin of the value. If a variable <code>x</code> is initialized to zero in Line 3, for instance, we could store it as</p>

<pre><code>x = (value=0, origin=&lt;Line 3&gt;)</code></pre>
<p>and if it is copied in, say, Line 5 to another variable <code>y</code>, we could store this as</p>

<pre><code>y = (value=0, origin=&lt;Line 3, Line 5&gt;)</code></pre>
<p>Such a scheme would allow us to track origins and dependencies right within the variable.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In a language like Python, it is actually possibly to subclass from basic types. Here's how we create a <code>MyInt</code> subclass of <code>int</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MyInt</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="p">:</span> <span class="n">MyInt</span> <span class="o">=</span> <span class="n">MyInt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can access <code>n</code> just like any integer:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>(5, 6)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, we can also add extra attributes to it:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="s2">&quot;Line 5&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="o">.</span><span class="n">origin</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;Line 5&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Such a "wrapping" scheme has the advantage of <em>leaving program code untouched</em> simply pass "wrapped" objects instead of the original values. However, it also has a number of drawbacks.</p>
<ul>
<li>First, we must make sure that the "wrapper" objects are still compatible with the original values  notably by converting them back whenever needed. (What happens if an internal Python function expects an <code>int</code> and gets a <code>MyInt</code> instead?)</li>
<li>Second, we have to make sure that origins do not get lost during computations which involves overloading operators such as <code>+</code>, <code>-</code>, <code>*</code>, and so on. (Right now, <code>MyInt(1) + 1</code> gives us an <code>int</code> object, not a <code>MyInt</code>.)</li>
<li>Third, we have to do this for <em>all</em> data types of a language, which is pretty tedious.</li>
<li>Fourth and last, however, we want to track whenever a value is assigned to another variable. Python has no support for this, and thus our dependencies will necessarily be incomplete.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Wrapping-Data-Accesses">Wrapping Data Accesses<a class="anchor-link" href="#Wrapping-Data-Accesses">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>An alternate way of tracking origins is to <em>instrument</em> the source code such that all <em>data read and write operations are tracked</em>. That is, the original data stays unchanged, but we change the code instead.</p>
<p>In essence, for every occurrence of a variable <code>x</code> being <em>read</em>, we replace it with</p>
<div class="highlight"><pre><span></span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># returns x</span>
</pre></div>
<p>and for every occurrence of a value being <em>written</em> to <code>x</code>, we replace the value with</p>
<div class="highlight"><pre><span></span><span class="n">_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>  <span class="c1"># returns value</span>
</pre></div>
<p>and let the <code>_data</code> object track these reads and writes.</p>
<p>Hence, an assignment such as</p>
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
<p>would get rewritten to</p>
<div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
</pre></div>
<p>and with every access to <code>_data</code>, we would track</p>
<ol>
<li>the current <em>location</em> in the code, and </li>
<li>whether the respective variable was read or written.</li>
</ol>
<p>For the above statement, we could deduce that <code>b</code> and <code>c</code> were read, and <code>a</code> was written which makes <code>a</code> data dependent on <code>b</code> and <code>c</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The advantage of such instrumentation is that it works with <em>arbitrary objects</em> (in Python, that is) we do not care whether <code>a</code>, <code>b</code>, and <code>c</code> would be integers, floats, strings, lists or any other type for which <code>+</code> would be defined. Also, the code semantics remain entirely unchanged.</p>
<p>The disadvantage, however, is that it takes a bit of effort to exactly separate reads and writes into individual groups, and that a number of language features have to be handled separately. This is what we do in the remainder of this chapter.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-Data-Tracker">A Data Tracker<a class="anchor-link" href="#A-Data-Tracker">&#182;</a></h2><p>To implement <code>_data</code> accesses as shown above, we introduce the <code>DataTracker</code> class. As its name suggests, it keeps track of variables being read and written, and provides methods to determine the code location where this took place.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">StackInspector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Track data accesses during execution&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor. If `log` is set, turn on logging.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>set()</code> is invoked when a variable is set, as in</p>
<div class="highlight"><pre><span></span><span class="n">pi</span> <span class="o">=</span> <span class="n">_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="mf">3.1415</span><span class="p">)</span>
</pre></div>
<p>By default, we simply log the access using name and value. (<code>loads</code> will be used later.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">loads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track setting `name` to `value`.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: setting </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>get()</code> is invoked when a variable is retrieved, as in</p>
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="n">pi</span><span class="p">))</span>
</pre></div>
<p>By default, we simply log the access.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track getting `value` from `name`.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: getting </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's an example of a logging <code>DataTracker</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span> <span class="o">=</span> <span class="n">DataTracker</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;module&gt;:2: setting x
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;module&gt;:1: getting x
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Instrumenting-Source-Code">Instrumenting Source Code<a class="anchor-link" href="#Instrumenting-Source-Code">&#182;</a></h2><p>How do we transform source code such that read and write accesses to variables would be automatically rewritten?  To this end, we inspect the internal representation of source code, namely the <em>abstract syntax trees</em> (ASTs). An AST represents the code as a tree, with specific node types for each syntactical element.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">show_ast</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is the tree representation for our <code>middle()</code> function. It starts with a <code>FunctionDef</code> node at the top (with the name <code>"middle"</code> and the three arguments <code>x</code>, <code>y</code>, <code>z</code> as children), followed by a subtree for each of the <code>If</code> statements, each of which contains a branch for when their condition evaluates to <code>True</code> and a branch for when their condition evaluates to <code>False</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">middle_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">middle</span><span class="p">))</span>
<span class="n">show_ast</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1862pt" height="476pt" viewBox="0.00 0.00 1862.00 476.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 472)">
<polygon fill="white" stroke="none" points="-4,4 -4,-472 1858,-472 1858,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="197.62" y="-445.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="67" y="-372.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;middle&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M247,-431C247,-431 174.24,-413.42 117,-396 114.02,-395.09 110.95,-394.13 107.86,-393.13"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="133.88" y="-373.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M247,-431C247,-431 217.68,-410.94 195.47,-395.74"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="start" x="464.75" y="-373.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 0&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>0--9</title>
<path fill="none" stroke="black" d="M247,-431C247,-431 386.32,-398.94 446.19,-385.17"/>
</g>
<!-- 70 -->
<g id="node71" class="node">
<title>70</title>
<text text-anchor="start" x="1111.25" y="-373.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;70 -->
<g id="edge70" class="edge">
<title>0--70</title>
<path fill="none" stroke="black" d="M247,-431C247,-431 942.92,-390.29 1103.31,-380.91"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="14.62" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M158,-359C158,-359 104.5,-341.4 63,-324 59.94,-322.72 56.76,-321.32 53.62,-319.89"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="start" x="86.62" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>2--5</title>
<path fill="none" stroke="black" d="M158,-359C158,-359 135.24,-338.94 117.99,-323.74"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="start" x="158.62" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>2--7</title>
<path fill="none" stroke="black" d="M158,-359C158,-359 163.01,-338.94 166.82,-323.74"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="27" y="-228.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M27,-288.05C27,-277.05 27,-262.76 27,-251.79"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="99" y="-228.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 5&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>5--6</title>
<path fill="none" stroke="black" d="M99,-288.05C99,-277.05 99,-262.76 99,-251.79"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="171" y="-228.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;z&quot;</text>
</g>
<!-- 7&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>7--8</title>
<path fill="none" stroke="black" d="M171,-288.05C171,-277.05 171,-262.76 171,-251.79"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="start" x="322.12" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 9&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>9--10</title>
<path fill="none" stroke="black" d="M490,-359C490,-359 428.7,-336.07 387.52,-320.66"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="start" x="594.75" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 9&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>9--18</title>
<path fill="none" stroke="black" d="M490,-359C490,-359 542.8,-334.7 576.22,-319.32"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<text text-anchor="start" x="1314.75" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 9&#45;&#45;44 -->
<g id="edge44" class="edge">
<title>9--44</title>
<path fill="none" stroke="black" d="M490,-359C490,-359 1153.65,-317.57 1296.23,-308.67"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="start" x="226.5" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 10&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>10--11</title>
<path fill="none" stroke="black" d="M345,-287C345,-287 300.02,-264.07 269.8,-248.66"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="315" y="-228.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Lt</text>
</g>
<!-- 10&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>10--14</title>
<path fill="none" stroke="black" d="M345,-287C345,-287 333.43,-266.94 324.66,-251.74"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="start" x="370.5" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 10&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>10--15</title>
<path fill="none" stroke="black" d="M345,-287C345,-287 361.2,-266.94 373.48,-251.74"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="171" y="-156.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 11&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>11--12</title>
<path fill="none" stroke="black" d="M236,-215C236,-215 210.93,-194.94 191.92,-179.74"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="243" y="-156.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 11&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>11--13</title>
<path fill="none" stroke="black" d="M236,-215C236,-215 238.7,-194.94 240.75,-179.74"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="315" y="-156.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;z&quot;</text>
</g>
<!-- 15&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>15--16</title>
<path fill="none" stroke="black" d="M380,-215C380,-215 354.93,-194.94 335.92,-179.74"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="387" y="-156.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 15&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>15--17</title>
<path fill="none" stroke="black" d="M380,-215C380,-215 382.7,-194.94 384.75,-179.74"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="start" x="516.12" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 18&#45;&#45;19 -->
<g id="edge19" class="edge">
<title>18--19</title>
<path fill="none" stroke="black" d="M613,-287C613,-287 586.77,-266.94 566.89,-251.74"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="start" x="636.25" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 18&#45;&#45;27 -->
<g id="edge27" class="edge">
<title>18--27</title>
<path fill="none" stroke="black" d="M613,-287C613,-287 631.52,-266.94 645.55,-251.74"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="start" x="882.75" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 18&#45;&#45;31 -->
<g id="edge31" class="edge">
<title>18--31</title>
<path fill="none" stroke="black" d="M613,-287C613,-287 794.32,-253.08 864.09,-240.03"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="start" x="442.5" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 19&#45;&#45;20 -->
<g id="edge20" class="edge">
<title>19--20</title>
<path fill="none" stroke="black" d="M543,-215C543,-215 510.19,-194.69 485.58,-179.45"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="531" y="-156.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Lt</text>
</g>
<!-- 19&#45;&#45;23 -->
<g id="edge23" class="edge">
<title>19--23</title>
<path fill="none" stroke="black" d="M543,-215C543,-215 538.37,-194.94 534.86,-179.74"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="start" x="586.5" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 19&#45;&#45;24 -->
<g id="edge24" class="edge">
<title>19--24</title>
<path fill="none" stroke="black" d="M543,-215C543,-215 566.15,-194.94 583.69,-179.74"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="387" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 20&#45;&#45;21 -->
<g id="edge21" class="edge">
<title>20--21</title>
<path fill="none" stroke="black" d="M452,-143C452,-143 426.93,-122.94 407.92,-107.74"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="459" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 20&#45;&#45;22 -->
<g id="edge22" class="edge">
<title>20--22</title>
<path fill="none" stroke="black" d="M452,-143C452,-143 454.7,-122.94 456.75,-107.74"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="531" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 24&#45;&#45;25 -->
<g id="edge25" class="edge">
<title>24--25</title>
<path fill="none" stroke="black" d="M596,-143C596,-143 570.93,-122.94 551.92,-107.74"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="603" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 24&#45;&#45;26 -->
<g id="edge26" class="edge">
<title>24--26</title>
<path fill="none" stroke="black" d="M596,-143C596,-143 598.7,-122.94 600.75,-107.74"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="start" x="658.5" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 27&#45;&#45;28 -->
<g id="edge28" class="edge">
<title>27--28</title>
<path fill="none" stroke="black" d="M664.39,-216.05C666.59,-205.05 669.45,-190.76 671.64,-179.79"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="675" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 28&#45;&#45;29 -->
<g id="edge29" class="edge">
<title>28--29</title>
<path fill="none" stroke="black" d="M682,-143C682,-143 679.3,-122.94 677.25,-107.74"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="middle" x="747" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 28&#45;&#45;30 -->
<g id="edge30" class="edge">
<title>28--30</title>
<path fill="none" stroke="black" d="M682,-143C682,-143 707.07,-122.94 726.08,-107.74"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="start" x="862.12" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 31&#45;&#45;32 -->
<g id="edge32" class="edge">
<title>31--32</title>
<path fill="none" stroke="black" d="M901,-215C901,-215 897.14,-194.94 894.22,-179.74"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<text text-anchor="start" x="982.25" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 31&#45;&#45;40 -->
<g id="edge40" class="edge">
<title>31--40</title>
<path fill="none" stroke="black" d="M901,-215C901,-215 943.19,-194.3 974.33,-179.03"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="start" x="802.5" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 32&#45;&#45;33 -->
<g id="edge33" class="edge">
<title>32--33</title>
<path fill="none" stroke="black" d="M891,-143C891,-143 863.23,-122.94 842.18,-107.74"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="middle" x="891" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Lt</text>
</g>
<!-- 32&#45;&#45;36 -->
<g id="edge36" class="edge">
<title>32--36</title>
<path fill="none" stroke="black" d="M891,-143C891,-143 891,-122.94 891,-107.74"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<text text-anchor="start" x="946.5" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 32&#45;&#45;37 -->
<g id="edge37" class="edge">
<title>32--37</title>
<path fill="none" stroke="black" d="M891,-143C891,-143 918.77,-122.94 939.82,-107.74"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="middle" x="747" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 33&#45;&#45;34 -->
<g id="edge34" class="edge">
<title>33--34</title>
<path fill="none" stroke="black" d="M812,-71C812,-71 786.93,-50.94 767.92,-35.74"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="middle" x="819" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 33&#45;&#45;35 -->
<g id="edge35" class="edge">
<title>33--35</title>
<path fill="none" stroke="black" d="M812,-71C812,-71 814.7,-50.94 816.75,-35.74"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<text text-anchor="middle" x="891" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;z&quot;</text>
</g>
<!-- 37&#45;&#45;38 -->
<g id="edge38" class="edge">
<title>37--38</title>
<path fill="none" stroke="black" d="M956,-71C956,-71 930.93,-50.94 911.92,-35.74"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<text text-anchor="middle" x="963" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 37&#45;&#45;39 -->
<g id="edge39" class="edge">
<title>37--39</title>
<path fill="none" stroke="black" d="M956,-71C956,-71 958.7,-50.94 960.75,-35.74"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<text text-anchor="start" x="1018.5" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 40&#45;&#45;41 -->
<g id="edge41" class="edge">
<title>40--41</title>
<path fill="none" stroke="black" d="M1013.78,-144.05C1018.18,-133.05 1023.89,-118.76 1028.28,-107.79"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<text text-anchor="middle" x="1035" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 41&#45;&#45;42 -->
<g id="edge42" class="edge">
<title>41--42</title>
<path fill="none" stroke="black" d="M1042,-71C1042,-71 1039.3,-50.94 1037.25,-35.74"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<text text-anchor="middle" x="1107" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 41&#45;&#45;43 -->
<g id="edge43" class="edge">
<title>41--43</title>
<path fill="none" stroke="black" d="M1042,-71C1042,-71 1067.07,-50.94 1086.08,-35.74"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<text text-anchor="start" x="1236.12" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 44&#45;&#45;45 -->
<g id="edge45" class="edge">
<title>44--45</title>
<path fill="none" stroke="black" d="M1332,-287C1332,-287 1306.15,-266.94 1286.57,-251.74"/>
</g>
<!-- 53 -->
<g id="node54" class="node">
<title>53</title>
<text text-anchor="start" x="1356.25" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 44&#45;&#45;53 -->
<g id="edge53" class="edge">
<title>44--53</title>
<path fill="none" stroke="black" d="M1332,-287C1332,-287 1350.9,-266.94 1365.23,-251.74"/>
</g>
<!-- 57 -->
<g id="node58" class="node">
<title>57</title>
<text text-anchor="start" x="1497.75" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 44&#45;&#45;57 -->
<g id="edge57" class="edge">
<title>44--57</title>
<path fill="none" stroke="black" d="M1332,-287C1332,-287 1430.39,-257.6 1479.19,-243.01"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<text text-anchor="start" x="1162.5" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 45&#45;&#45;46 -->
<g id="edge46" class="edge">
<title>45--46</title>
<path fill="none" stroke="black" d="M1263,-215C1263,-215 1230.19,-194.69 1205.58,-179.45"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<text text-anchor="middle" x="1251" y="-156.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Gt</text>
</g>
<!-- 45&#45;&#45;49 -->
<g id="edge49" class="edge">
<title>45--49</title>
<path fill="none" stroke="black" d="M1263,-215C1263,-215 1258.37,-194.94 1254.86,-179.74"/>
</g>
<!-- 50 -->
<g id="node51" class="node">
<title>50</title>
<text text-anchor="start" x="1306.5" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 45&#45;&#45;50 -->
<g id="edge50" class="edge">
<title>45--50</title>
<path fill="none" stroke="black" d="M1263,-215C1263,-215 1286.15,-194.94 1303.69,-179.74"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<text text-anchor="middle" x="1107" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 46&#45;&#45;47 -->
<g id="edge47" class="edge">
<title>46--47</title>
<path fill="none" stroke="black" d="M1172,-143C1172,-143 1146.93,-122.94 1127.92,-107.74"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<text text-anchor="middle" x="1179" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 46&#45;&#45;48 -->
<g id="edge48" class="edge">
<title>46--48</title>
<path fill="none" stroke="black" d="M1172,-143C1172,-143 1174.7,-122.94 1176.75,-107.74"/>
</g>
<!-- 51 -->
<g id="node52" class="node">
<title>51</title>
<text text-anchor="middle" x="1251" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 50&#45;&#45;51 -->
<g id="edge51" class="edge">
<title>50--51</title>
<path fill="none" stroke="black" d="M1316,-143C1316,-143 1290.93,-122.94 1271.92,-107.74"/>
</g>
<!-- 52 -->
<g id="node53" class="node">
<title>52</title>
<text text-anchor="middle" x="1323" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 50&#45;&#45;52 -->
<g id="edge52" class="edge">
<title>50--52</title>
<path fill="none" stroke="black" d="M1316,-143C1316,-143 1318.7,-122.94 1320.75,-107.74"/>
</g>
<!-- 54 -->
<g id="node55" class="node">
<title>54</title>
<text text-anchor="start" x="1378.5" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 53&#45;&#45;54 -->
<g id="edge54" class="edge">
<title>53--54</title>
<path fill="none" stroke="black" d="M1384.39,-216.05C1386.59,-205.05 1389.45,-190.76 1391.64,-179.79"/>
</g>
<!-- 55 -->
<g id="node56" class="node">
<title>55</title>
<text text-anchor="middle" x="1395" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;y&quot;</text>
</g>
<!-- 54&#45;&#45;55 -->
<g id="edge55" class="edge">
<title>54--55</title>
<path fill="none" stroke="black" d="M1402,-143C1402,-143 1399.3,-122.94 1397.25,-107.74"/>
</g>
<!-- 56 -->
<g id="node57" class="node">
<title>56</title>
<text text-anchor="middle" x="1467" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 54&#45;&#45;56 -->
<g id="edge56" class="edge">
<title>54--56</title>
<path fill="none" stroke="black" d="M1402,-143C1402,-143 1427.07,-122.94 1446.08,-107.74"/>
</g>
<!-- 58 -->
<g id="node59" class="node">
<title>58</title>
<text text-anchor="start" x="1542.12" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 57&#45;&#45;58 -->
<g id="edge58" class="edge">
<title>57--58</title>
<path fill="none" stroke="black" d="M1533,-215C1533,-215 1547.66,-194.94 1558.77,-179.74"/>
</g>
<!-- 66 -->
<g id="node67" class="node">
<title>66</title>
<text text-anchor="start" x="1698.25" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 57&#45;&#45;66 -->
<g id="edge66" class="edge">
<title>57--66</title>
<path fill="none" stroke="black" d="M1533,-215C1533,-215 1636.01,-186.81 1690.34,-171.94"/>
</g>
<!-- 59 -->
<g id="node60" class="node">
<title>59</title>
<text text-anchor="start" x="1522.5" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 58&#45;&#45;59 -->
<g id="edge59" class="edge">
<title>58--59</title>
<path fill="none" stroke="black" d="M1578,-143C1578,-143 1562.96,-122.94 1551.55,-107.74"/>
</g>
<!-- 62 -->
<g id="node63" class="node">
<title>62</title>
<text text-anchor="middle" x="1611" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Gt</text>
</g>
<!-- 58&#45;&#45;62 -->
<g id="edge62" class="edge">
<title>58--62</title>
<path fill="none" stroke="black" d="M1578,-143C1578,-143 1590.73,-122.94 1600.38,-107.74"/>
</g>
<!-- 63 -->
<g id="node64" class="node">
<title>63</title>
<text text-anchor="start" x="1666.5" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 58&#45;&#45;63 -->
<g id="edge63" class="edge">
<title>58--63</title>
<path fill="none" stroke="black" d="M1578,-143C1578,-143 1625.12,-119.66 1656.23,-104.26"/>
</g>
<!-- 60 -->
<g id="node61" class="node">
<title>60</title>
<text text-anchor="middle" x="1467" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 59&#45;&#45;60 -->
<g id="edge60" class="edge">
<title>59--60</title>
<path fill="none" stroke="black" d="M1532,-71C1532,-71 1506.93,-50.94 1487.92,-35.74"/>
</g>
<!-- 61 -->
<g id="node62" class="node">
<title>61</title>
<text text-anchor="middle" x="1539" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 59&#45;&#45;61 -->
<g id="edge61" class="edge">
<title>59--61</title>
<path fill="none" stroke="black" d="M1532,-71C1532,-71 1534.7,-50.94 1536.75,-35.74"/>
</g>
<!-- 64 -->
<g id="node65" class="node">
<title>64</title>
<text text-anchor="middle" x="1611" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;z&quot;</text>
</g>
<!-- 63&#45;&#45;64 -->
<g id="edge64" class="edge">
<title>63--64</title>
<path fill="none" stroke="black" d="M1676,-71C1676,-71 1650.93,-50.94 1631.92,-35.74"/>
</g>
<!-- 65 -->
<g id="node66" class="node">
<title>65</title>
<text text-anchor="middle" x="1683" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 63&#45;&#45;65 -->
<g id="edge65" class="edge">
<title>63--65</title>
<path fill="none" stroke="black" d="M1676,-71C1676,-71 1678.7,-50.94 1680.75,-35.74"/>
</g>
<!-- 67 -->
<g id="node68" class="node">
<title>67</title>
<text text-anchor="start" x="1738.5" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 66&#45;&#45;67 -->
<g id="edge67" class="edge">
<title>66--67</title>
<path fill="none" stroke="black" d="M1730.75,-144.05C1735.78,-133.05 1742.31,-118.76 1747.33,-107.79"/>
</g>
<!-- 68 -->
<g id="node69" class="node">
<title>68</title>
<text text-anchor="middle" x="1755" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 67&#45;&#45;68 -->
<g id="edge68" class="edge">
<title>67--68</title>
<path fill="none" stroke="black" d="M1762,-71C1762,-71 1759.3,-50.94 1757.25,-35.74"/>
</g>
<!-- 69 -->
<g id="node70" class="node">
<title>69</title>
<text text-anchor="middle" x="1827" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 67&#45;&#45;69 -->
<g id="edge69" class="edge">
<title>67--69</title>
<path fill="none" stroke="black" d="M1762,-71C1762,-71 1787.07,-50.94 1806.08,-35.74"/>
</g>
<!-- 71 -->
<g id="node72" class="node">
<title>71</title>
<text text-anchor="start" x="1561.5" y="-301.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 70&#45;&#45;71 -->
<g id="edge71" class="edge">
<title>70--71</title>
<path fill="none" stroke="black" d="M1168.5,-371.85C1252.23,-358.59 1474.15,-323.45 1551.2,-311.24"/>
</g>
<!-- 72 -->
<g id="node73" class="node">
<title>72</title>
<text text-anchor="middle" x="1578" y="-228.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;z&quot;</text>
</g>
<!-- 71&#45;&#45;72 -->
<g id="edge72" class="edge">
<title>71--72</title>
<path fill="none" stroke="black" d="M1585,-287C1585,-287 1582.3,-266.94 1580.25,-251.74"/>
</g>
<!-- 73 -->
<g id="node74" class="node">
<title>73</title>
<text text-anchor="middle" x="1650" y="-228.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 71&#45;&#45;73 -->
<g id="edge73" class="edge">
<title>71--73</title>
<path fill="none" stroke="black" d="M1585,-287C1585,-287 1610.07,-266.94 1629.08,-251.74"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>At the very bottom of the tree, you can see a number of <code>Name</code> nodes, referring individual variables. These are the ones we want to transform.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Tracking-Variable-Accesses">Tracking Variable Accesses<a class="anchor-link" href="#Tracking-Variable-Accesses">&#182;</a></h3><p>Our goal is to <em>traverse</em> the tree, identify all <code>Name</code> nodes, and convert them to respective <code>_data</code> accesses.
To this end, we manipulate the AST through the <code>ast</code> Python module <code>ast</code>. The <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> is complete, but a bit brief; the documentation <a href="https://greentreesnakes.readthedocs.io/en/latest/">"Green Tree Snakes - the missing Python AST docs"</a> provides an excellent introduction.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The Python <code>ast</code> module provides a class <code>NodeTransformer</code> that allows such transformations. By subclassing from it, we provide a method <code>visit_Name()</code> that will be invoked for all <code>Name</code> nodes and replace it by a new subtree from <code>make_get_data()</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span> <span class="kn">import</span> <span class="n">NodeTransformer</span><span class="p">,</span> <span class="n">NodeVisitor</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">AST</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/typing.html" class="import" target="_blank">typing</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATA_TRACKER</span> <span class="o">=</span> <span class="s1">&#39;_data&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_internal</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if `id` is a built-in function or type&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">id</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">__builtins__</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">typing</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">is_internal</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_internal</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_internal</span><span class="p">(</span><span class="s1">&#39;Tuple&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackGetTransformer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_Name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_internal</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
            <span class="c1"># Do not change built-in names and types</span>
            <span class="k">return</span> <span class="n">node</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">DATA_TRACKER</span><span class="p">:</span>
            <span class="c1"># Do not change own accesses</span>
            <span class="k">return</span> <span class="n">node</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">Load</span><span class="p">):</span>
            <span class="c1"># Only change loads (not stores, not deletions)</span>
            <span class="k">return</span> <span class="n">node</span>

        <span class="n">new_node</span> <span class="o">=</span> <span class="n">make_get_data</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">copy_location</span><span class="p">(</span><span class="n">new_node</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our function <code>make_get_data(id, method)</code> returns a new subtree equivalent to the Python code <code>_data.method('id', id)</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span> <span class="kn">import</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Load</span><span class="p">,</span> <span class="n">Store</span><span class="p">,</span> \
    <span class="n">Attribute</span><span class="p">,</span> <span class="n">With</span><span class="p">,</span> <span class="n">withitem</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">Call</span><span class="p">,</span> <span class="n">Expr</span><span class="p">,</span> \
    <span class="n">Assign</span><span class="p">,</span> <span class="n">AugAssign</span><span class="p">,</span> <span class="n">AnnAssign</span><span class="p">,</span> <span class="n">Assert</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Starting with Python 3.8, these will become Constant.</span>
<span class="c1"># from ast import Num, Str, NameConstant</span>
<span class="c1"># Use `ast.Num`, `ast.Str`, and `ast.NameConstant` for compatibility</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_get_data</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;get&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Call</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Call</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">Attribute</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">DATA_TRACKER</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span> 
                               <span class="n">attr</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">())],</span>
                <span class="n">keywords</span><span class="o">=</span><span class="p">[])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the tree that <code>make_get_data()</code> produces:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_ast</span><span class="p">(</span><span class="n">Module</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">[</span><span class="n">make_get_data</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)],</span> <span class="n">type_ignores</span><span class="o">=</span><span class="p">[]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="484pt" height="260pt" viewBox="0.00 0.00 483.88 260.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 256)">
<polygon fill="white" stroke="none" points="-4,4 -4,-256 479.88,-256 479.88,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="277.38" y="-229.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Call</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="start" x="138.75" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Attribute</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M292.88,-215C292.88,-215 248.02,-195.07 213.86,-179.88"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="start" x="260.88" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 0&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>0--7</title>
<path fill="none" stroke="black" d="M292.88,-215C292.88,-215 293.26,-194.94 293.55,-179.74"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="start" x="363.38" y="-157.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 0&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>0--9</title>
<path fill="none" stroke="black" d="M292.88,-215C292.88,-215 327.71,-194.18 353.3,-178.88"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="61.38" y="-85.95" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 1&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>1--2</title>
<path fill="none" stroke="black" d="M171.88,-143C171.88,-143 132.59,-121.27 104.81,-105.9"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="151.88" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;get&quot;</text>
</g>
<!-- 1&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>1--5</title>
<path fill="none" stroke="black" d="M171.88,-143C171.88,-143 164.16,-122.94 158.31,-107.74"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="225.88" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 1&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>1--6</title>
<path fill="none" stroke="black" d="M171.88,-143C171.88,-143 192.71,-122.94 208.49,-107.74"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="36.88" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;_data&quot;</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M77.88,-71C77.88,-71 62.06,-50.94 50.07,-35.74"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="118.88" y="-12.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 2&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>2--4</title>
<path fill="none" stroke="black" d="M77.88,-71C77.88,-71 93.69,-50.94 105.68,-35.74"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="297.88" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 7&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>7--8</title>
<path fill="none" stroke="black" d="M294.84,-144.05C295.47,-133.05 296.29,-118.76 296.92,-107.79"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="376.88" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;x&quot;</text>
</g>
<!-- 9&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>9--10</title>
<path fill="none" stroke="black" d="M386.88,-143C386.88,-143 383.02,-122.94 380.09,-107.74"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="448.88" y="-84.95" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 9&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>9--11</title>
<path fill="none" stroke="black" d="M386.88,-143C386.88,-143 410.79,-122.94 428.92,-107.74"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How do we know that this is a correct subtree? We can carefully read the <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> and then proceed by trial and error (and apply <a href="DeltaDebugger.html">delta debugging</a> to determine error causes). Or  pro tip! we can simply take a piece of Python code, parse it and use <code>ast.dump()</code> to print out how to construct the resulting AST:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;_data.get(&#39;x&#39;, x)&quot;</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Module(body=[Expr(value=Call(func=Attribute(value=Name(id=&#39;_data&#39;, ctx=Load()), attr=&#39;get&#39;, ctx=Load()), args=[Constant(value=&#39;x&#39;), Name(id=&#39;x&#39;, ctx=Load())], keywords=[]))], type_ignores=[])
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If you compare the above output with the code of <code>make_get_data()</code>, above, you will find out where the source of <code>make_get_data()</code> comes from.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us put <code>TrackGetTransformer</code> to action. Its <code>visit()</code> method calls <code>visit_Name()</code>, which then in turn transforms the <code>Name</code> nodes as we want it. This happens in place.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackGetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">);</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To see the effect of our transformations, we introduce a method <code>dump_tree()</code> which outputs the tree and also compiles it to check for any inconsistencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">dump_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
    <span class="n">ast</span><span class="o">.</span><span class="n">fix_missing_locations</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>  <span class="c1"># Must run this before compiling</span>
    <span class="n">_</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">tree</span><span class="p">),</span> <span class="s1">&#39;&lt;dump_tree&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that our transformer has properly replaced all variable accesses:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dump_tree</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):
    <span class="ansi-blue-fg">if</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z):
        <span class="ansi-blue-fg">if</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y):
            <span class="ansi-blue-fg">return</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)
        <span class="ansi-blue-fg">elif</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z):
            <span class="ansi-blue-fg">return</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)
    <span class="ansi-blue-fg">elif</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y):
        <span class="ansi-blue-fg">return</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)
    <span class="ansi-blue-fg">elif</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z):
        <span class="ansi-blue-fg">return</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x)
    <span class="ansi-blue-fg">return</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us now execute this code together with the <code>DataTracker()</code> class we previously introduced. The class <code>DataTrackerTester()</code> takes a (transformed) tree and a function. Using it as</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="n">func</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
<p>first executes the code in <em>tree</em> (possibly instrumenting <code>func</code>) and then the <code>with</code> body. At the end, <code>func</code> is restored to its previous (non-instrumented) version.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/types.html" class="import" target="_blank">types</a></span> <span class="kn">import</span> <span class="n">TracebackType</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTrackerTester</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor. Execute the code in `tree` while instrumenting `func`.&quot;&quot;&quot;</span>
        <span class="c1"># We pass the source file of `func` such that we can retrieve it</span>
        <span class="c1"># when accessing the location of the new compiled code</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcefile</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">tree</span><span class="p">),</span> <span class="n">source</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>

    <span class="k">def</span> <span class="nf">make_data_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DataTracker</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rewrite function&quot;&quot;&quot;</span>
        <span class="n">tracker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_data_tracker</span><span class="p">()</span>
        <span class="nb">globals</span><span class="p">()[</span><span class="n">DATA_TRACKER</span><span class="p">]</span> <span class="o">=</span> <span class="n">tracker</span>
        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">tracker</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span>
                 <span class="n">traceback</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore function&quot;&quot;&quot;</span>
        <span class="nb">globals</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
        <span class="k">del</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">DATA_TRACKER</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is our <code>middle()</code> function:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">middle</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">,</span> <span class="n">start_line_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> 1  <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):  <span class="ansi-white-fg"># type: ignore</span>
 2      <span class="ansi-blue-fg">if</span> y &lt; z:
 3          <span class="ansi-blue-fg">if</span> x &lt; y:
 4              <span class="ansi-blue-fg">return</span> y
 5          <span class="ansi-blue-fg">elif</span> x &lt; z:
 6              <span class="ansi-blue-fg">return</span> y
 7      <span class="ansi-blue-fg">else</span>:
 8          <span class="ansi-blue-fg">if</span> x &gt; y:
 9              <span class="ansi-blue-fg">return</span> y
10          <span class="ansi-blue-fg">elif</span> x &gt; z:
11              <span class="ansi-blue-fg">return</span> x
12      <span class="ansi-blue-fg">return</span> z
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And here is our instrumented <code>middle_tree</code> executed with a <code>DataTracker</code> object. We see how the <code>middle()</code> tests access one argument after another.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">,</span> <span class="n">middle</span><span class="p">):</span>
    <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle:2: getting y
middle:2: getting z
middle:3: getting x
middle:3: getting y
middle:5: getting x
middle:5: getting z
middle:6: getting y
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>After <code>DataTrackerTester</code> is done, <code>middle</code> is reverted to its non-instrumented version:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For a complete picture of what happens during executions, we implement a number of additional code transformers.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For each assignment statement <code>x = y</code>, we change it to <code>x = _data.set('x', y)</code>. This allows <strong>tracking assignments</strong>.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Tracking-Assignments-and-Assertions">
<summary>Tracking Assignments and Assertions</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For the remaining transformers, we follow the same steps as for <code>TrackGetTransformer</code>, except that our <code>visit_...()</code> methods focus on different nodes, and return different subtrees. Here, we focus on assignment nodes.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We want to transform assignments <code>x = value</code> into <code>_data.set('x', value)</code> to track assignments to <code>x</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If the left-hand side of the assignment is more complex, as in <code>x[y] = value</code>, we want to ensure the read access to <code>x</code> and <code>y</code> is also tracked. By transforming <code>x[y] = value</code> into <code>_data.set('x', value, loads=(x, y))</code>, we ensure that <code>x</code> and <code>y</code> are marked as read (as the otherwise ignored <code>loads</code> argument would be changed to <code>_data.get()</code> calls for <code>x</code> and <code>y</code>).</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using <code>ast.dump()</code>, we reveal what the corresponding syntax tree has to look like:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;_data.set(&#39;x&#39;, value, loads=(a, b))&quot;</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Module(body=[Expr(value=Call(func=Attribute(value=Name(id=&#39;_data&#39;, ctx=Load()), attr=&#39;set&#39;, ctx=Load()), args=[Constant(value=&#39;x&#39;), Name(id=&#39;value&#39;, ctx=Load())], keywords=[keyword(arg=&#39;loads&#39;, value=Tuple(elts=[Name(id=&#39;a&#39;, ctx=Load()), Name(id=&#39;b&#39;, ctx=Load())], ctx=Load()))]))], type_ignores=[])
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using this structure, we can write a function <code>make_set_data()</code> which constructs such a subtree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_set_data</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> 
                  <span class="n">loads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;set&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Call</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct a subtree _data.`method`(&#39;`id`&#39;, `value`). </span>
<span class="sd">    If `loads` is set to [X1, X2, ...], make it</span>
<span class="sd">    _data.`method`(&#39;`id`&#39;, `value`, loads=(X1, X2, ...))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">keywords</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">if</span> <span class="n">loads</span><span class="p">:</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;loads&#39;</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span>
                        <span class="n">elts</span><span class="o">=</span><span class="p">[</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">load</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">())</span> <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loads</span><span class="p">],</span>
                        <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()</span>
                    <span class="p">))</span>
        <span class="p">]</span>

    <span class="n">new_node</span> <span class="o">=</span> <span class="n">Call</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">Attribute</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">DATA_TRACKER</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                                   <span class="n">attr</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="n">value</span><span class="p">],</span>
                    <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">)</span>

    <span class="n">ast</span><span class="o">.</span><span class="n">copy_location</span><span class="p">(</span><span class="n">new_node</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The problem is, however: How do we get the name of the variable being assigned to? The left-hand side of an assignment can be a complex expression such as <code>x[i]</code>. We use the leftmost name of the left-hand side as name to be assigned to.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">LeftmostNameVisitor</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leftmost_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">visit_Name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leftmost_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leftmost_name</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">leftmost_name</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">visitor</span> <span class="o">=</span> <span class="n">LeftmostNameVisitor</span><span class="p">()</span>
    <span class="n">visitor</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visitor</span><span class="o">.</span><span class="n">leftmost_name</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">leftmost_name</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;a[x] = 25&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;a&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Python also allows <em>tuple assignments</em>, as in <code>(a, b, c) = (1, 2, 3)</code>. We extract all variables being stored (that is, expressions whose <code>ctx</code> attribute is <code>Store()</code>) and extract their (leftmost) names.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">StoreVisitor</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s1">&#39;ctx&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">Store</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">leftmost_name</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">store_names</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">visitor</span> <span class="o">=</span> <span class="n">StoreVisitor</span><span class="p">()</span>
    <span class="n">visitor</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visitor</span><span class="o">.</span><span class="n">names</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">store_names</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;a[x], b[y], c = 1, 2, 3&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;a&#39;, &#39;b&#39;, &#39;c&#39;}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For complex assignments, we also want to access the names read in the left hand side of an expression.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">LoadVisitor</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s1">&#39;ctx&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">Load</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">leftmost_name</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_names</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">visitor</span> <span class="o">=</span> <span class="n">LoadVisitor</span><span class="p">()</span>
    <span class="n">visitor</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visitor</span><span class="o">.</span><span class="n">names</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">load_names</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;a[x], b[y], c = 1, 2, 3&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;a&#39;, &#39;b&#39;, &#39;x&#39;, &#39;y&#39;}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With this, we can now define <code>TrackSetTransformer</code> as a transformer for regular assignments. Note that in Python, an assignment can have multiple targets, as in <code>a = b = c</code>; we assign the data dependencies of <code>c</code> to them all.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackSetTransformer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_Assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Assign</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Assign</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.set&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># Do not apply twice</span>

        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">targets</span><span class="p">:</span>
            <span class="n">loads</span> <span class="o">=</span> <span class="n">load_names</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">store_name</span> <span class="ow">in</span> <span class="n">store_names</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="n">store_name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> 
                                           <span class="n">loads</span><span class="o">=</span><span class="n">loads</span><span class="p">)</span>
                <span class="n">loads</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The special form of "augmented assign" needs special treatment. We change statements of the form <code>x += y</code> to <code>x += _data.augment('x', y)</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackSetTransformer</span><span class="p">(</span><span class="n">TrackSetTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_AugAssign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AugAssign</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AugAssign</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># Do not apply twice</span>

        <span class="nb">id</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">leftmost_name</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">target</span><span class="p">))</span>
        <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;augment&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The corresponding <code>augment()</code> method uses a combination of <code>set()</code> and <code>get()</code> to reflect the semantics.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">augment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Track augmenting `name` with `value`.</span>
<span class="sd">        To be overloaded in subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>"Annotated" assignments come with a type, as in <code>x: int = 3</code>. We treat them like regular assignments.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackSetTransformer</span><span class="p">(</span><span class="n">TrackSetTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_AnnAssign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AnnAssign</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnnAssign</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># just &lt;var&gt;: &lt;type&gt; without value</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.set&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># Do not apply twice</span>

        <span class="n">loads</span> <span class="o">=</span> <span class="n">load_names</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">store_name</span> <span class="ow">in</span> <span class="n">store_names</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
            <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="n">store_name</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> 
                                       <span class="n">loads</span><span class="o">=</span><span class="n">loads</span><span class="p">)</span>
            <span class="n">loads</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Finally, we treat <em>assertions</em> just as if they were assignments to special variables:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackSetTransformer</span><span class="p">(</span><span class="n">TrackSetTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_Assert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Assert</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Assert</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.set&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># Do not apply twice</span>

        <span class="n">loads</span> <span class="o">=</span> <span class="n">load_names</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="s2">&quot;&lt;assertion&gt;&quot;</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">loads</span><span class="o">=</span><span class="n">loads</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's all of these transformers in action. Our original function has a number of assignments:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">assign_test</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="n">forty_two</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span>
    <span class="n">forty_two</span> <span class="o">=</span> <span class="n">forty_two</span> <span class="o">=</span> <span class="mi">42</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span>
    <span class="n">c</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">]]</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="mi">47</span>
    <span class="n">a</span> <span class="o">*=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">forty_two</span><span class="p">,</span> <span class="s2">&quot;Forty-Two&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">assign_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">assign_test</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackSetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">assign_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">assign_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">assign_test</span>(x: <span class="ansi-cyan-fg">int</span>) -&gt; Tuple[<span class="ansi-cyan-fg">int</span>, <span class="ansi-cyan-fg">str</span>]:
    forty_two: <span class="ansi-cyan-fg">int</span> = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">42</span>)
    forty_two = forty_two = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">42</span>))
    a, b = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, (<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">2</span>)))
    c = d = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">d</span><span class="ansi-yellow-fg">&#39;</span>, _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, [a, b]))
    c[d[a]].attr = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">47</span>, loads=(d, a, c))
    a *= _data.augment(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, b + <span class="ansi-blue-fg">1</span>)
    <span class="ansi-blue-fg">assert</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;assertion&gt;</span><span class="ansi-yellow-fg">&#39;</span>, a &gt; <span class="ansi-blue-fg">0</span>, loads=(a,))
    <span class="ansi-blue-fg">return</span> (forty_two, <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">Forty-Two</span><span class="ansi-yellow-fg">&#39;</span>)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we later apply our transformer for data accesses, we can see that we track all variable reads and writes.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackGetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">assign_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">assign_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">assign_test</span>(x: <span class="ansi-cyan-fg">int</span>) -&gt; Tuple[<span class="ansi-cyan-fg">int</span>, <span class="ansi-cyan-fg">str</span>]:
    forty_two: <span class="ansi-cyan-fg">int</span> = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">42</span>)
    forty_two = forty_two = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">42</span>))
    a, b = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, (<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">2</span>)))
    c = d = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">d</span><span class="ansi-yellow-fg">&#39;</span>, _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, [_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, a), _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, b)]))
    _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, c)[_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">d</span><span class="ansi-yellow-fg">&#39;</span>, d)[_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, a)]].attr = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">47</span>, loads=(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">d</span><span class="ansi-yellow-fg">&#39;</span>, d), _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, a), _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, c)))
    a *= _data.augment(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, b) + <span class="ansi-blue-fg">1</span>)
    <span class="ansi-blue-fg">assert</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;assertion&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, a) &gt; <span class="ansi-blue-fg">0</span>, loads=(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, a),))
    <span class="ansi-blue-fg">return</span> (_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">forty_two</span><span class="ansi-yellow-fg">&#39;</span>, forty_two), <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">Forty-Two</span><span class="ansi-yellow-fg">&#39;</span>)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Each return statement <code>return x</code> is transformed to <code>return _data.set('&lt;return_value&gt;', x)</code>. This allows <strong>tracking return values</strong>.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Tracking-Return-Values">
<summary>Tracking Return Values</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>TrackReturnTransformer</code> also makes use of <code>make_set_data()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackReturnTransformer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">visit_FunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFunctionDef</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="n">outer_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># Save current name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">=</span> <span class="n">outer_name</span>
        <span class="k">return</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">visit_AsyncFunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_FunctionDef</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">return_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;return&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s2"> value&gt;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">function_name</span><span class="si">}</span><span class="s2">() </span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s2"> value&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">visit_return_or_yield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Return</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Yield</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">YieldFrom</span><span class="p">],</span>
                              <span class="n">tp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;return&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.set&#39;</span><span class="p">):</span>
                <span class="n">node</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_value</span><span class="p">(</span><span class="n">tp</span><span class="p">),</span> <span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">visit_Return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Return</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_return_or_yield</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="s2">&quot;return&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Yield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Yield</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_return_or_yield</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="s2">&quot;yield&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_YieldFrom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">YieldFrom</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_return_or_yield</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="s2">&quot;yield&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the effect of <code>TrackReturnTransformer</code>. We see that all return values are saved, and thus all locations of the corresponding return statements are tracked.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackReturnTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):
    <span class="ansi-blue-fg">if</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z):
        <span class="ansi-blue-fg">if</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y):
            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
        <span class="ansi-blue-fg">elif</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z):
            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
    <span class="ansi-blue-fg">elif</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y):
        <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
    <span class="ansi-blue-fg">elif</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z):
        <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x))
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">,</span> <span class="n">middle</span><span class="p">):</span>
    <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle:2: getting y
middle:2: getting z
middle:3: getting x
middle:3: getting y
middle:5: getting x
middle:5: getting z
middle:6: getting y
middle:6: setting &lt;middle() return value&gt;
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To track <strong>control dependencies</strong>, for every block controlled by an <code>if</code>, <code>while</code>, or <code>for</code>:</p>
<ol>
<li>We wrap their tests in a <code>_data.test()</code> wrapper. This allows us to assign pseudo-variables like <code>&lt;test&gt;</code> which hold the conditions.</li>
<li>We wrap their controlled blocks in a <code>with</code> statement. This allows us to track the variables read right before the <code>with</code> (= the controlling variables), and to restore the current controlling variables when the block is left.</li>
</ol>
<p>A statement</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">cond</span><span class="p">:</span>
    <span class="n">body</span>
</pre></div>
<p>thus becomes</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">_data</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">cond</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">_data</span><span class="p">:</span>
        <span class="n">body</span>
</pre></div>
</div>
</div>
</div>
</div>

<details id="Excursion:-Tracking-Control">
<summary>Tracking Control</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To modify control statements, we traverse the tree, looking for <code>If</code> nodes:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackControlTransformer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_test</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_with</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">orelse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_with</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">orelse</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The subtrees come from helper functions <code>make_with()</code> and <code>make_test()</code>. Again, all these subtrees are obtained via <code>ast.dump()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackControlTransformer</span><span class="p">(</span><span class="n">TrackControlTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">make_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">stmt</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">stmt</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a subtree &#39;with _data: `block`&#39;&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">block_as_text</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">block_as_text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;with &#39;</span> <span class="o">+</span> <span class="n">DATA_TRACKER</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">block</span>  <span class="c1"># Do not apply twice</span>

        <span class="n">new_node</span> <span class="o">=</span> <span class="n">With</span><span class="p">(</span>
            <span class="n">items</span><span class="o">=</span><span class="p">[</span>
                <span class="n">withitem</span><span class="p">(</span>
                    <span class="n">context_expr</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">DATA_TRACKER</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                    <span class="n">optional_vars</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">body</span><span class="o">=</span><span class="n">block</span>
        <span class="p">)</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">copy_location</span><span class="p">(</span><span class="n">new_node</span><span class="p">,</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">new_node</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackControlTransformer</span><span class="p">(</span><span class="n">TrackControlTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">make_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">expr</span><span class="p">:</span>
        <span class="n">test_as_text</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">test_as_text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.test&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">test</span>  <span class="c1"># Do not apply twice</span>

        <span class="n">new_test</span> <span class="o">=</span> <span class="n">Call</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">Attribute</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">DATA_TRACKER</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                                       <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span>
                                       <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                         <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">test</span><span class="p">],</span>
                         <span class="n">keywords</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">copy_location</span><span class="p">(</span><span class="n">new_test</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_test</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>while</code> loops are handled just like <code>if</code> constructs.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackControlTransformer</span><span class="p">(</span><span class="n">TrackControlTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_While</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">While</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">While</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_test</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_with</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">orelse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_with</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">orelse</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>for</code> loops gets a different treatment, as there is no condition that would control the body. Still, we ensure that setting the iterator variable is properly tracked.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackControlTransformer</span><span class="p">(</span><span class="n">TrackControlTransformer</span><span class="p">):</span>
    <span class="c1"># regular `for` loop</span>
    <span class="k">def</span> <span class="nf">visit_For</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">For</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">node</span><span class="o">.</span><span class="n">iter</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span>

        <span class="c1"># Uncomment if you want iterators to control their bodies</span>
        <span class="c1"># node.body = self.make_with(node.body)</span>
        <span class="c1"># node.orelse = self.make_with(node.orelse)</span>
        <span class="k">return</span> <span class="n">node</span>

    <span class="c1"># `for` loops in async functions</span>
    <span class="k">def</span> <span class="nf">visit_AsyncFor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_For</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="c1"># `for` clause in comprehensions</span>
    <span class="k">def</span> <span class="nf">visit_comprehension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">comprehension</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">node</span><span class="o">.</span><span class="n">iter</span> <span class="o">=</span> <span class="n">make_set_data</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is the effect of <code>TrackControlTransformer</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackControlTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):
    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
        <span class="ansi-blue-fg">with</span> _data:
            <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)):
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
            <span class="ansi-blue-fg">else</span>:
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
                        <span class="ansi-blue-fg">with</span> _data:
                            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
    <span class="ansi-blue-fg">else</span>:
        <span class="ansi-blue-fg">with</span> _data:
            <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)):
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
            <span class="ansi-blue-fg">else</span>:
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
                        <span class="ansi-blue-fg">with</span> _data:
                            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x))
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We extend <code>DataTracker</code> to also log these events:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test condition `cond`. To be overloaded in subclasses.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: testing condition&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cond</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enter `with` block. To be overloaded in subclasses.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: entering block&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span> 
                 <span class="n">traceback</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exit `with` block. To be overloaded in subclasses.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: exiting block&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">,</span> <span class="n">middle</span><span class="p">):</span>
    <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle:2: getting y
middle:2: getting z
middle:2: testing condition
middle:3: entering block
middle:3: getting x
middle:3: getting y
middle:3: testing condition
middle:5: entering block
middle:5: getting x
middle:5: getting z
middle:5: testing condition
middle:6: entering block
middle:6: getting y
middle:6: setting &lt;middle() return value&gt;
middle:6: exiting block
middle:5: exiting block
middle:3: exiting block
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We also want to be able to <strong>track calls</strong> across multiple functions. To this end, we wrap each call</p>
<div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
<p>into</p>
<div class="highlight"><pre><span></span><span class="n">_data</span><span class="o">.</span><span class="n">ret</span><span class="p">(</span><span class="n">_data</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">_data</span><span class="o">.</span><span class="n">arg</span><span class="p">(</span><span class="n">arg1</span><span class="p">),</span> <span class="n">_data</span><span class="o">.</span><span class="n">arg</span><span class="p">(</span><span class="n">arg2</span><span class="p">),</span> <span class="o">...</span><span class="p">))</span>
</pre></div>
<p>each of which simply pass through their given argument, but which allow tracking the beginning of calls (<code>call()</code>), the computation of arguments (<code>arg()</code>), and the return of the call (<code>ret()</code>), respectively.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Tracking-Calls-and-Arguments">
<summary>Tracking Calls and Arguments</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>TrackCallTransformer</code> visits all <code>Call</code> nodes, applying the transformations as shown above.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackCallTransformer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">make_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                  <span class="n">pos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kw</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Call</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return _data.call(`func`)(`node`)&quot;&quot;&quot;</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># `Num()` and `Str()` are deprecated in favor of `Constant()`</span>
        <span class="k">if</span> <span class="n">pos</span><span class="p">:</span>
            <span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="n">pos</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;kw&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="n">kw</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">Call</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">Attribute</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">DATA_TRACKER</span><span class="p">,</span>
                                              <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                                   <span class="n">attr</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
                                   <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                     <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
                     <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Call</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Call</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="n">call_as_text</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">call_as_text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.ret&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># Already applied</span>

        <span class="n">func_as_text</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func_as_text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DATA_TRACKER</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">node</span>  <span class="c1"># Own function</span>

        <span class="n">new_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
            <span class="n">new_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">make_call</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">node</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">expr</span><span class="p">],</span> <span class="n">new_args</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">arg</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">kw</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_call</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>

        <span class="n">node</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_call</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;call&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_call</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our example function <code>middle()</code> does not contain any calls, but here is a function that invokes <code>middle()</code> twice:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_call</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">middle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">test_call</span><span class="p">))</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">test_call</span>() -&gt; <span class="ansi-cyan-fg">int</span>:
    x = middle(<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">2</span>, z=middle(<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">2</span>, <span class="ansi-blue-fg">3</span>))
    <span class="ansi-blue-fg">return</span> x
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we invoke <code>TrackCallTransformer</code> on this testing function, we get the following transformed code:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackCallTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">);</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:11: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;kw&#39;, value=ast.Str(kw)))
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dump_tree</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">test_call</span>() -&gt; <span class="ansi-cyan-fg">int</span>:
    x = _data.ret(_data.call(middle)(_data.arg(<span class="ansi-blue-fg">1</span>, pos=<span class="ansi-blue-fg">1</span>), _data.arg(<span class="ansi-blue-fg">2</span>, pos=<span class="ansi-blue-fg">2</span>), z=_data.arg(_data.ret(_data.call(middle)(_data.arg(<span class="ansi-blue-fg">1</span>, pos=<span class="ansi-blue-fg">1</span>), _data.arg(<span class="ansi-blue-fg">2</span>, pos=<span class="ansi-blue-fg">2</span>), _data.arg(<span class="ansi-blue-fg">3</span>, pos=<span class="ansi-blue-fg">3</span>))), kw=<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>)))
    <span class="ansi-blue-fg">return</span> x
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">f_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">f</span>() -&gt; <span class="ansi-cyan-fg">bool</span>:
    <span class="ansi-blue-fg">return</span> math.isclose(<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">1.0</span>)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackCallTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">f_tree</span><span class="p">);</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dump_tree</span><span class="p">(</span><span class="n">f_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">f</span>() -&gt; <span class="ansi-cyan-fg">bool</span>:
    <span class="ansi-blue-fg">return</span> _data.ret(_data.call(math.isclose)(_data.arg(<span class="ansi-blue-fg">1</span>, pos=<span class="ansi-blue-fg">1</span>), _data.arg(<span class="ansi-blue-fg">1.0</span>, pos=<span class="ansi-blue-fg">2</span>)))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As before, our default <code>arg()</code>, <code>ret()</code>, and <code>call()</code> methods simply log the event and pass through the given value.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kw</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Track `value` being passed as argument.</span>
<span class="sd">        `pos` (if given) is the argument position (starting with 1).</span>
<span class="sd">        `kw` (if given) is the argument keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="n">info</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">pos</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; #</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">kw</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: pushing arg</span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">ret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track `value` being used as return value.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: returned from call&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">instrument_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instrument a call to `func`. To be implemented in subclasses.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track a call to `func`.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: calling </span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrument_call</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dump_tree</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">test_call</span>() -&gt; <span class="ansi-cyan-fg">int</span>:
    x = _data.ret(_data.call(middle)(_data.arg(<span class="ansi-blue-fg">1</span>, pos=<span class="ansi-blue-fg">1</span>), _data.arg(<span class="ansi-blue-fg">2</span>, pos=<span class="ansi-blue-fg">2</span>), z=_data.arg(_data.ret(_data.call(middle)(_data.arg(<span class="ansi-blue-fg">1</span>, pos=<span class="ansi-blue-fg">1</span>), _data.arg(<span class="ansi-blue-fg">2</span>, pos=<span class="ansi-blue-fg">2</span>), _data.arg(<span class="ansi-blue-fg">3</span>, pos=<span class="ansi-blue-fg">3</span>))), kw=<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>)))
    <span class="ansi-blue-fg">return</span> x
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">call_tree</span><span class="p">,</span> <span class="n">test_call</span><span class="p">):</span>
    <span class="n">test_call</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>test_call:2: calling &lt;function middle at 0x10700d120&gt;
test_call:2: pushing arg #1
test_call:2: pushing arg #2
test_call:2: calling &lt;function middle at 0x10700d120&gt;
test_call:2: pushing arg #1
test_call:2: pushing arg #2
test_call:2: pushing arg #3
test_call:2: returned from call
test_call:2: pushing arg &#39;z&#39;
test_call:2: returned from call
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_call</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>2
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>On the receiving end, for each function argument <code>x</code>, we insert a call <code>_data.param('x', x, [position info])</code> to initialize <code>x</code>. This is useful for <strong>tracking parameters across function calls.</strong></p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Tracking-Parameters">
<summary>Tracking Parameters</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, we use <code>ast.dump()</code> to determine the correct syntax tree:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;_data.param(&#39;x&#39;, x, pos=1, last=True)&quot;</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Module(body=[Expr(value=Call(func=Attribute(value=Name(id=&#39;_data&#39;, ctx=Load()), attr=&#39;param&#39;, ctx=Load()), args=[Constant(value=&#39;x&#39;), Name(id=&#39;x&#39;, ctx=Load())], keywords=[keyword(arg=&#39;pos&#39;, value=Constant(value=1)), keyword(arg=&#39;last&#39;, value=Constant(value=True))]))], type_ignores=[])
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TrackParamsTransformer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_FunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="n">named_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">ast</span><span class="o">.</span><span class="n">iter_child_nodes</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">arg</span><span class="p">):</span>
                <span class="n">named_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

        <span class="n">create_stmts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">named_args</span><span class="p">):</span>
            <span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))]</span>
            <span class="k">if</span> <span class="n">child</span> <span class="ow">is</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">vararg</span><span class="p">:</span>
                <span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;vararg&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">child</span> <span class="ow">is</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kwarg</span><span class="p">:</span>
                <span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;vararg&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s1">&#39;**&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">named_args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">,</span>
                                        <span class="n">value</span><span class="o">=</span><span class="n">ast</span><span class="o">.</span><span class="n">NameConstant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>

            <span class="n">create_stmt</span> <span class="o">=</span> <span class="n">Expr</span><span class="p">(</span>
                <span class="n">value</span><span class="o">=</span><span class="n">Call</span><span class="p">(</span>
                    <span class="n">func</span><span class="o">=</span><span class="n">Attribute</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">DATA_TRACKER</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                                   <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;param&#39;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">arg</span><span class="p">),</span>
                          <span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">child</span><span class="o">.</span><span class="n">arg</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">())</span>
                         <span class="p">],</span>
                    <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">ast</span><span class="o">.</span><span class="n">copy_location</span><span class="p">(</span><span class="n">create_stmt</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
            <span class="n">create_stmts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_stmt</span><span class="p">)</span>

        <span class="n">node</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">stmt</span><span class="p">],</span> <span class="n">create_stmts</span><span class="p">)</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span>
        <span class="k">return</span> <span class="n">node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the effect of <code>TrackParamsTransformer()</code>. You see how the first three parameters are all initialized.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TrackParamsTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>)
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y, pos=<span class="ansi-blue-fg">2</span>)
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z, pos=<span class="ansi-blue-fg">3</span>, last=<span class="ansi-blue-fg">True</span>)
    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
        <span class="ansi-blue-fg">with</span> _data:
            <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)):
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
            <span class="ansi-blue-fg">else</span>:
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
                        <span class="ansi-blue-fg">with</span> _data:
                            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
    <span class="ansi-blue-fg">else</span>:
        <span class="ansi-blue-fg">with</span> _data:
            <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)):
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
            <span class="ansi-blue-fg">else</span>:
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
                        <span class="ansi-blue-fg">with</span> _data:
                            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x))
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>By default, the <code>DataTracker</code> <code>param()</code> method simply calls <code>set()</code> to set variables.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DataTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> 
              <span class="n">pos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vararg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        At the beginning of a function, track parameter `name` being set to `value`.</span>
<span class="sd">        `pos` is the position of the argument (starting with 1).</span>
<span class="sd">        `vararg` is &quot;*&quot; if `name` is a vararg parameter (as in *args),</span>
<span class="sd">        and &quot;**&quot; is `name` is a kwargs parameter (as in *kwargs).</span>
<span class="sd">        `last` is True if `name` is the last parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="n">info</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; #</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: initializing </span><span class="si">{</span><span class="n">vararg</span><span class="si">}{</span><span class="n">name</span><span class="si">}{</span><span class="n">info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">,</span> <span class="n">middle</span><span class="p">):</span>
    <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle:12: initializing x #1
middle:12: setting x
middle:12: initializing y #2
middle:12: setting y
middle:12: initializing z #3
middle:12: setting z
middle:2: getting y
middle:2: getting z
middle:2: testing condition
middle:3: entering block
middle:3: getting x
middle:3: getting y
middle:3: testing condition
middle:5: entering block
middle:5: getting x
middle:5: getting z
middle:5: testing condition
middle:6: entering block
middle:6: getting y
middle:6: setting &lt;middle() return value&gt;
middle:6: exiting block
middle:5: exiting block
middle:3: exiting block
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">args_test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">args_test</span><span class="p">))</span>
<span class="n">TrackParamsTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">args_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">args_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:14: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;vararg&#39;, value=ast.Str(&#39;*&#39;)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:16: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;vararg&#39;, value=ast.Str(&#39;**&#39;)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">args_test</span>(x, *args, **kwargs):
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>)
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">args</span><span class="ansi-yellow-fg">&#39;</span>, args, pos=<span class="ansi-blue-fg">2</span>, vararg=<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">*</span><span class="ansi-yellow-fg">&#39;</span>)
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">kwargs</span><span class="ansi-yellow-fg">&#39;</span>, kwargs, pos=<span class="ansi-blue-fg">3</span>, vararg=<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">**</span><span class="ansi-yellow-fg">&#39;</span>, last=<span class="ansi-blue-fg">True</span>)
    <span class="ansi-cyan-fg">print</span>(x, *args, **kwargs)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">args_tree</span><span class="p">,</span> <span class="n">args_test</span><span class="p">):</span>
    <span class="n">args_test</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>args_test:2: initializing x #1
args_test:2: setting x
args_test:2: initializing *args #2
args_test:2: setting args
args_test:2: initializing **kwargs #3
args_test:2: setting kwargs
1 2 3
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>What do we obtain after we have applied all these transformers on <code>middle()</code>? We see that the code now contains quite a load of instrumentation.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dump_tree</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>)
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y, pos=<span class="ansi-blue-fg">2</span>)
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z, pos=<span class="ansi-blue-fg">3</span>, last=<span class="ansi-blue-fg">True</span>)
    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
        <span class="ansi-blue-fg">with</span> _data:
            <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)):
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
            <span class="ansi-blue-fg">else</span>:
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &lt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
                        <span class="ansi-blue-fg">with</span> _data:
                            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
    <span class="ansi-blue-fg">else</span>:
        <span class="ansi-blue-fg">with</span> _data:
            <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y)):
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y))
            <span class="ansi-blue-fg">else</span>:
                <span class="ansi-blue-fg">with</span> _data:
                    <span class="ansi-blue-fg">if</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt; _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z)):
                        <span class="ansi-blue-fg">with</span> _data:
                            <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x))
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;middle() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">z</span><span class="ansi-yellow-fg">&#39;</span>, z))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And when we execute this code, we see that we can track quite a number of events, while the code semantics stay unchanged.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DataTrackerTester</span><span class="p">(</span><span class="n">middle_tree</span><span class="p">,</span> <span class="n">middle</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle:12: initializing x #1
middle:12: setting x
middle:12: initializing y #2
middle:12: setting y
middle:12: initializing z #3
middle:12: setting z
middle:2: getting y
middle:2: getting z
middle:2: testing condition
middle:3: entering block
middle:3: getting x
middle:3: getting y
middle:3: testing condition
middle:5: entering block
middle:5: getting x
middle:5: getting z
middle:5: testing condition
middle:6: entering block
middle:6: getting y
middle:6: setting &lt;middle() return value&gt;
middle:6: exiting block
middle:5: exiting block
middle:3: exiting block
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1
</pre>
</div>

</div>

<details id="Excursion:-Transformer-Stress-Test">
<summary>Transformer Stress Test</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We stress test our transformers by instrumenting, transforming, and compiling a number of modules.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="Assertions.html" class="import" target="_blank">Assertions</a></span>  <span class="c1"># minor dependency</span>
<span class="kn">import</span> <span class="nn"><a href="Debugger.html" class="import" target="_blank">Debugger</a></span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Assertions</span><span class="p">,</span> <span class="n">Debugger</span><span class="p">,</span> <span class="n">inspect</span><span class="p">,</span> <span class="n">ast</span><span class="p">]:</span>
    <span class="n">module_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_tree</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span>

    <span class="n">TrackCallTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>
    <span class="n">TrackSetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>
    <span class="n">TrackGetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>
    <span class="n">TrackControlTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>
    <span class="n">TrackReturnTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>
    <span class="n">TrackParamsTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>
    <span class="c1"># dump_tree(module_tree)</span>
    <span class="n">ast</span><span class="o">.</span><span class="n">fix_missing_locations</span><span class="p">(</span><span class="n">module_tree</span><span class="p">)</span>  <span class="c1"># Must run this before compiling</span>

    <span class="n">module_code</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">module_tree</span><span class="p">,</span> <span class="s1">&#39;&lt;stress_test&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> instrumented successfully.&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#39;Assertions&#39; instrumented successfully.
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:14: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;vararg&#39;, value=ast.Str(&#39;*&#39;)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:11: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;kw&#39;, value=ast.Str(kw)))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#39;Debugger&#39; instrumented successfully.
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:16: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;vararg&#39;, value=ast.Str(&#39;**&#39;)))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#39;inspect&#39; instrumented successfully.
&#39;ast&#39; instrumented successfully.
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our next step will now be not only to <em>log</em> these events, but to actually construct <em>dependencies</em> from them.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Tracking-Dependencies">Tracking Dependencies<a class="anchor-link" href="#Tracking-Dependencies">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To construct dependencies from variable accesses, we subclass <code>DataTracker</code> into <code>DependencyTracker</code>  a class that actually keeps track of all these dependencies.  Its constructor initializes a number of variables we will discuss below.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DataTracker</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Track dependencies during execution&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor. Arguments are passed to DataTracker.__init__()&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Location</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Where current variables were last set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dependencies</span><span class="p">:</span> <span class="n">Dependency</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># As with Dependencies, above</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_dependencies</span><span class="p">:</span> <span class="n">Dependency</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of last read variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_checked_location</span> <span class="o">=</span> <span class="p">(</span><span class="n">StackInspector</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_location_change</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[]]</span>  <span class="c1"># Data stack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[]]</span>  <span class="c1"># Control stack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}]</span>  <span class="c1"># Argument stack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Current args</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Data-Dependencies">Data Dependencies<a class="anchor-link" href="#Data-Dependencies">&#182;</a></h3><p>The first job of our <code>DependencyTracker</code> is to construct dependencies between <em>read</em> and <em>written</em> variables.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Reading-Variables">Reading Variables<a class="anchor-link" href="#Reading-Variables">&#182;</a></h4><p>As in <code>DataTracker</code>, the key method of <code>DependencyTracker</code> again is <code>get()</code>, invoked as <code>_data.get('x', x)</code> whenever a variable <code>x</code> is read. First and foremost, it appends the name of the read variable to the list <code>last_read</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track a read access for variable `name` with value `value`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_location</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_location</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># More on that below</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span> <span class="o">=</span> <span class="n">DependencyTracker</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;module&gt;:2: getting x
&lt;module&gt;:2: getting y
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>8
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">last_read</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;x&#39;, &#39;y&#39;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Checking-Locations">Checking Locations<a class="anchor-link" href="#Checking-Locations">&#182;</a></h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, before appending the read variable to <code>last_read</code>, <code>_data.get()</code> does one more thing. By invoking <code>check_location()</code>, it clears the <code>last_read</code> list if we have reached a new line in the execution. This avoids situations such as</p>
<div class="highlight"><pre><span></span><span class="n">x</span>
<span class="n">y</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
<p>where <code>x</code> and <code>y</code> are, well, read, but do not affect the last line. Therefore, with every new line, the list of last read lines is cleared.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">clear_read</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear set of read variables&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">direct_caller</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;clearing read variables </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="si">}</span><span class="s2"> &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;(from </span><span class="si">{</span><span class="n">direct_caller</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">check_location</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If we are in a new location, clear set of read variables&quot;&quot;&quot;</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
        <span class="n">func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">location</span>
        <span class="n">last_func</span><span class="p">,</span> <span class="n">last_lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked_location</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked_location</span> <span class="o">!=</span> <span class="n">location</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_location_change</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_location_change</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">):</span>
                <span class="c1"># Entering list comprehension, eval(), exec(), ...</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">last_func</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">):</span>
                <span class="c1"># Exiting list comprehension, eval(), exec(), ...</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Standard case</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_checked_location</span> <span class="o">=</span> <span class="n">location</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Two methods can suppress this reset of the <code>last_read</code> list:</p>
<ul>
<li><code>ignore_next_location_change()</code> suppresses the reset for the next line. This is useful when returning from a function, when the return value is still in the list of "read" variables.</li>
<li><code>ignore_location_change()</code> suppresses the reset for the current line. This is useful if we already have returned from a function call.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">ignore_next_location_change</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_location_change</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">ignore_location_change</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_checked_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Watch how <code>DependencyTracker</code> resets <code>last_read</code> when a new line is executed:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span> <span class="o">=</span> <span class="n">DependencyTracker</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>8
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">last_read</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;x&#39;, &#39;y&#39;]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>41
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">last_read</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;x&#39;, &#39;y&#39;, &#39;a&#39;, &#39;b&#39;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Setting-Variables">Setting Variables<a class="anchor-link" href="#Setting-Variables">&#182;</a></h4><p>The method <code>set()</code> creates dependencies. It is invoked as <code>_data.set('x', value)</code> whenever a variable <code>x</code> is set.</p>
<p>First and foremost, it takes the list of variables read <code>last_read</code>, and for each of the variables $v$, it takes their origin $o$ (the place where they were last set) and appends the pair ($v$, $o$) to the list of data dependencies. It then does a similar thing with control dependencies (more on these below), and finally marks (in <code>self.origins</code>) the current location of $v$.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/itertools.html" class="import" target="_blank">itertools</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="n">TEST</span> <span class="o">=</span> <span class="s1">&#39;&lt;test&gt;&#39;</span>  <span class="c1"># Name of pseudo-variables for testing conditions</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">loads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a dependency for `name` = `value`&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">add_dependencies</span><span class="p">(</span><span class="n">dependencies</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Node</span><span class="p">],</span> 
                             <span class="n">vars_read</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">tp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Add origins of `vars_read` to `dependencies`.&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">var_read</span> <span class="ow">in</span> <span class="n">vars_read</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var_read</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">var_read</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">TEST</span> <span class="ow">and</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span>
                        <span class="c1"># Can&#39;t have data dependencies on conditions</span>
                        <span class="k">continue</span>

                    <span class="n">origin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="n">var_read</span><span class="p">]</span>
                    <span class="n">dependencies</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">var_read</span><span class="p">,</span> <span class="n">origin</span><span class="p">))</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                        <span class="n">origin_func</span><span class="p">,</span> <span class="n">origin_lineno</span> <span class="o">=</span> <span class="n">origin</span>
                        <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                              <span class="sa">f</span><span class="s2">&quot;new </span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s2"> dependency: &quot;</span>
                              <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &lt;= </span><span class="si">{</span><span class="n">var_read</span><span class="si">}</span><span class="s2"> &quot;</span>
                              <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">origin_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">origin_lineno</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_location</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>

        <span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dependencies</span><span class="o">.</span><span class="n">setdefault</span>
                         <span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">),</span> <span class="nb">set</span><span class="p">()),</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
        <span class="n">add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control_dependencies</span><span class="o">.</span><span class="n">setdefault</span>
                         <span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="p">),</span> <span class="nb">set</span><span class="p">()),</span>
                         <span class="n">cast</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">)),</span>
                         <span class="n">tp</span><span class="o">=</span><span class="s2">&quot;control&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">location</span>

        <span class="c1"># Reset read info for next line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="c1"># Next line is a new location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_location_change</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dependencies</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return dependencies&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dependencies</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">control_dependencies</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us illustrate <code>set()</code> by example. Here's a set of variables read and written:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span> <span class="o">=</span> <span class="n">DependencyTracker</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The attribute <code>origins</code> saves for each variable where it was last written:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">origins</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;x&#39;: (&lt;function __main__.&lt;module&gt;()&gt;, 2),
 &#39;y&#39;: (&lt;function __main__.&lt;module&gt;()&gt;, 3),
 &#39;z&#39;: (&lt;function __main__.&lt;module&gt;()&gt;, 4)}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The attribute <code>data_dependencies</code> tracks for each variable the variables it was read from:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">data_dependencies</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;x&#39;, (&lt;function __main__.&lt;module&gt;()&gt;, 2)): set(),
 (&#39;y&#39;,
  (&lt;function __main__.&lt;module&gt;()&gt;, 3)): {(&#39;x&#39;,
   (&lt;function __main__.&lt;module&gt;()&gt;, 2))},
 (&#39;z&#39;,
  (&lt;function __main__.&lt;module&gt;()&gt;, 4)): {(&#39;x&#39;,
   (&lt;function __main__.&lt;module&gt;()&gt;, 2)), (&#39;y&#39;,
   (&lt;function __main__.&lt;module&gt;()&gt;, 3))}}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Hence, the above code already gives us a small dependency graph:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="95pt" height="200pt"
 viewBox="0.00 0.00 95.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-196 91,-196 91,4 -4,4"/>
<!-- x_functionmoduleat0x107462840_2 -->
<g id="node1" class="node">
<title>x_functionmoduleat0x107462840_2</title>
<g id="a_node1"><a xlink:title="&lt;module&gt;:2">
<polygon fill="peachpuff" stroke="black" points="58,-192 0,-192 0,-152 58,-152 58,-192"/>
<text text-anchor="start" x="24.88" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="8" y="-157.45" font-family="Courier,monospace" font-size="9.00">&lt;module&gt;</text>
</a>
</g>
</g>
<!-- z_functionmoduleat0x1074611c0_4 -->
<g id="node2" class="node">
<title>z_functionmoduleat0x1074611c0_4</title>
<g id="a_node2"><a xlink:title="&lt;module&gt;:4">
<polygon fill="peachpuff" stroke="black" points="58,-40 0,-40 0,0 58,0 58,-40"/>
<text text-anchor="start" x="24.88" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="8" y="-5.45" font-family="Courier,monospace" font-size="9.00">&lt;module&gt;</text>
</a>
</g>
</g>
<!-- x_functionmoduleat0x107462840_2&#45;&gt;z_functionmoduleat0x1074611c0_4 -->
<g id="edge1" class="edge">
<title>x_functionmoduleat0x107462840_2&#45;&gt;z_functionmoduleat0x1074611c0_4</title>
<path fill="none" stroke="black" d="M25.06,-151.75C23.11,-141.24 20.97,-127.96 20,-116 18.56,-98.28 18.56,-93.72 20,-76 20.65,-67.97 21.83,-59.34 23.13,-51.35"/>
<polygon fill="black" stroke="black" points="26.54,-52.19 24.8,-41.74 19.64,-50.99 26.54,-52.19"/>
</g>
<!-- y_functionmoduleat0x1074628e0_3 -->
<g id="node3" class="node">
<title>y_functionmoduleat0x1074628e0_3</title>
<g id="a_node3"><a xlink:title="&lt;module&gt;:3">
<polygon fill="peachpuff" stroke="black" points="87,-116 29,-116 29,-76 87,-76 87,-116"/>
<text text-anchor="start" x="53.88" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="37" y="-81.45" font-family="Courier,monospace" font-size="9.00">&lt;module&gt;</text>
</a>
</g>
</g>
<!-- x_functionmoduleat0x107462840_2&#45;&gt;y_functionmoduleat0x1074628e0_3 -->
<g id="edge3" class="edge">
<title>x_functionmoduleat0x107462840_2&#45;&gt;y_functionmoduleat0x1074628e0_3</title>
<path fill="none" stroke="black" d="M36.62,-151.56C39.58,-143.99 43.05,-135.16 46.31,-126.83"/>
<polygon fill="black" stroke="black" points="49.49,-128.31 49.88,-117.72 42.97,-125.76 49.49,-128.31"/>
</g>
<!-- y_functionmoduleat0x1074628e0_3&#45;&gt;z_functionmoduleat0x1074611c0_4 -->
<g id="edge2" class="edge">
<title>y_functionmoduleat0x1074628e0_3&#45;&gt;z_functionmoduleat0x1074611c0_4</title>
<path fill="none" stroke="black" d="M50.38,-75.56C47.42,-67.99 43.95,-59.16 40.69,-50.83"/>
<polygon fill="black" stroke="black" points="44.03,-49.76 37.12,-41.72 37.51,-52.31 44.03,-49.76"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In the remainder of this section, we define methods to</p>
<ul>
<li>track control dependencies (<code>test()</code>, <code>__enter__()</code>, <code>__exit__()</code>)</li>
<li>track function calls and returns (<code>call()</code>, <code>ret()</code>)</li>
<li>track function arguments (<code>arg()</code>, <code>param()</code>)</li>
<li>check the validity of our dependencies (<code>validate()</code>).</li>
</ul>
<p>Like our <code>get()</code> and <code>set()</code> methods above, these work by refining the appropriate methods defined in the <code>DataTracker</code> class, building on our <code>NodeTransformer</code> transformations.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Control-Dependencies">
<summary>Control Dependencies</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us detail control dependencies. As discussed with <code>DataTracker()</code>, we invoke <code>test()</code> methods for all control conditions, and place the controlled blocks into <code>with</code> clauses.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>test()</code> method simply sets a <code>&lt;test&gt;</code> variable; this also places it in <code>last_read</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track a test for condition `value`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TEST</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When entering a <code>with</code> block, the set of <code>last_read</code> variables holds the <code>&lt;test&gt;</code> variable read. We save it in the <code>control</code> stack, with the effect of any further variables written now being marked as controlled by <code>&lt;test&gt;</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track entering an if/while/for block&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When we exit the <code>with</code> block, we restore earlier <code>last_read</code> values, preparing for <code>else</code> blocks.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span>
                 <span class="n">traceback</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track exiting an if/while/for block&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_next_location_change</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's an example of all these parts in action:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span> <span class="o">=</span> <span class="n">DependencyTracker</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)):</span>
    <span class="k">with</span> <span class="n">_test_data</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span>
                           <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">_test_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_data</span><span class="o">.</span><span class="n">control_dependencies</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;x&#39;, (&lt;function __main__.&lt;module&gt;()&gt;, 2)): set(),
 (&#39;y&#39;, (&lt;function __main__.&lt;module&gt;()&gt;, 3)): set(),
 (&#39;&lt;test&gt;&#39;, (&lt;function __main__.&lt;module&gt;()&gt;, 1)): set(),
 (&#39;z&#39;,
  (&lt;function __main__.&lt;module&gt;()&gt;, 3)): {(&#39;&lt;test&gt;&#39;,
   (&lt;function __main__.&lt;module&gt;()&gt;, 1))}}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The control dependency for <code>z</code> is reflected in the dependency graph:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="197pt" height="276pt"
 viewBox="0.00 0.00 196.75 276.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 272)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-272 192.75,-272 192.75,4 -4,4"/>
<!-- x_functionmoduleat0x107462840_2 -->
<g id="node1" class="node">
<title>x_functionmoduleat0x107462840_2</title>
<g id="a_node1"><a xlink:title="&lt;module&gt;:2">
<polygon fill="peachpuff" stroke="black" points="86,-268 28,-268 28,-228 86,-228 86,-268"/>
<text text-anchor="start" x="52.88" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="36" y="-233.45" font-family="Courier,monospace" font-size="9.00">&lt;module&gt;</text>
</a>
</g>
</g>
<!-- z_functionmoduleat0x1074628e0_3 -->
<g id="node2" class="node">
<title>z_functionmoduleat0x1074628e0_3</title>
<g id="a_node2"><a xlink:title="&lt;module&gt;:3">
<polygon fill="peachpuff" stroke="black" points="58,-40 0,-40 0,0 58,0 58,-40"/>
<text text-anchor="start" x="24.88" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="8" y="-5.45" font-family="Courier,monospace" font-size="9.00">&lt;module&gt;</text>
</a>
</g>
</g>
<!-- x_functionmoduleat0x107462840_2&#45;&gt;z_functionmoduleat0x1074628e0_3 -->
<g id="edge1" class="edge">
<title>x_functionmoduleat0x107462840_2&#45;&gt;z_functionmoduleat0x1074628e0_3</title>
<path fill="none" stroke="black" d="M39.33,-227.68C31.47,-217.78 23.08,-205.07 19,-192 4.17,-144.43 13.03,-85.87 20.93,-51.09"/>
<polygon fill="black" stroke="black" points="24.25,-52.27 23.18,-41.73 17.44,-50.64 24.25,-52.27"/>
</g>
<!-- y_functionmoduleat0x1074628e0_3 -->
<g id="node3" class="node">
<title>y_functionmoduleat0x1074628e0_3</title>
<g id="a_node3"><a xlink:title="&lt;module&gt;:3">
<polygon fill="peachpuff" stroke="black" points="86,-192 28,-192 28,-152 86,-152 86,-192"/>
<text text-anchor="start" x="52.88" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="36" y="-157.45" font-family="Courier,monospace" font-size="9.00">&lt;module&gt;</text>
</a>
</g>
</g>
<!-- x_functionmoduleat0x107462840_2&#45;&gt;y_functionmoduleat0x1074628e0_3 -->
<g id="edge4" class="edge">
<title>x_functionmoduleat0x107462840_2&#45;&gt;y_functionmoduleat0x1074628e0_3</title>
<path fill="none" stroke="black" d="M57,-227.56C57,-220.25 57,-211.75 57,-203.67"/>
<polygon fill="black" stroke="black" points="60.5,-203.83 57,-193.83 53.5,-203.83 60.5,-203.83"/>
</g>
<!-- test_functionmoduleat0x107462a20_1 -->
<g id="node4" class="node">
<title>test_functionmoduleat0x107462a20_1</title>
<g id="a_node4"><a xlink:title="&lt;module&gt;:1">
<polygon fill="peachpuff" stroke="black" points="188.75,-116 57.25,-116 57.25,-76 188.75,-76 188.75,-116"/>
<text text-anchor="start" x="98.25" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="65.25" y="-81.45" font-family="Courier,monospace" font-size="9.00">_test_data.get(&#39;x&#39;, x)</text>
</a>
</g>
</g>
<!-- x_functionmoduleat0x107462840_2&#45;&gt;test_functionmoduleat0x107462a20_1 -->
<g id="edge5" class="edge">
<title>x_functionmoduleat0x107462840_2&#45;&gt;test_functionmoduleat0x107462a20_1</title>
<path fill="none" stroke="black" d="M72.7,-227.57C80.27,-217.44 89,-204.57 95,-192 104.88,-171.31 112.06,-146.41 116.68,-127.29"/>
<polygon fill="black" stroke="black" points="120.06,-128.22 118.88,-117.69 113.23,-126.66 120.06,-128.22"/>
</g>
<!-- y_functionmoduleat0x1074628e0_3&#45;&gt;z_functionmoduleat0x1074628e0_3 -->
<g id="edge2" class="edge">
<title>y_functionmoduleat0x1074628e0_3&#45;&gt;z_functionmoduleat0x1074628e0_3</title>
<path fill="none" stroke="black" d="M53.4,-151.7C48.65,-126.27 40.25,-81.28 34.65,-51.29"/>
<polygon fill="black" stroke="black" points="38.14,-50.9 32.87,-41.72 31.26,-52.19 38.14,-50.9"/>
</g>
<!-- y_functionmoduleat0x1074628e0_3&#45;&gt;test_functionmoduleat0x107462a20_1 -->
<g id="edge6" class="edge">
<title>y_functionmoduleat0x1074628e0_3&#45;&gt;test_functionmoduleat0x107462a20_1</title>
<path fill="none" stroke="black" d="M74.34,-151.56C81.62,-143.4 90.21,-133.76 98.14,-124.87"/>
<polygon fill="black" stroke="black" points="100.72,-127.23 104.77,-117.44 95.5,-122.58 100.72,-127.23"/>
</g>
<!-- test_functionmoduleat0x107462a20_1&#45;&gt;z_functionmoduleat0x1074628e0_3 -->
<g id="edge3" class="edge">
<title>test_functionmoduleat0x107462a20_1&#45;&gt;z_functionmoduleat0x1074628e0_3</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M98.3,-75.56C87.29,-66.89 74.16,-56.55 62.3,-47.21"/>
<polygon fill="grey" stroke="grey" points="64.74,-44.68 54.72,-41.25 60.41,-50.18 64.74,-44.68"/>
</g>
</g>
</svg>

</div>

</div>

</details>

<details id="Excursion:-Calls-and-Returns">
<summary>Calls and Returns</summary>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/copy.html" class="import" target="_blank">copy</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To handle complex expressions involving functions, we introduce a <em>data stack</em>. Every time we invoke a function <code>func</code> (<code>call()</code> is invoked), we save the list of current variables read <code>last_read</code> on the <code>data</code> stack; when we return (<code>ret()</code> is invoked), we restore <code>last_read</code>. This also ensures that only those variables read while evaluating arguments will flow into the function call.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track a call of function `func`&quot;&quot;&quot;</span>
        <span class="n">func</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isgeneratorfunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_generator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="c1"># Save context</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;saving read variables </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_next_location_change</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="n">func</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">ret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track a function return&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">ret</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_generator</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ret_generator</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Restore old context and add return value</span>
        <span class="n">ret_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">):</span>  <span class="c1"># &quot;&lt;return value&gt;&quot;</span>
                <span class="n">ret_name</span> <span class="o">=</span> <span class="n">var</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ret_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="c1"># We return from an uninstrumented function:</span>
            <span class="c1"># Make return value depend on all args</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">deps</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">+=</span> <span class="n">deps</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_location_change</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;restored read variables </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Generator functions (those which <code>yield</code> a value) are not "called" in the sense that Python transfers control to them; instead, a "call" to a generator function creates a generator that is evaluated on demand. We mark generator function "calls" by saving <code>None</code> on the stacks. When the generator function returns the generator, we wrap the generator such that the arguments are being restored when it is invoked.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">in_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if we are calling a generator function&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">call_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track a call of a generator function&quot;&quot;&quot;</span>
        <span class="c1"># Mark the fact that we&#39;re in a generator with `None` values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_generator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">ret_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Track the return of a generator function&quot;&quot;&quot;</span>
        <span class="c1"># Pop the two &#39;None&#39; values pushed earlier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;wrapping generator </span><span class="si">{</span><span class="n">generator</span><span class="si">}</span><span class="s2"> (args=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="c1"># At this point, we already have collected the args.</span>
        <span class="c1"># The returned generator depends on all of them.</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>

        <span class="c1"># Wrap the generator such that the args are restored </span>
        <span class="c1"># when it is actually invoked, such that we can map them</span>
        <span class="c1"># to parameters.</span>
        <span class="n">saved_args</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">saved_args</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;calling generator (args=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_next_location_change</span><span class="p">()</span>
            <span class="k">yield from</span> <span class="n">generator</span>

        <span class="k">return</span> <span class="n">wrapper</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see an example of how function calls and returns work in conjunction with function arguments, discussed in the next section.</p>
</div>
</div>
</div>
</div>

</details>

<details id="Excursion:-Function-Arguments">
<summary>Function Arguments</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Finally, we handle parameters and arguments. The <code>args</code> stack holds the current stack of function arguments, holding the <code>last_read</code> variable for each argument.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kw</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Track passing an argument `value`</span>
<span class="sd">        (with given position `pos` 1..n or keyword `kw`)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;saving args read </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pos</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span>
        <span class="k">if</span> <span class="n">kw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">arg</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">kw</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When accessing the arguments (with <code>param()</code>), we can retrieve this set of read variables for each argument.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTracker</span><span class="p">(</span><span class="n">DependencyTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
              <span class="n">pos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vararg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Track getting a parameter `name` with value `value`</span>
<span class="sd">        (with given position `pos`).</span>
<span class="sd">        vararg parameters are indicated by setting `varargs` to </span>
<span class="sd">        &#39;*&#39; (*args) or &#39;**&#39; (**kwargs)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">vararg</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
            <span class="c1"># We over-approximate by setting `args` to _all_ positional args</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">pos</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">vararg</span> <span class="o">==</span> <span class="s1">&#39;**&#39;</span><span class="p">:</span>
            <span class="c1"># We over-approximate by setting `kwargs` to _all_ passed keyword args</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="n">caller_func</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_location</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">caller_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">lineno</span><span class="si">}</span><span class="s2">: &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;restored params read </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">last_read</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_location_change</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">last</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear_read</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Mark `args` as processed</span>

        <span class="k">return</span> <span class="n">ret</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us illustrate all these on a small example.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">call_test</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">47</span>

    <span class="k">def</span> <span class="nf">sq</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">gen</span><span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="k">yield</span> <span class="n">e</span> <span class="o">*</span> <span class="n">c</span>

    <span class="k">def</span> <span class="nf">just_x</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">gen</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">sq</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">xs</span> <span class="k">if</span> <span class="n">elem</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">just_x</span><span class="p">(</span><span class="n">just_x</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">b</span><span class="p">),</span> <span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_test</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1974
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We apply all our transformers on this code:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">call_test</span><span class="p">))</span>
<span class="n">TrackCallTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
<span class="n">TrackSetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
<span class="n">TrackGetTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
<span class="n">TrackControlTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
<span class="n">TrackReturnTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
<span class="n">TrackParamsTransformer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
<span class="n">dump_tree</span><span class="p">(</span><span class="n">call_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">call_test</span>() -&gt; <span class="ansi-cyan-fg">int</span>:
    c = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">47</span>)

    <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">sq</span>(n: <span class="ansi-cyan-fg">int</span>) -&gt; <span class="ansi-cyan-fg">int</span>:
        _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">n</span><span class="ansi-yellow-fg">&#39;</span>, n, pos=<span class="ansi-blue-fg">1</span>, last=<span class="ansi-blue-fg">True</span>)
        <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;sq() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">n</span><span class="ansi-yellow-fg">&#39;</span>, n) * _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">n</span><span class="ansi-yellow-fg">&#39;</span>, n))

    <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">gen</span>(e: <span class="ansi-cyan-fg">int</span>) -&gt; Generator[<span class="ansi-cyan-fg">int</span>, <span class="ansi-blue-fg">None</span>, <span class="ansi-blue-fg">None</span>]:
        _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">e</span><span class="ansi-yellow-fg">&#39;</span>, e, pos=<span class="ansi-blue-fg">1</span>, last=<span class="ansi-blue-fg">True</span>)
        <span class="ansi-blue-fg">yield</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;gen() yield value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">e</span><span class="ansi-yellow-fg">&#39;</span>, e) * _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">c</span><span class="ansi-yellow-fg">&#39;</span>, c))

    <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">just_x</span>(x: Any, y: Any) -&gt; Any:
        _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>)
        _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>, y, pos=<span class="ansi-blue-fg">2</span>, last=<span class="ansi-blue-fg">True</span>)
        <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;just_x() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x))
    a = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">42</span>)
    b = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, _data.ret(_data.call(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">gen</span><span class="ansi-yellow-fg">&#39;</span>, gen))(_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">a</span><span class="ansi-yellow-fg">&#39;</span>, a), pos=<span class="ansi-blue-fg">1</span>))))
    d = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">d</span><span class="ansi-yellow-fg">&#39;</span>, _data.ret(_data.call(<span class="ansi-cyan-fg">list</span>)(_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, b), pos=<span class="ansi-blue-fg">1</span>)))[<span class="ansi-blue-fg">0</span>])
    xs = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">xs</span><span class="ansi-yellow-fg">&#39;</span>, [<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">2</span>, <span class="ansi-blue-fg">3</span>, <span class="ansi-blue-fg">4</span>])
    ys = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">ys</span><span class="ansi-yellow-fg">&#39;</span>, [_data.ret(_data.call(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">sq</span><span class="ansi-yellow-fg">&#39;</span>, sq))(_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">elem</span><span class="ansi-yellow-fg">&#39;</span>, elem), pos=<span class="ansi-blue-fg">1</span>))) <span class="ansi-blue-fg">for</span> elem <span class="ansi-magenta-fg">in</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">elem</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">xs</span><span class="ansi-yellow-fg">&#39;</span>, xs)) <span class="ansi-blue-fg">if</span> _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">elem</span><span class="ansi-yellow-fg">&#39;</span>, elem) &gt; <span class="ansi-blue-fg">2</span>])
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;call_test() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.ret(_data.call(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">just_x</span><span class="ansi-yellow-fg">&#39;</span>, just_x))(_data.arg(_data.ret(_data.call(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">just_x</span><span class="ansi-yellow-fg">&#39;</span>, just_x))(_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">d</span><span class="ansi-yellow-fg">&#39;</span>, d), pos=<span class="ansi-blue-fg">1</span>), y=_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">b</span><span class="ansi-yellow-fg">&#39;</span>, b), kw=<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#39;</span>))), pos=<span class="ansi-blue-fg">1</span>), _data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">ys</span><span class="ansi-yellow-fg">&#39;</span>, ys)[<span class="ansi-blue-fg">0</span>], pos=<span class="ansi-blue-fg">2</span>))))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:11: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;kw&#39;, value=ast.Str(kw)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, we capture the dependencies:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DependencyTrackerTester</span><span class="p">(</span><span class="n">DataTrackerTester</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">make_data_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DependencyTracker</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DependencyTracker</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DependencyTrackerTester</span><span class="p">(</span><span class="n">call_tree</span><span class="p">,</span> <span class="n">call_test</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">call_deps</span><span class="p">:</span>
    <span class="n">call_test</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see how</p>
<ul>
<li><code>a</code> flows into the generator <code>b</code> and into the parameter <code>e</code> of <code>gen()</code>.</li>
<li><code>xs</code> flows into <code>elem</code> which in turn flows into the parameter <code>n</code> of <code>sq()</code>. Both flow into <code>ys</code>.</li>
<li><code>just_x()</code> returns only its <code>x</code> argument.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_deps</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="496pt" height="808pt"
 viewBox="0.00 0.00 495.88 808.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 804)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-804 491.88,-804 491.88,4 -4,4"/>
<!-- b_functioncall_testat0x10899f740_14 -->
<g id="node1" class="node">
<title>b_functioncall_testat0x10899f740_14</title>
<g id="a_node1"><a xlink:title="call_test:14">
<polygon fill="peachpuff" stroke="black" points="130.25,-648 61.75,-648 61.75,-608 130.25,-608 130.25,-648"/>
<text text-anchor="start" x="91.88" y="-631.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">b</text>
<text text-anchor="start" x="69.75" y="-613.45" font-family="Courier,monospace" font-size="9.00">b = gen(a)</text>
</a>
</g>
</g>
<!-- d_functioncall_testat0x10899f740_15 -->
<g id="node6" class="node">
<title>d_functioncall_testat0x10899f740_15</title>
<g id="a_node6"><a xlink:title="call_test:15">
<polygon fill="peachpuff" stroke="black" points="190.75,-496 101.25,-496 101.25,-456 190.75,-456 190.75,-496"/>
<text text-anchor="start" x="141.88" y="-479.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">d</text>
<text text-anchor="start" x="109.25" y="-461.45" font-family="Courier,monospace" font-size="9.00">d = list(b)[0]</text>
</a>
</g>
</g>
<!-- b_functioncall_testat0x10899f740_14&#45;&gt;d_functioncall_testat0x10899f740_15 -->
<g id="edge10" class="edge">
<title>b_functioncall_testat0x10899f740_14&#45;&gt;d_functioncall_testat0x10899f740_15</title>
<path fill="none" stroke="black" d="M94.31,-607.54C97.42,-588.22 106.05,-557.83 115,-532 117.88,-523.69 121.29,-514.79 124.89,-506.63"/>
<polygon fill="black" stroke="black" points="127.96,-508.34 129.06,-497.8 121.63,-505.35 127.96,-508.34"/>
</g>
<!-- b_functioncall_testat0x10899f740_14&#45;&gt;d_functioncall_testat0x10899f740_15 -->
<!-- y_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="node7" class="node">
<title>y_functioncall_testlocalsjust_xat0x10899f600_11</title>
<g id="a_node7"><a xlink:title="just_x:11">
<polygon fill="peachpuff" stroke="black" points="94,-40 36,-40 36,0 94,0 94,-40"/>
<text text-anchor="start" x="60.88" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="44" y="-5.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- b_functioncall_testat0x10899f740_14&#45;&gt;y_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="edge5" class="edge">
<title>b_functioncall_testat0x10899f740_14&#45;&gt;y_functioncall_testlocalsjust_xat0x10899f600_11</title>
<path fill="none" stroke="black" d="M73.25,-607.7C44.86,-581.33 0,-531.11 0,-477 0,-477 0,-477 0,-171 0,-127.66 3.32,-115.11 22,-76 26.48,-66.62 32.78,-57.36 39.18,-49.18"/>
<polygon fill="black" stroke="black" points="41.74,-51.58 45.4,-41.63 36.34,-47.13 41.74,-51.58"/>
</g>
<!-- a_functioncall_testat0x10899f740_13 -->
<g id="node2" class="node">
<title>a_functioncall_testat0x10899f740_13</title>
<g id="a_node2"><a xlink:title="call_test:13">
<polygon fill="peachpuff" stroke="black" points="168,-724 114,-724 114,-684 168,-684 168,-724"/>
<text text-anchor="start" x="136.88" y="-707.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">a</text>
<text text-anchor="start" x="125.25" y="-689.45" font-family="Courier,monospace" font-size="9.00">a = 42</text>
</a>
</g>
</g>
<!-- a_functioncall_testat0x10899f740_13&#45;&gt;b_functioncall_testat0x10899f740_14 -->
<g id="edge1" class="edge">
<title>a_functioncall_testat0x10899f740_13&#45;&gt;b_functioncall_testat0x10899f740_14</title>
<path fill="none" stroke="black" d="M123.15,-683.56C117.76,-675.82 112.05,-666.76 107.18,-658.26"/>
<polygon fill="black" stroke="black" points="110.33,-656.73 102.46,-649.64 104.19,-660.09 110.33,-656.73"/>
</g>
<!-- a_functioncall_testat0x10899f740_13&#45;&gt;b_functioncall_testat0x10899f740_14 -->
<!-- e_functioncall_testlocalsgenat0x10899ed40_8 -->
<g id="node14" class="node">
<title>e_functioncall_testlocalsgenat0x10899ed40_8</title>
<g id="a_node14"><a xlink:title="gen:8">
<polygon fill="peachpuff" stroke="black" points="221.88,-648 148.12,-648 148.12,-608 221.88,-608 221.88,-648"/>
<text text-anchor="start" x="180.88" y="-631.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">e</text>
<text text-anchor="start" x="156.12" y="-613.45" font-family="Courier,monospace" font-size="9.00">yield e * c</text>
</a>
</g>
</g>
<!-- a_functioncall_testat0x10899f740_13&#45;&gt;e_functioncall_testlocalsgenat0x10899ed40_8 -->
<g id="edge16" class="edge">
<title>a_functioncall_testat0x10899f740_13&#45;&gt;e_functioncall_testlocalsgenat0x10899ed40_8</title>
<path fill="none" stroke="black" d="M152.56,-683.56C157.21,-675.74 162.67,-666.56 167.77,-657.98"/>
<polygon fill="black" stroke="black" points="170.64,-660 172.74,-649.61 164.62,-656.42 170.64,-660"/>
</g>
<!-- xs_functioncall_testat0x10899f740_17 -->
<g id="node3" class="node">
<title>xs_functioncall_testat0x10899f740_17</title>
<g id="a_node3"><a xlink:title="call_test:17">
<polygon fill="peachpuff" stroke="black" points="198.62,-420 93.38,-420 93.38,-380 198.62,-380 198.62,-420"/>
<text text-anchor="start" x="137.75" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">xs</text>
<text text-anchor="start" x="101.38" y="-385.45" font-family="Courier,monospace" font-size="9.00">xs = [1, 2, 3, 4]</text>
</a>
</g>
</g>
<!-- elem_functioncall_testat0x10899f740_18 -->
<g id="node10" class="node">
<title>elem_functioncall_testat0x10899f740_18</title>
<g id="a_node10"><a xlink:title="call_test:18">
<polygon fill="peachpuff" stroke="black" points="264.25,-344 27.75,-344 27.75,-304 264.25,-304 264.25,-344"/>
<text text-anchor="start" x="129.5" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">elem</text>
<text text-anchor="start" x="35.75" y="-309.45" font-family="Courier,monospace" font-size="9.00">ys = [sq(elem) for elem in xs if elem &gt; 2]</text>
</a>
</g>
</g>
<!-- xs_functioncall_testat0x10899f740_17&#45;&gt;elem_functioncall_testat0x10899f740_18 -->
<g id="edge9" class="edge">
<title>xs_functioncall_testat0x10899f740_17&#45;&gt;elem_functioncall_testat0x10899f740_18</title>
<path fill="none" stroke="black" d="M139.98,-379.56C139.32,-372.25 139.11,-363.75 139.34,-355.67"/>
<polygon fill="black" stroke="black" points="142.82,-356.01 139.9,-345.82 135.84,-355.61 142.82,-356.01"/>
</g>
<!-- xs_functioncall_testat0x10899f740_17&#45;&gt;elem_functioncall_testat0x10899f740_18 -->
<!-- just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="node4" class="node">
<title>just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11</title>
<g id="a_node4"><a xlink:title="just_x:11">
<polygon fill="peachpuff" stroke="black" points="487.88,-344 282.12,-344 282.12,-304 487.88,-304 487.88,-344"/>
<text text-anchor="start" x="290.12" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;just_x() return value&gt;</text>
<text text-anchor="start" x="364" y="-309.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- x_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="node5" class="node">
<title>x_functioncall_testlocalsjust_xat0x10899f600_11</title>
<g id="a_node5"><a xlink:title="just_x:11">
<polygon fill="peachpuff" stroke="black" points="414,-420 356,-420 356,-380 414,-380 414,-420"/>
<text text-anchor="start" x="380.88" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="364" y="-385.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11&#45;&gt;x_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="edge4" class="edge">
<title>just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11&#45;&gt;x_functioncall_testlocalsjust_xat0x10899f600_11</title>
<path fill="none" stroke="black" d="M391.01,-344.31C391.67,-351.61 391.89,-360.1 391.67,-368.19"/>
<polygon fill="black" stroke="black" points="388.18,-367.86 391.11,-378.05 395.17,-368.26 388.18,-367.86"/>
</g>
<!-- call_testreturnvalue_functioncall_testat0x10899f740_20 -->
<g id="node15" class="node">
<title>call_testreturnvalue_functioncall_testat0x10899f740_20</title>
<g id="a_node15"><a xlink:title="call_test:20">
<polygon fill="peachpuff" stroke="black" points="374.25,-40 143.75,-40 143.75,0 374.25,0 374.25,-40"/>
<text text-anchor="start" x="151.75" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;call_test() return value&gt;</text>
<text text-anchor="start" x="164.5" y="-5.45" font-family="Courier,monospace" font-size="9.00">return just_x(just_x(d, y=b), ys[0])</text>
</a>
</g>
</g>
<!-- just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11&#45;&gt;call_testreturnvalue_functioncall_testat0x10899f740_20 -->
<g id="edge17" class="edge">
<title>just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11&#45;&gt;call_testreturnvalue_functioncall_testat0x10899f740_20</title>
<path fill="none" stroke="black" d="M376.93,-303.65C355.5,-252.3 297.1,-112.31 271.41,-50.74"/>
<polygon fill="black" stroke="black" points="274.67,-49.47 267.59,-41.59 268.21,-52.16 274.67,-49.47"/>
</g>
<!-- x_functioncall_testlocalsjust_xat0x10899f600_11&#45;&gt;just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="edge2" class="edge">
<title>x_functioncall_testlocalsjust_xat0x10899f600_11&#45;&gt;just_xreturnvalue_functioncall_testlocalsjust_xat0x10899f600_11</title>
<path fill="none" stroke="black" d="M378.98,-379.56C378.32,-372.25 378.11,-363.75 378.34,-355.67"/>
<polygon fill="black" stroke="black" points="381.82,-356.01 378.9,-345.82 374.84,-355.61 381.82,-356.01"/>
</g>
<!-- d_functioncall_testat0x10899f740_15&#45;&gt;xs_functioncall_testat0x10899f740_17 -->
<!-- d_functioncall_testat0x10899f740_15&#45;&gt;x_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="edge3" class="edge">
<title>d_functioncall_testat0x10899f740_15&#45;&gt;x_functioncall_testlocalsjust_xat0x10899f600_11</title>
<path fill="none" stroke="black" d="M191.24,-460.99C235.58,-447.26 302.54,-426.53 345,-413.39"/>
<polygon fill="black" stroke="black" points="345.8,-416.8 354.31,-410.5 343.73,-410.12 345.8,-416.8"/>
</g>
<!-- ys_functioncall_testat0x10899f740_18 -->
<g id="node8" class="node">
<title>ys_functioncall_testat0x10899f740_18</title>
<g id="a_node8"><a xlink:title="call_test:18">
<polygon fill="peachpuff" stroke="black" points="267.25,-116 30.75,-116 30.75,-76 267.25,-76 267.25,-116"/>
<text text-anchor="start" x="140.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">ys</text>
<text text-anchor="start" x="38.75" y="-81.45" font-family="Courier,monospace" font-size="9.00">ys = [sq(elem) for elem in xs if elem &gt; 2]</text>
</a>
</g>
</g>
<!-- ys_functioncall_testat0x10899f740_18&#45;&gt;y_functioncall_testlocalsjust_xat0x10899f600_11 -->
<g id="edge6" class="edge">
<title>ys_functioncall_testat0x10899f740_18&#45;&gt;y_functioncall_testlocalsjust_xat0x10899f600_11</title>
<path fill="none" stroke="black" d="M126.93,-75.56C117.28,-67.06 105.81,-56.95 95.38,-47.76"/>
<polygon fill="black" stroke="black" points="97.88,-45.3 88.06,-41.31 93.25,-50.55 97.88,-45.3"/>
</g>
<!-- ys_functioncall_testat0x10899f740_18&#45;&gt;call_testreturnvalue_functioncall_testat0x10899f740_20 -->
<!-- sqreturnvalue_functioncall_testlocalssqat0x10899ee80_5 -->
<g id="node9" class="node">
<title>sqreturnvalue_functioncall_testlocalssqat0x10899ee80_5</title>
<g id="a_node9"><a xlink:title="sq:5">
<polygon fill="peachpuff" stroke="black" points="215.38,-192 42.62,-192 42.62,-152 215.38,-152 215.38,-192"/>
<text text-anchor="start" x="50.62" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;sq() return value&gt;</text>
<text text-anchor="start" x="97.5" y="-157.45" font-family="Courier,monospace" font-size="9.00">return n * n</text>
</a>
</g>
</g>
<!-- sqreturnvalue_functioncall_testlocalssqat0x10899ee80_5&#45;&gt;ys_functioncall_testat0x10899f740_18 -->
<g id="edge7" class="edge">
<title>sqreturnvalue_functioncall_testlocalssqat0x10899ee80_5&#45;&gt;ys_functioncall_testat0x10899f740_18</title>
<path fill="none" stroke="black" d="M134.25,-151.56C136.25,-144.16 138.58,-135.55 140.79,-127.39"/>
<polygon fill="black" stroke="black" points="144.16,-128.34 143.39,-117.77 137.4,-126.51 144.16,-128.34"/>
</g>
<!-- elem_functioncall_testat0x10899f740_18&#45;&gt;ys_functioncall_testat0x10899f740_18 -->
<g id="edge8" class="edge">
<title>elem_functioncall_testat0x10899f740_18&#45;&gt;ys_functioncall_testat0x10899f740_18</title>
<path fill="none" stroke="black" d="M162.65,-303.83C182.29,-279.7 213.6,-236.05 224,-192 228.08,-174.7 232.04,-167.86 224,-152 218.13,-140.41 208.54,-130.68 198.16,-122.78"/>
<polygon fill="black" stroke="black" points="200.34,-120.03 190.14,-117.17 196.33,-125.77 200.34,-120.03"/>
</g>
<!-- n_functioncall_testlocalssqat0x10899ee80_5 -->
<g id="node12" class="node">
<title>n_functioncall_testlocalssqat0x10899ee80_5</title>
<g id="a_node12"><a xlink:title="sq:5">
<polygon fill="peachpuff" stroke="black" points="176.5,-268 97.5,-268 97.5,-228 176.5,-228 176.5,-268"/>
<text text-anchor="start" x="132.88" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">n</text>
<text text-anchor="start" x="105.5" y="-233.45" font-family="Courier,monospace" font-size="9.00">return n * n</text>
</a>
</g>
</g>
<!-- elem_functioncall_testat0x10899f740_18&#45;&gt;n_functioncall_testlocalssqat0x10899ee80_5 -->
<g id="edge12" class="edge">
<title>elem_functioncall_testat0x10899f740_18&#45;&gt;n_functioncall_testlocalssqat0x10899ee80_5</title>
<path fill="none" stroke="black" d="M143.64,-303.56C142.75,-296.25 141.71,-287.75 140.73,-279.67"/>
<polygon fill="black" stroke="black" points="144.21,-279.32 139.53,-269.82 137.26,-280.16 144.21,-279.32"/>
</g>
<!-- genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8 -->
<g id="node11" class="node">
<title>genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8</title>
<g id="a_node11"><a xlink:title="gen:8">
<polygon fill="peachpuff" stroke="black" points="305.38,-572 132.62,-572 132.62,-532 305.38,-532 305.38,-572"/>
<text text-anchor="start" x="140.62" y="-555.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;gen() yield value&gt;</text>
<text text-anchor="start" x="190.12" y="-537.45" font-family="Courier,monospace" font-size="9.00">yield e * c</text>
</a>
</g>
</g>
<!-- genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8&#45;&gt;d_functioncall_testat0x10899f740_15 -->
<g id="edge11" class="edge">
<title>genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8&#45;&gt;d_functioncall_testat0x10899f740_15</title>
<path fill="none" stroke="black" d="M199.82,-531.56C191.61,-523.23 181.87,-513.36 172.95,-504.32"/>
<polygon fill="black" stroke="black" points="175.63,-502.05 166.11,-497.39 170.65,-506.97 175.63,-502.05"/>
</g>
<!-- n_functioncall_testlocalssqat0x10899ee80_5&#45;&gt;sqreturnvalue_functioncall_testlocalssqat0x10899ee80_5 -->
<g id="edge13" class="edge">
<title>n_functioncall_testlocalssqat0x10899ee80_5&#45;&gt;sqreturnvalue_functioncall_testlocalssqat0x10899ee80_5</title>
<path fill="none" stroke="black" d="M134.9,-227.56C134.11,-220.25 133.19,-211.75 132.32,-203.67"/>
<polygon fill="black" stroke="black" points="135.81,-203.38 131.25,-193.82 128.85,-204.14 135.81,-203.38"/>
</g>
<!-- c_functioncall_testat0x10899f740_2 -->
<g id="node13" class="node">
<title>c_functioncall_testat0x10899f740_2</title>
<g id="a_node13"><a xlink:title="call_test:2">
<polygon fill="peachpuff" stroke="black" points="200,-800 146,-800 146,-760 200,-760 200,-800"/>
<text text-anchor="start" x="168.88" y="-783.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">c</text>
<text text-anchor="start" x="157.25" y="-765.45" font-family="Courier,monospace" font-size="9.00">c = 47</text>
</a>
</g>
</g>
<!-- c_functioncall_testat0x10899f740_2&#45;&gt;a_functioncall_testat0x10899f740_13 -->
<!-- c_functioncall_testat0x10899f740_2&#45;&gt;genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8 -->
<g id="edge14" class="edge">
<title>c_functioncall_testat0x10899f740_2&#45;&gt;genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8</title>
<path fill="none" stroke="black" d="M184.53,-759.89C198.74,-735.12 222.1,-690.1 231,-648 235.51,-626.69 232.26,-602.3 228.01,-583.57"/>
<polygon fill="black" stroke="black" points="231.41,-582.76 225.59,-573.91 224.62,-584.46 231.41,-582.76"/>
</g>
<!-- e_functioncall_testlocalsgenat0x10899ed40_8&#45;&gt;genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8 -->
<g id="edge15" class="edge">
<title>e_functioncall_testlocalsgenat0x10899ed40_8&#45;&gt;genyieldvalue_functioncall_testlocalsgenat0x10899ed40_8</title>
<path fill="none" stroke="black" d="M193.93,-607.56C197.45,-599.91 201.56,-590.96 205.43,-582.55"/>
<polygon fill="black" stroke="black" points="208.5,-584.24 209.49,-573.69 202.14,-581.31 208.5,-584.24"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>code()</code> view lists each function separately:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_deps</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">code</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>     1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">call_test</span>() -&gt; <span class="ansi-cyan-fg">int</span>:
*    2     c = <span class="ansi-blue-fg">47</span>
     3 
     4     <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">sq</span>(n: <span class="ansi-cyan-fg">int</span>) -&gt; <span class="ansi-cyan-fg">int</span>:
     5         <span class="ansi-blue-fg">return</span> n * n
     6 
     7     <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">gen</span>(e: <span class="ansi-cyan-fg">int</span>) -&gt; Generator[<span class="ansi-cyan-fg">int</span>, <span class="ansi-blue-fg">None</span>, <span class="ansi-blue-fg">None</span>]:
     8         <span class="ansi-blue-fg">yield</span> e * c
     9 
    10     <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">just_x</span>(x: Any, y: Any) -&gt; Any:
    11         <span class="ansi-blue-fg">return</span> x
    12 
*   13     a = <span class="ansi-blue-fg">42</span>
*   14     b = gen(a)  <span class="ansi-white-fg"># &lt;= a (13)</span>
*   15     d = <span class="ansi-cyan-fg">list</span>(b)[<span class="ansi-blue-fg">0</span>]  <span class="ansi-white-fg"># &lt;= b (14), &lt;gen() yield value&gt; (gen:8)</span>
    16 
*   17     xs = [<span class="ansi-blue-fg">1</span>, <span class="ansi-blue-fg">2</span>, <span class="ansi-blue-fg">3</span>, <span class="ansi-blue-fg">4</span>]
*   18     ys = [sq(elem) <span class="ansi-blue-fg">for</span> elem <span class="ansi-magenta-fg">in</span> xs <span class="ansi-blue-fg">if</span> elem &gt; <span class="ansi-blue-fg">2</span>]  <span class="ansi-white-fg"># &lt;= xs (17), &lt;sq() return value&gt; (sq:5), elem (18)</span>
    19 
*   20     <span class="ansi-blue-fg">return</span> just_x(just_x(d, y=b), ys[<span class="ansi-blue-fg">0</span>])  <span class="ansi-white-fg"># &lt;= &lt;just_x() return value&gt; (just_x:11)</span>

    10     <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">just_x</span>(x: Any, y: Any) -&gt; Any:
*   11         <span class="ansi-blue-fg">return</span> x  <span class="ansi-white-fg"># &lt;= d (call_test:15), &lt;just_x() return value&gt; (11), b (call_test:14), ys (call_test:18), x (11)</span>

     4     <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">sq</span>(n: <span class="ansi-cyan-fg">int</span>) -&gt; <span class="ansi-cyan-fg">int</span>:
*    5         <span class="ansi-blue-fg">return</span> n * n  <span class="ansi-white-fg"># &lt;= elem (call_test:18), n (5)</span>

     7     <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">gen</span>(e: <span class="ansi-cyan-fg">int</span>) -&gt; Generator[<span class="ansi-cyan-fg">int</span>, <span class="ansi-blue-fg">None</span>, <span class="ansi-blue-fg">None</span>]:
*    8         <span class="ansi-blue-fg">yield</span> e * c  <span class="ansi-white-fg"># &lt;= a (call_test:13), c (call_test:2), e (8)</span>
</pre>
</div>

</div>

</details>

<details id="Excursion:-Diagnostics">
<summary>Diagnostics</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To check the dependencies we obtain, we perform some minimal checks on whether a referenced variable actually also occurs in the source code.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/re.html" class="import" target="_blank">re</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>validate()</code> is automatically called whenever dependencies are output, so if you see any of its error messages, something may be wrong.</p>
</div>
</div>
</div>
</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>At this point, <code>DependencyTracker</code> is complete; we have all in place to track even complex dependencies in instrumented code.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Slicing-Code">Slicing Code<a class="anchor-link" href="#Slicing-Code">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us now put all these pieces together. We have a means to instrument the source code (our various <code>NodeTransformer</code> classes) and a means to track dependencies (the <code>DependencyTracker</code> class). Now comes the time to put all these things together in a single tool, which we call <code>Slicer</code>.</p>
<p>The basic idea of <code>Slicer</code> is that you can use it as follows:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">func_1</span><span class="p">,</span> <span class="n">func_2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">func</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
<p>which first <em>instruments</em> the functions given in the constructor (i.e., replaces their definitions with instrumented counterparts), and then runs the code in the body, calling instrumented functions, and allowing the slicer to collect dependencies. When the body returns, the original definition of the instrumented functions is restored.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="An-Instrumenter-Base-Class">An Instrumenter Base Class<a class="anchor-link" href="#An-Instrumenter-Base-Class">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The basic functionality of instrumenting a number of functions (and restoring them at the end of the <code>with</code> block) comes in a <code>Instrumenter</code> base class. It invokes <code>instrument()</code> on all items to instrument; this is to be overloaded in subclasses.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Instrumenter</span><span class="p">(</span><span class="n">StackInspector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instrument functions for dynamic tracking&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">items_to_instrument</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                 <span class="nb">globals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">log</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instrumenter.</span>
<span class="sd">        `items_to_instrument` is a list of items to instrument.</span>
<span class="sd">        `globals` is a namespace to use (default: caller&#39;s globals())</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items_to_instrument</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">items_to_instrument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumented_items</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">globals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">globals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_globals</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">globals</span> <span class="o">=</span> <span class="nb">globals</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instrument sources&quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items_to_instrument</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_items_to_instrument</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instrument</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">default_items_to_instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instrument `item`. To be overloaded in subclasses.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Instrumenting&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumented_items</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>At the end of the <code>with</code> block, we restore the given functions.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Instrumenter</span><span class="p">(</span><span class="n">Instrumenter</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span>
                 <span class="n">traceback</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore sources&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">restore</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumented_items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>By default, an <code>Instrumenter</code> simply outputs a log message:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Instrumenter</span><span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">ins</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Instrumenting &lt;function middle at 0x10700d120&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="The-Slicer-Class">The Slicer Class<a class="anchor-link" href="#The-Slicer-Class">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>Slicer</code> class comes as a subclass of <code>Instrumenter</code>. It sets its own dependency tracker (which can be overwritten by setting the <code>dependency_tracker</code> keyword argument).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Instrumenter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Track dependencies in an execution&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">items_to_instrument</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                 <span class="n">dependency_tracker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DependencyTracker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="nb">globals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">log</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a slicer.</span>
<span class="sd">        `items_to_instrument` are Python functions or modules with source code.</span>
<span class="sd">        `dependency_tracker` is the tracker to be used (default: DependencyTracker).</span>
<span class="sd">        `globals` is the namespace to be used(default: caller&#39;s `globals()`)</span>
<span class="sd">        `log`=True or `log` &gt; 0 turns on logging</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">items_to_instrument</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dependency_tracker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dependency_tracker</span> <span class="o">=</span> <span class="n">DependencyTracker</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="p">(</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dependency_tracker</span> <span class="o">=</span> <span class="n">dependency_tracker</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">saved_dependencies</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">default_items_to_instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need one or more items to instrument&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>parse()</code> method parses a given item, returning its AST.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse `item`, returning its AST&quot;&quot;&quot;</span>
        <span class="n">source_lines</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_lines</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">print_content</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">,</span> <span class="n">start_line_number</span><span class="o">=</span><span class="n">lineno</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">increment_lineno</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>transform()</code> method applies the list of transformers defined earlier in this chapter.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">transformers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">NodeTransformer</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of transformers to apply. To be extended in subclasses.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">TrackCallTransformer</span><span class="p">(),</span>
            <span class="n">TrackSetTransformer</span><span class="p">(),</span>
            <span class="n">TrackGetTransformer</span><span class="p">(),</span>
            <span class="n">TrackControlTransformer</span><span class="p">(),</span>
            <span class="n">TrackReturnTransformer</span><span class="p">(),</span>
            <span class="n">TrackParamsTransformer</span><span class="p">()</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply transformers on `tree`. May be extended in subclasses.&quot;&quot;&quot;</span>
        <span class="c1"># Apply transformers</span>
        <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">transformer</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>

            <span class="n">transformer</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="n">ast</span><span class="o">.</span><span class="n">fix_missing_locations</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">()</span>

        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>execute()</code> method executes the transformed tree (such that we get the new definitions). We also make the dependency tracker available for the code in the <code>with</code> block.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compile and execute `tree`. May be extended in subclasses.&quot;&quot;&quot;</span>

        <span class="c1"># We pass the source file of `item` such that we can retrieve it</span>
        <span class="c1"># when accessing the location of the new compiled code</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcefile</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="n">code</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">tree</span><span class="p">),</span> <span class="n">source</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>

        <span class="c1"># Enable dependency tracker</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">[</span><span class="n">DATA_TRACKER</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependency_tracker</span>

        <span class="c1"># Execute the code, resulting in a redefinition of item</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>instrument()</code> method puts all these together, first parsing the item into a tree, then transforming and executing the tree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instrument `item`, transforming its source code, and re-defining it.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_internal</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="vm">__name__</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span>  <span class="c1"># Do not instrument `print()` and the like</span>

        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isbuiltin</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span>  <span class="c1"># No source code</span>

        <span class="n">item</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">instrument</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="n">new_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_item</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When we restore the original definition (after the <code>with</code> block), we save the dependency tracker again.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">restore</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore original code.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">DATA_TRACKER</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saved_dependencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">[</span><span class="n">DATA_TRACKER</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">globals</span><span class="p">[</span><span class="n">DATA_TRACKER</span><span class="p">]</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Three convenience functions allow us to see the dependencies as (well) dependencies, as code, and as graph. These simply invoke the respective functions on the saved dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dependencies</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return collected dependencies.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saved_dependencies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Dependencies</span><span class="p">({},</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saved_dependencies</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show code of instrumented items, annotated with dependencies.&quot;&quot;&quot;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumented_items</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">code</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Digraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show dependency graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_repr_mimebundle_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If the object is output in Jupyter, render dependencies as a SVG graph&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span><span class="o">.</span><span class="n">_repr_mimebundle_</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us put <code>Slicer</code> into action. We track our <code>middle()</code> function:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">middle</span><span class="p">)</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">middle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>These are the dependencies in string form (used when printed):</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>middle():
    &lt;test&gt; (2) &lt;= z (12), y (12)
    &lt;test&gt; (3) &lt;= y (12), x (12); &lt;- &lt;test&gt; (2)
    &lt;test&gt; (5) &lt;= z (12), x (12); &lt;- &lt;test&gt; (3)
    &lt;middle() return value&gt; (6) &lt;= y (12); &lt;- &lt;test&gt; (5)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the code form:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slicer</span><span class="o">.</span><span class="n">code</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>     1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">middle</span>(x, y, z):  <span class="ansi-white-fg"># type: ignore</span>
*    2     <span class="ansi-blue-fg">if</span> y &lt; z:  <span class="ansi-white-fg"># &lt;= z (12), y (12)</span>
*    3         <span class="ansi-blue-fg">if</span> x &lt; y:  <span class="ansi-white-fg"># &lt;= y (12), x (12); &lt;- &lt;test&gt; (2)</span>
     4             <span class="ansi-blue-fg">return</span> y
*    5         <span class="ansi-blue-fg">elif</span> x &lt; z:  <span class="ansi-white-fg"># &lt;= z (12), x (12); &lt;- &lt;test&gt; (3)</span>
*    6             <span class="ansi-blue-fg">return</span> y  <span class="ansi-white-fg"># &lt;= y (12); &lt;- &lt;test&gt; (5)</span>
     7     <span class="ansi-blue-fg">else</span>:
     8         <span class="ansi-blue-fg">if</span> x &gt; y:
     9             <span class="ansi-blue-fg">return</span> y
    10         <span class="ansi-blue-fg">elif</span> x &gt; z:
    11             <span class="ansi-blue-fg">return</span> x
*   12     <span class="ansi-blue-fg">return</span> z
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And this is the graph form:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slicer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="278pt" height="428pt"
 viewBox="0.00 0.00 278.05 428.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 424)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-424 274.05,-424 274.05,4 -4,4"/>
<!-- z_functionmiddleat0x10913e200_12 -->
<g id="node1" class="node">
<title>z_functionmiddleat0x10913e200_12</title>
<g id="a_node1"><a xlink:title="middle:12">
<polygon fill="peachpuff" stroke="black" points="157,-420 99,-420 99,-380 157,-380 157,-420"/>
<text text-anchor="start" x="123.88" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">z</text>
<text text-anchor="start" x="107" y="-385.45" font-family="Courier,monospace" font-size="9.00">return z</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10913e200_2 -->
<g id="node5" class="node">
<title>test_functionmiddleat0x10913e200_2</title>
<g id="a_node5"><a xlink:title="middle:2">
<polygon fill="peachpuff" stroke="black" points="122.75,-344 57.25,-344 57.25,-304 122.75,-304 122.75,-344"/>
<text text-anchor="start" x="65.25" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="66.38" y="-309.45" font-family="Courier,monospace" font-size="9.00">if y &lt; z:</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_2 -->
<g id="edge9" class="edge">
<title>z_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_2</title>
<path fill="none" stroke="black" d="M118.02,-379.56C114.09,-371.91 109.49,-362.96 105.17,-354.55"/>
<polygon fill="black" stroke="black" points="108.29,-352.96 100.61,-345.66 102.06,-356.15 108.29,-352.96"/>
</g>
<!-- test_functionmiddleat0x10913e200_5 -->
<g id="node7" class="node">
<title>test_functionmiddleat0x10913e200_5</title>
<g id="a_node7"><a xlink:title="middle:5">
<polygon fill="peachpuff" stroke="black" points="187.88,-192 114.12,-192 114.12,-152 187.88,-152 187.88,-192"/>
<text text-anchor="start" x="126.25" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="122.12" y="-157.45" font-family="Courier,monospace" font-size="9.00">elif x &lt; z:</text>
</a>
</g>
</g>
<!-- z_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_5 -->
<g id="edge6" class="edge">
<title>z_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_5</title>
<path fill="none" stroke="black" d="M129.96,-379.73C133.96,-340.45 143.08,-250.85 147.89,-203.55"/>
<polygon fill="black" stroke="black" points="151.36,-204.03 148.89,-193.73 144.4,-203.32 151.36,-204.03"/>
</g>
<!-- test_functionmiddleat0x10913e200_3 -->
<g id="node2" class="node">
<title>test_functionmiddleat0x10913e200_3</title>
<g id="a_node2"><a xlink:title="middle:3">
<polygon fill="peachpuff" stroke="black" points="122.75,-268 57.25,-268 57.25,-228 122.75,-228 122.75,-268"/>
<text text-anchor="start" x="65.25" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="66.38" y="-233.45" font-family="Courier,monospace" font-size="9.00">if x &lt; y:</text>
</a>
</g>
</g>
<!-- test_functionmiddleat0x10913e200_3&#45;&gt;test_functionmiddleat0x10913e200_5 -->
<g id="edge8" class="edge">
<title>test_functionmiddleat0x10913e200_3&#45;&gt;test_functionmiddleat0x10913e200_5</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M100,-227.56C106,-219.4 113.76,-209.76 121.46,-200.87"/>
<polygon fill="grey" stroke="grey" points="124.04,-203.24 128.06,-193.44 118.8,-198.59 124.04,-203.24"/>
</g>
<!-- test_functionmiddleat0x10913e200_3&#45;&gt;test_functionmiddleat0x10913e200_5 -->
<!-- y_functionmiddleat0x10913e200_12 -->
<g id="node3" class="node">
<title>y_functionmiddleat0x10913e200_12</title>
<g id="a_node3"><a xlink:title="middle:12">
<polygon fill="peachpuff" stroke="black" points="58,-420 0,-420 0,-380 58,-380 58,-420"/>
<text text-anchor="start" x="24.88" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="8" y="-385.45" font-family="Courier,monospace" font-size="9.00">return z</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_3 -->
<g id="edge1" class="edge">
<title>y_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_3</title>
<path fill="none" stroke="black" d="M30.3,-379.66C32.2,-359.89 36.84,-328.67 48,-304 52.25,-294.61 58.36,-285.35 64.61,-277.17"/>
<polygon fill="black" stroke="black" points="67.14,-279.62 70.69,-269.63 61.69,-275.22 67.14,-279.62"/>
</g>
<!-- y_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_2 -->
<g id="edge10" class="edge">
<title>y_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_2</title>
<path fill="none" stroke="black" d="M45.03,-379.56C51.68,-371.48 59.53,-361.96 66.8,-353.15"/>
<polygon fill="black" stroke="black" points="69.46,-355.42 73.12,-345.48 64.06,-350.97 69.46,-355.42"/>
</g>
<!-- middlereturnvalue_functionmiddleat0x10913e200_6 -->
<g id="node6" class="node">
<title>middlereturnvalue_functionmiddleat0x10913e200_6</title>
<g id="a_node6"><a xlink:title="middle:6">
<polygon fill="peachpuff" stroke="black" points="253.88,-116 48.12,-116 48.12,-76 253.88,-76 253.88,-116"/>
<text text-anchor="start" x="56.12" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;middle() return value&gt;</text>
<text text-anchor="start" x="130" y="-81.45" font-family="Courier,monospace" font-size="9.00">return y</text>
</a>
</g>
</g>
<!-- y_functionmiddleat0x10913e200_12&#45;&gt;middlereturnvalue_functionmiddleat0x10913e200_6 -->
<g id="edge4" class="edge">
<title>y_functionmiddleat0x10913e200_12&#45;&gt;middlereturnvalue_functionmiddleat0x10913e200_6</title>
<path fill="none" stroke="black" d="M27.37,-379.52C25.43,-346.67 24.94,-278.88 48,-228 66.16,-187.93 99.09,-149.24 122.83,-124.43"/>
<polygon fill="black" stroke="black" points="125.28,-126.94 129.75,-117.34 120.27,-122.05 125.28,-126.94"/>
</g>
<!-- x_functionmiddleat0x10913e200_12 -->
<g id="node4" class="node">
<title>x_functionmiddleat0x10913e200_12</title>
<g id="a_node4"><a xlink:title="middle:12">
<polygon fill="peachpuff" stroke="black" points="180,-40 122,-40 122,0 180,0 180,-40"/>
<text text-anchor="start" x="146.88" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="130" y="-5.45" font-family="Courier,monospace" font-size="9.00">return z</text>
</a>
</g>
</g>
<!-- x_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_3 -->
<g id="edge2" class="edge">
<title>x_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_3</title>
<path fill="none" stroke="black" d="M121.52,-26.43C94.79,-33.08 56.93,-47.23 39,-76 10.85,-121.19 43.47,-182.76 67.96,-218.36"/>
<polygon fill="black" stroke="black" points="65.07,-220.33 73.72,-226.44 70.77,-216.27 65.07,-220.33"/>
</g>
<!-- x_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_5 -->
<g id="edge7" class="edge">
<title>x_functionmiddleat0x10913e200_12&#45;&gt;test_functionmiddleat0x10913e200_5</title>
<path fill="none" stroke="black" d="M180.48,-26.43C207.21,-33.08 245.07,-47.23 263,-76 272.4,-91.09 272.4,-100.91 263,-116 248.96,-138.54 222.68,-152.1 199.11,-160.12"/>
<polygon fill="black" stroke="black" points="198.13,-156.76 189.62,-163.08 200.21,-163.45 198.13,-156.76"/>
</g>
<!-- test_functionmiddleat0x10913e200_2&#45;&gt;test_functionmiddleat0x10913e200_3 -->
<g id="edge3" class="edge">
<title>test_functionmiddleat0x10913e200_2&#45;&gt;test_functionmiddleat0x10913e200_3</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M83.98,-303.56C83.32,-296.25 83.11,-287.75 83.34,-279.67"/>
<polygon fill="grey" stroke="grey" points="86.82,-280.01 83.9,-269.82 79.84,-279.61 86.82,-280.01"/>
</g>
<!-- test_functionmiddleat0x10913e200_2&#45;&gt;test_functionmiddleat0x10913e200_3 -->
<!-- middlereturnvalue_functionmiddleat0x10913e200_6&#45;&gt;x_functionmiddleat0x10913e200_12 -->
<!-- test_functionmiddleat0x10913e200_5&#45;&gt;middlereturnvalue_functionmiddleat0x10913e200_6 -->
<g id="edge5" class="edge">
<title>test_functionmiddleat0x10913e200_5&#45;&gt;middlereturnvalue_functionmiddleat0x10913e200_6</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M144.98,-151.56C144.32,-144.25 144.11,-135.75 144.34,-127.67"/>
<polygon fill="grey" stroke="grey" points="147.82,-128.01 144.9,-117.82 140.84,-127.61 147.82,-128.01"/>
</g>
<!-- test_functionmiddleat0x10913e200_5&#45;&gt;middlereturnvalue_functionmiddleat0x10913e200_6 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>You can also access the raw <code>repr()</code> form, which allows you to reconstruct dependencies at any time. (This is how we showed off dependencies at the beginning of this chapter, before even introducing the code that computes them.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dependencies(
    data={
        (&#39;x&#39;, (middle, 12)): set(),
        (&#39;y&#39;, (middle, 12)): set(),
        (&#39;z&#39;, (middle, 12)): set(),
        (&#39;&lt;test&gt;&#39;, (middle, 2)): {(&#39;z&#39;, (middle, 12)), (&#39;y&#39;, (middle, 12))},
        (&#39;&lt;test&gt;&#39;, (middle, 3)): {(&#39;y&#39;, (middle, 12)), (&#39;x&#39;, (middle, 12))},
        (&#39;&lt;test&gt;&#39;, (middle, 5)): {(&#39;z&#39;, (middle, 12)), (&#39;x&#39;, (middle, 12))},
        (&#39;&lt;middle() return value&gt;&#39;, (middle, 6)): {(&#39;y&#39;, (middle, 12))}},
 control={
        (&#39;x&#39;, (middle, 12)): set(),
        (&#39;y&#39;, (middle, 12)): set(),
        (&#39;z&#39;, (middle, 12)): set(),
        (&#39;&lt;test&gt;&#39;, (middle, 2)): set(),
        (&#39;&lt;test&gt;&#39;, (middle, 3)): {(&#39;&lt;test&gt;&#39;, (middle, 2))},
        (&#39;&lt;test&gt;&#39;, (middle, 5)): {(&#39;&lt;test&gt;&#39;, (middle, 3))},
        (&#39;&lt;middle() return value&gt;&#39;, (middle, 6)): {(&#39;&lt;test&gt;&#39;, (middle, 5))}})
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Diagnostics">Diagnostics<a class="anchor-link" href="#Diagnostics">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>Slicer</code> constructor accepts a <code>log</code> argument (default: False), which can be set to show various intermediate results:</p>
<ul>
<li><code>log=True</code> (or <code>log=1</code>): Show instrumented source code</li>
<li><code>log=2</code>: Also log execution</li>
<li><code>log=3</code>: Also log individual transformer steps</li>
<li><code>log=4</code>: Also log source line numbers</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="More-Examples">More Examples<a class="anchor-link" href="#More-Examples">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us demonstrate our <code>Slicer</code> class on a few more examples.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Square-Root">Square Root<a class="anchor-link" href="#Square-Root">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>square_root()</code> function from <a href="Assertions.html">the chapter on assertions</a> demonstrates a nice interplay between data and control dependencies.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/math.html" class="import" target="_blank">math</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Assertions.html" class="import" target="_blank">Assertions</a></span> <span class="kn">import</span> <span class="n">square_root</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is the original source code:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">square_root</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">square_root</span>(x):  <span class="ansi-white-fg"># type: ignore</span>
    <span class="ansi-blue-fg">assert</span> x &gt;= <span class="ansi-blue-fg">0</span>  <span class="ansi-white-fg"># precondition</span>

    approx = <span class="ansi-blue-fg">None</span>
    guess = x / <span class="ansi-blue-fg">2</span>
    <span class="ansi-blue-fg">while</span> approx != guess:
        approx = guess
        guess = (approx + x / approx) / <span class="ansi-blue-fg">2</span>

    <span class="ansi-blue-fg">assert</span> math.isclose(approx * approx, x)
    <span class="ansi-blue-fg">return</span> approx
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Turning on logging shows the instrumented version:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">square_root</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">root_slicer</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">square_root</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Instrumenting &lt;function square_root at 0x108876c00&gt;
<span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">square_root</span>(x):
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>, last=<span class="ansi-blue-fg">True</span>)
    <span class="ansi-blue-fg">assert</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;assertion&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) &gt;= <span class="ansi-blue-fg">0</span>, loads=(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x),))
    approx = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-blue-fg">None</span>)
    guess = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">guess</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) / <span class="ansi-blue-fg">2</span>)
    <span class="ansi-blue-fg">while</span> _data.test(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx) != _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">guess</span><span class="ansi-yellow-fg">&#39;</span>, guess)):
        <span class="ansi-blue-fg">with</span> _data:
            approx = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">guess</span><span class="ansi-yellow-fg">&#39;</span>, guess))
            guess = _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">guess</span><span class="ansi-yellow-fg">&#39;</span>, (_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx) + _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x) / _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx)) / <span class="ansi-blue-fg">2</span>)
    <span class="ansi-blue-fg">assert</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;assertion&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.ret(_data.call(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">math</span><span class="ansi-yellow-fg">&#39;</span>, math).isclose)(_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx) * _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx), pos=<span class="ansi-blue-fg">1</span>), _data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x), pos=<span class="ansi-blue-fg">2</span>))), loads=(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">math</span><span class="ansi-yellow-fg">&#39;</span>, math), _data, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x), _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx)))
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;square_root() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">approx</span><span class="ansi-yellow-fg">&#39;</span>, approx))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The dependency graph shows how <code>guess</code> and <code>approx</code> flow into each other until they are the same.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">root_slicer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="326pt" height="656pt"
 viewBox="0.00 0.00 326.12 656.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 652)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-652 322.12,-652 322.12,4 -4,4"/>
<!-- approx_functionsquare_rootat0x10913ed40_57 -->
<g id="node1" class="node">
<title>approx_functionsquare_rootat0x10913ed40_57</title>
<g id="a_node1"><a xlink:title="square_root:57">
<polygon fill="peachpuff" stroke="black" points="200.62,-496 116.38,-496 116.38,-456 200.62,-456 200.62,-496"/>
<text text-anchor="start" x="133.75" y="-479.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">approx</text>
<text text-anchor="start" x="124.38" y="-461.45" font-family="Courier,monospace" font-size="9.00">approx = None</text>
</a>
</g>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_58 -->
<g id="node2" class="node">
<title>guess_functionsquare_rootat0x10913ed40_58</title>
<g id="a_node2"><a xlink:title="square_root:58">
<polygon fill="peachpuff" stroke="black" points="130.62,-420 46.38,-420 46.38,-380 130.62,-380 130.62,-420"/>
<text text-anchor="start" x="67.88" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">guess</text>
<text text-anchor="start" x="54.38" y="-385.45" font-family="Courier,monospace" font-size="9.00">guess = x / 2</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_57&#45;&gt;guess_functionsquare_rootat0x10913ed40_58 -->
<!-- test_functionsquare_rootat0x10913ed40_59 -->
<g id="node4" class="node">
<title>test_functionsquare_rootat0x10913ed40_59</title>
<g id="a_node4"><a xlink:title="square_root:59">
<polygon fill="peachpuff" stroke="black" points="215.25,-344 83.75,-344 83.75,-304 215.25,-304 215.25,-344"/>
<text text-anchor="start" x="124.75" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="91.75" y="-309.45" font-family="Courier,monospace" font-size="9.00">while approx != guess:</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_57&#45;&gt;test_functionsquare_rootat0x10913ed40_59 -->
<g id="edge2" class="edge">
<title>approx_functionsquare_rootat0x10913ed40_57&#45;&gt;test_functionsquare_rootat0x10913ed40_59</title>
<path fill="none" stroke="black" d="M157.34,-455.7C155.82,-430.38 153.14,-385.68 151.34,-355.69"/>
<polygon fill="black" stroke="black" points="154.84,-355.51 150.74,-345.74 147.85,-355.93 154.84,-355.51"/>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_58&#45;&gt;test_functionsquare_rootat0x10913ed40_59 -->
<g id="edge5" class="edge">
<title>guess_functionsquare_rootat0x10913ed40_58&#45;&gt;test_functionsquare_rootat0x10913ed40_59</title>
<path fill="none" stroke="black" d="M98.5,-379.56C104.5,-371.4 112.26,-361.76 119.96,-352.87"/>
<polygon fill="black" stroke="black" points="122.54,-355.24 126.56,-345.44 117.3,-350.59 122.54,-355.24"/>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_58&#45;&gt;test_functionsquare_rootat0x10913ed40_59 -->
<!-- approx_functionsquare_rootat0x10913ed40_60 -->
<g id="node5" class="node">
<title>approx_functionsquare_rootat0x10913ed40_60</title>
<g id="a_node5"><a xlink:title="square_root:60">
<polygon fill="peachpuff" stroke="black" points="186.25,-268 96.75,-268 96.75,-228 186.25,-228 186.25,-268"/>
<text text-anchor="start" x="116.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">approx</text>
<text text-anchor="start" x="104.75" y="-233.45" font-family="Courier,monospace" font-size="9.00">approx = guess</text>
</a>
</g>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_58&#45;&gt;approx_functionsquare_rootat0x10913ed40_60 -->
<g id="edge8" class="edge">
<title>guess_functionsquare_rootat0x10913ed40_58&#45;&gt;approx_functionsquare_rootat0x10913ed40_60</title>
<path fill="none" stroke="black" d="M79.55,-379.86C71.63,-359.97 62.95,-328.42 74.5,-304 79.77,-292.85 88.53,-283.21 98,-275.25"/>
<polygon fill="black" stroke="black" points="99.87,-278.23 105.63,-269.34 95.58,-272.7 99.87,-278.23"/>
</g>
<!-- x_functionsquare_rootat0x10913ed40_64 -->
<g id="node3" class="node">
<title>x_functionsquare_rootat0x10913ed40_64</title>
<g id="a_node3"><a xlink:title="square_root:64">
<polygon fill="peachpuff" stroke="black" points="148.62,-648 64.38,-648 64.38,-608 148.62,-608 148.62,-648"/>
<text text-anchor="start" x="102.38" y="-631.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="72.38" y="-613.45" font-family="Courier,monospace" font-size="9.00">return approx</text>
</a>
</g>
</g>
<!-- x_functionsquare_rootat0x10913ed40_64&#45;&gt;guess_functionsquare_rootat0x10913ed40_58 -->
<g id="edge1" class="edge">
<title>x_functionsquare_rootat0x10913ed40_64&#45;&gt;guess_functionsquare_rootat0x10913ed40_58</title>
<path fill="none" stroke="black" d="M89.29,-607.61C81.63,-597.69 73.46,-584.99 69.5,-572 54.94,-524.26 67.48,-465.98 77.95,-431.26"/>
<polygon fill="black" stroke="black" points="81.24,-432.48 80.92,-421.89 74.56,-430.36 81.24,-432.48"/>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_61 -->
<g id="node6" class="node">
<title>guess_functionsquare_rootat0x10913ed40_61</title>
<g id="a_node6"><a xlink:title="square_root:61">
<polygon fill="peachpuff" stroke="black" points="318.12,-192 128.88,-192 128.88,-152 318.12,-152 318.12,-192"/>
<text text-anchor="start" x="202.88" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">guess</text>
<text text-anchor="start" x="136.88" y="-157.45" font-family="Courier,monospace" font-size="9.00">guess = (approx + x / approx) / 2</text>
</a>
</g>
</g>
<!-- x_functionsquare_rootat0x10913ed40_64&#45;&gt;guess_functionsquare_rootat0x10913ed40_61 -->
<g id="edge11" class="edge">
<title>x_functionsquare_rootat0x10913ed40_64&#45;&gt;guess_functionsquare_rootat0x10913ed40_61</title>
<path fill="none" stroke="black" d="M148.84,-622.57C182.71,-616.74 228.8,-603.23 255.5,-572 283.48,-539.27 274.5,-520.06 274.5,-477 274.5,-477 274.5,-477 274.5,-323 274.5,-279.15 254.72,-231.74 239.8,-202.22"/>
<polygon fill="black" stroke="black" points="242.99,-200.77 235.27,-193.53 236.79,-204.01 242.99,-200.77"/>
</g>
<!-- assertion_functionsquare_rootat0x10913ed40_55 -->
<g id="node8" class="node">
<title>assertion_functionsquare_rootat0x10913ed40_55</title>
<g id="a_node8"><a xlink:title="square_root:55">
<polygon fill="peachpuff" stroke="black" points="246.62,-572 78.38,-572 78.38,-532 246.62,-532 246.62,-572"/>
<text text-anchor="start" x="117.12" y="-555.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;assertion&gt;</text>
<text text-anchor="start" x="86.38" y="-537.45" font-family="Courier,monospace" font-size="9.00">assert x &gt;= 0 &#160;# precondition</text>
</a>
</g>
</g>
<!-- x_functionsquare_rootat0x10913ed40_64&#45;&gt;assertion_functionsquare_rootat0x10913ed40_55 -->
<g id="edge10" class="edge">
<title>x_functionsquare_rootat0x10913ed40_64&#45;&gt;assertion_functionsquare_rootat0x10913ed40_55</title>
<path fill="none" stroke="black" d="M121.21,-607.56C127.26,-599.57 134.38,-590.16 140.99,-581.43"/>
<polygon fill="black" stroke="black" points="143.73,-583.61 146.97,-573.52 138.15,-579.38 143.73,-583.61"/>
</g>
<!-- assertion_functionsquare_rootat0x10913ed40_63 -->
<g id="node9" class="node">
<title>assertion_functionsquare_rootat0x10913ed40_63</title>
<g id="a_node9"><a xlink:title="square_root:63">
<polygon fill="peachpuff" stroke="black" points="302.88,-116 82.12,-116 82.12,-76 302.88,-76 302.88,-116"/>
<text text-anchor="start" x="147.12" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;assertion&gt;</text>
<text text-anchor="start" x="90.12" y="-81.45" font-family="Courier,monospace" font-size="9.00">assert math.isclose(approx * approx, x)</text>
</a>
</g>
</g>
<!-- x_functionsquare_rootat0x10913ed40_64&#45;&gt;assertion_functionsquare_rootat0x10913ed40_63 -->
<g id="edge14" class="edge">
<title>x_functionsquare_rootat0x10913ed40_64&#45;&gt;assertion_functionsquare_rootat0x10913ed40_63</title>
<path fill="none" stroke="black" d="M84.22,-607.6C56.43,-581.13 12.5,-530.78 12.5,-477 12.5,-477 12.5,-477 12.5,-247 12.5,-185.54 75.2,-144.38 126.59,-120.96"/>
<polygon fill="black" stroke="black" points="127.89,-124.21 135.64,-116.98 125.08,-117.8 127.89,-124.21"/>
</g>
<!-- test_functionsquare_rootat0x10913ed40_59&#45;&gt;approx_functionsquare_rootat0x10913ed40_60 -->
<g id="edge9" class="edge">
<title>test_functionsquare_rootat0x10913ed40_59&#45;&gt;approx_functionsquare_rootat0x10913ed40_60</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M135.35,-303.56C133.25,-296.25 131.91,-287.75 131.49,-279.67"/>
<polygon fill="grey" stroke="grey" points="134.99,-279.85 131.56,-269.83 127.99,-279.8 134.99,-279.85"/>
</g>
<!-- test_functionsquare_rootat0x10913ed40_59&#45;&gt;approx_functionsquare_rootat0x10913ed40_60 -->
<!-- test_functionsquare_rootat0x10913ed40_59&#45;&gt;guess_functionsquare_rootat0x10913ed40_61 -->
<g id="edge13" class="edge">
<title>test_functionsquare_rootat0x10913ed40_59&#45;&gt;guess_functionsquare_rootat0x10913ed40_61</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M161.03,-303.57C169.25,-293.65 179.57,-280.95 186.5,-268 197.37,-247.69 204.53,-222.63 210.18,-203.34"/>
<polygon fill="grey" stroke="grey" points="213.49,-204.49 213,-193.91 206.78,-202.49 213.49,-204.49"/>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_60&#45;&gt;test_functionsquare_rootat0x10913ed40_59 -->
<g id="edge3" class="edge">
<title>approx_functionsquare_rootat0x10913ed40_60&#45;&gt;test_functionsquare_rootat0x10913ed40_59</title>
<path fill="none" stroke="black" d="M143.59,-268.31C144.38,-275.61 145.29,-284.1 146.17,-292.19"/>
<polygon fill="black" stroke="black" points="142.68,-292.49 147.24,-302.05 149.64,-291.73 142.68,-292.49"/>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_60&#45;&gt;guess_functionsquare_rootat0x10913ed40_61 -->
<g id="edge12" class="edge">
<title>approx_functionsquare_rootat0x10913ed40_60&#45;&gt;guess_functionsquare_rootat0x10913ed40_61</title>
<path fill="none" stroke="black" d="M151,-227.56C158.97,-218.97 169.98,-208.75 181.15,-199.49"/>
<polygon fill="black" stroke="black" points="183.29,-202.25 188.9,-193.26 178.91,-196.8 183.29,-202.25"/>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_60&#45;&gt;guess_functionsquare_rootat0x10913ed40_61 -->
<!-- square_rootreturnvalue_functionsquare_rootat0x10913ed40_64 -->
<g id="node7" class="node">
<title>square_rootreturnvalue_functionsquare_rootat0x10913ed40_64</title>
<g id="a_node7"><a xlink:title="square_root:64">
<polygon fill="peachpuff" stroke="black" points="247,-40 0,-40 0,0 247,0 247,-40"/>
<text text-anchor="start" x="8" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;square_root() return value&gt;</text>
<text text-anchor="start" x="89.38" y="-5.45" font-family="Courier,monospace" font-size="9.00">return approx</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_60&#45;&gt;square_rootreturnvalue_functionsquare_rootat0x10913ed40_64 -->
<g id="edge6" class="edge">
<title>approx_functionsquare_rootat0x10913ed40_60&#45;&gt;square_rootreturnvalue_functionsquare_rootat0x10913ed40_64</title>
<path fill="none" stroke="black" d="M127.54,-227.82C110.69,-203.32 83.4,-158.95 73.5,-116 69.51,-98.68 67.09,-92.58 73.5,-76 77.4,-65.92 84.09,-56.56 91.34,-48.51"/>
<polygon fill="black" stroke="black" points="93.78,-51.02 98.25,-41.41 88.77,-46.13 93.78,-51.02"/>
</g>
<!-- approx_functionsquare_rootat0x10913ed40_60&#45;&gt;assertion_functionsquare_rootat0x10913ed40_63 -->
<g id="edge15" class="edge">
<title>approx_functionsquare_rootat0x10913ed40_60&#45;&gt;assertion_functionsquare_rootat0x10913ed40_63</title>
<path fill="none" stroke="black" d="M129.63,-227.54C119.17,-207.68 107.34,-176.39 119.5,-152 125.25,-140.47 134.7,-130.72 144.92,-122.78"/>
<polygon fill="black" stroke="black" points="146.7,-125.81 152.8,-117.15 142.63,-120.12 146.7,-125.81"/>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_61&#45;&gt;test_functionsquare_rootat0x10913ed40_59 -->
<g id="edge4" class="edge">
<title>guess_functionsquare_rootat0x10913ed40_61&#45;&gt;test_functionsquare_rootat0x10913ed40_59</title>
<path fill="none" stroke="black" d="M226.95,-192.46C225.27,-212.31 217.57,-243.59 204.5,-268 199.35,-277.61 192.35,-287.08 184.99,-295.39"/>
<polygon fill="black" stroke="black" points="182.62,-292.8 178.3,-302.47 187.71,-297.6 182.62,-292.8"/>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_61&#45;&gt;approx_functionsquare_rootat0x10913ed40_60 -->
<g id="edge7" class="edge">
<title>guess_functionsquare_rootat0x10913ed40_61&#45;&gt;approx_functionsquare_rootat0x10913ed40_60</title>
<path fill="none" stroke="black" d="M202.1,-192.31C192.7,-200.79 181.51,-210.9 171.31,-220.1"/>
<polygon fill="black" stroke="black" points="169.25,-217.25 164.17,-226.54 173.94,-222.44 169.25,-217.25"/>
</g>
<!-- guess_functionsquare_rootat0x10913ed40_61&#45;&gt;assertion_functionsquare_rootat0x10913ed40_63 -->
<!-- assertion_functionsquare_rootat0x10913ed40_55&#45;&gt;approx_functionsquare_rootat0x10913ed40_57 -->
<!-- assertion_functionsquare_rootat0x10913ed40_63&#45;&gt;square_rootreturnvalue_functionsquare_rootat0x10913ed40_64 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, we can show the code annotated with dependencies:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">root_slicer</span><span class="o">.</span><span class="n">code</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>    54 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">square_root</span>(x):  <span class="ansi-white-fg"># type: ignore</span>
*   55     <span class="ansi-blue-fg">assert</span> x &gt;= <span class="ansi-blue-fg">0</span>  <span class="ansi-white-fg"># precondition  # &lt;= x (64)</span>
    56 
*   57     approx = <span class="ansi-blue-fg">None</span>
*   58     guess = x / <span class="ansi-blue-fg">2</span>  <span class="ansi-white-fg"># &lt;= x (64)</span>
*   59     <span class="ansi-blue-fg">while</span> approx != guess:  <span class="ansi-white-fg"># &lt;= approx (57), approx (60), guess (61), guess (58)</span>
*   60         approx = guess  <span class="ansi-white-fg"># &lt;= guess (61), guess (58); &lt;- &lt;test&gt; (59)</span>
*   61         guess = (approx + x / approx) / <span class="ansi-blue-fg">2</span>  <span class="ansi-white-fg"># &lt;= x (64), approx (60); &lt;- &lt;test&gt; (59)</span>
    62 
*   63     <span class="ansi-blue-fg">assert</span> math.isclose(approx * approx, x)  <span class="ansi-white-fg"># &lt;= x (64), approx (60)</span>
*   64     <span class="ansi-blue-fg">return</span> approx  <span class="ansi-white-fg"># &lt;= approx (60)</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The astute reader may find that a statement <code>assert p</code> does not control the following code, although it would be equivalent to <code>if not p: raise Exception</code>. Why is that?</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Why don't <code>assert</code> statements induce control dependencies?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="4f8ab048-cce7-11ef-87e4-6298cf1a578f" id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-1" onclick="clear_selection('4f8ab048-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-1-label" for="4f8ab048-cce7-11ef-87e4-6298cf1a578f-1">We have no special handling of <code>raise</code> statements</label><br>

        <input type="radio" name="4f8ab048-cce7-11ef-87e4-6298cf1a578f" id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-2" onclick="clear_selection('4f8ab048-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-2-label" for="4f8ab048-cce7-11ef-87e4-6298cf1a578f-2">We have no special handling of exceptions</label><br>

        <input type="radio" name="4f8ab048-cce7-11ef-87e4-6298cf1a578f" id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-3" onclick="clear_selection('4f8ab048-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-3-label" for="4f8ab048-cce7-11ef-87e4-6298cf1a578f-3">Assertions are not supposed to act as controlling mechanisms</label><br>

        <input type="radio" name="4f8ab048-cce7-11ef-87e4-6298cf1a578f" id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-4" onclick="clear_selection('4f8ab048-cce7-11ef-87e4-6298cf1a578f')">
        <label id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-4-label" for="4f8ab048-cce7-11ef-87e4-6298cf1a578f-4">All of the above</label><br>

    </div>
    </p>
    <input id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-submit" type="submit" value="Submit" onclick="check_selection('4f8ab048-cce7-11ef-87e4-6298cf1a578f', 16, 0, '(1 * 1 &lt;&lt; 1 * 1 &lt;&lt; 1 * 1)')">
    <span class="quiz_hint" id="4f8ab048-cce7-11ef-87e4-6298cf1a578f-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Indeed: we treat assertions as "neutral" in the sense that they do not affect the remainder of the program  if they are turned off, they have no effect; and if they are turned on, the remaining program logic should not depend on them. (Our instrumentation also has no special treatment of <code>raise</code> or even <code>return</code> statements; they should be handled by our <code>with</code> blocks, though.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># print(repr(root_slicer))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Removing-HTML-Markup">Removing HTML Markup<a class="anchor-link" href="#Removing-HTML-Markup">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us come to our ongoing example, <code>remove_html_markup()</code>. This is how its instrumented code looks like:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span> <span class="k">as</span> <span class="n">rhm_slicer</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">remove_html_markup</span><span class="p">(</span><span class="s2">&quot;&lt;foo&gt;bar&lt;/foo&gt;&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The graph is as discussed in the introduction to this chapter:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rhm_slicer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="625pt" height="884pt"
 viewBox="0.00 0.00 625.38 884.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 880)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-880 621.38,-880 621.38,4 -4,4"/>
<!-- test_functionremove_html_markupat0x108877e20_246 -->
<g id="node1" class="node">
<title>test_functionremove_html_markupat0x108877e20_246</title>
<g id="a_node1"><a xlink:title="remove_html_markup:246">
<polygon fill="peachpuff" stroke="black" points="517.62,-572 365.12,-572 365.12,-532 517.62,-532 517.62,-572"/>
<text text-anchor="start" x="416.62" y="-555.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="373.12" y="-537.45" font-family="Courier,monospace" font-size="9.00">if c == &#39;&lt;&#39; and not quote:</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x108877e20_248 -->
<g id="node4" class="node">
<title>test_functionremove_html_markupat0x108877e20_248</title>
<g id="a_node4"><a xlink:title="remove_html_markup:248">
<polygon fill="peachpuff" stroke="black" points="378.88,-420 215.88,-420 215.88,-380 378.88,-380 378.88,-420"/>
<text text-anchor="start" x="272.62" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="223.88" y="-385.45" font-family="Courier,monospace" font-size="9.00">elif c == &#39;&gt;&#39; and not quote:</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x108877e20_246&#45;&gt;test_functionremove_html_markupat0x108877e20_248 -->
<g id="edge5" class="edge">
<title>test_functionremove_html_markupat0x108877e20_246&#45;&gt;test_functionremove_html_markupat0x108877e20_248</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M422.84,-531.7C397.57,-505.37 352.16,-458.07 323.46,-428.17"/>
<polygon fill="grey" stroke="grey" points="326.33,-426.11 316.88,-421.32 321.28,-430.96 326.33,-426.11"/>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_247 -->
<g id="node6" class="node">
<title>tag_functionremove_html_markupat0x108877e20_247</title>
<g id="a_node6"><a xlink:title="remove_html_markup:247">
<polygon fill="peachpuff" stroke="black" points="475.62,-496 407.12,-496 407.12,-456 475.62,-456 475.62,-496"/>
<text text-anchor="start" x="429" y="-479.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="415.12" y="-461.45" font-family="Courier,monospace" font-size="9.00">tag = True</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x108877e20_246&#45;&gt;tag_functionremove_html_markupat0x108877e20_247 -->
<g id="edge8" class="edge">
<title>test_functionremove_html_markupat0x108877e20_246&#45;&gt;tag_functionremove_html_markupat0x108877e20_247</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M435.35,-531.56C434.7,-524.25 434.49,-515.75 434.71,-507.67"/>
<polygon fill="grey" stroke="grey" points="438.2,-508.01 435.28,-497.82 431.21,-507.61 438.2,-508.01"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_246&#45;&gt;tag_functionremove_html_markupat0x108877e20_247 -->
<!-- quote_functionremove_html_markupat0x108877e20_240 -->
<g id="node2" class="node">
<title>quote_functionremove_html_markupat0x108877e20_240</title>
<g id="a_node2"><a xlink:title="remove_html_markup:240">
<polygon fill="peachpuff" stroke="black" points="483.5,-800 399.25,-800 399.25,-760 483.5,-760 483.5,-800"/>
<text text-anchor="start" x="420.75" y="-783.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">quote</text>
<text text-anchor="start" x="407.25" y="-765.45" font-family="Courier,monospace" font-size="9.00">quote = False</text>
</a>
</g>
</g>
<!-- quote_functionremove_html_markupat0x108877e20_240&#45;&gt;test_functionremove_html_markupat0x108877e20_246 -->
<g id="edge1" class="edge">
<title>quote_functionremove_html_markupat0x108877e20_240&#45;&gt;test_functionremove_html_markupat0x108877e20_246</title>
<path fill="none" stroke="black" d="M441.38,-759.73C441.38,-720.45 441.38,-630.85 441.38,-583.55"/>
<polygon fill="black" stroke="black" points="444.88,-583.73 441.38,-573.73 437.88,-583.73 444.88,-583.73"/>
</g>
<!-- quote_functionremove_html_markupat0x108877e20_240&#45;&gt;test_functionremove_html_markupat0x108877e20_248 -->
<g id="edge3" class="edge">
<title>quote_functionremove_html_markupat0x108877e20_240&#45;&gt;test_functionremove_html_markupat0x108877e20_248</title>
<path fill="none" stroke="black" d="M433.03,-759.74C417.36,-723.33 382.72,-641.78 356.38,-572 337.89,-523.03 318.47,-465.35 307.16,-431.05"/>
<polygon fill="black" stroke="black" points="310.57,-430.21 304.13,-421.8 303.92,-432.39 310.57,-430.21"/>
</g>
<!-- assertion_functionremove_html_markupat0x108877e20_244 -->
<g id="node10" class="node">
<title>assertion_functionremove_html_markupat0x108877e20_244</title>
<g id="a_node10"><a xlink:title="remove_html_markup:244">
<polygon fill="peachpuff" stroke="black" points="513.75,-268 377,-268 377,-228 513.75,-228 513.75,-268"/>
<text text-anchor="start" x="400" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;assertion&gt;</text>
<text text-anchor="start" x="385" y="-233.45" font-family="Courier,monospace" font-size="9.00">assert tag or not quote</text>
</a>
</g>
</g>
<!-- quote_functionremove_html_markupat0x108877e20_240&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244 -->
<g id="edge15" class="edge">
<title>quote_functionremove_html_markupat0x108877e20_240&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244</title>
<path fill="none" stroke="black" d="M478.36,-759.52C519.23,-735.02 579.38,-688.8 579.38,-629 579.38,-629 579.38,-629 579.38,-399 579.38,-344.27 529.16,-300.34 490.2,-274.49"/>
<polygon fill="black" stroke="black" points="492.16,-271.59 481.86,-269.13 488.38,-277.48 492.16,-271.59"/>
</g>
<!-- out_functionremove_html_markupat0x108877e20_241 -->
<g id="node13" class="node">
<title>out_functionremove_html_markupat0x108877e20_241</title>
<g id="a_node13"><a xlink:title="remove_html_markup:241">
<polygon fill="peachpuff" stroke="black" points="216.38,-724 158.38,-724 158.38,-684 216.38,-684 216.38,-724"/>
<text text-anchor="start" x="175" y="-707.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">out</text>
<text text-anchor="start" x="166.38" y="-689.45" font-family="Courier,monospace" font-size="9.00">out = &quot;&quot;</text>
</a>
</g>
</g>
<!-- quote_functionremove_html_markupat0x108877e20_240&#45;&gt;out_functionremove_html_markupat0x108877e20_241 -->
<!-- c_functionremove_html_markupat0x108877e20_243 -->
<g id="node3" class="node">
<title>c_functionremove_html_markupat0x108877e20_243</title>
<g id="a_node3"><a xlink:title="remove_html_markup:243">
<polygon fill="peachpuff" stroke="black" points="298.25,-648 224.5,-648 224.5,-608 298.25,-608 298.25,-648"/>
<text text-anchor="start" x="257.25" y="-631.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">c</text>
<text text-anchor="start" x="232.5" y="-613.45" font-family="Courier,monospace" font-size="9.00">for c in s:</text>
</a>
</g>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_246 -->
<g id="edge2" class="edge">
<title>c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_246</title>
<path fill="none" stroke="black" d="M298.67,-611.67C323.23,-601.57 355.88,-588.15 383.75,-576.69"/>
<polygon fill="black" stroke="black" points="384.85,-580.02 392.77,-572.98 382.19,-573.55 384.85,-580.02"/>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_248 -->
<g id="edge4" class="edge">
<title>c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_248</title>
<path fill="none" stroke="black" d="M264.44,-607.73C270.7,-568.45 284.97,-478.85 292.51,-431.55"/>
<polygon fill="black" stroke="black" points="295.96,-432.14 294.08,-421.71 289.05,-431.04 295.96,-432.14"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_250 -->
<g id="node5" class="node">
<title>test_functionremove_html_markupat0x108877e20_250</title>
<g id="a_node5"><a xlink:title="remove_html_markup:250">
<polygon fill="peachpuff" stroke="black" points="320.88,-268 115.88,-268 115.88,-228 320.88,-228 320.88,-268"/>
<text text-anchor="start" x="193.62" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="123.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">elif (c == &#39;&quot;&#39; or c == &quot;&#39;&quot;) and tag:</text>
</a>
</g>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_250 -->
<g id="edge6" class="edge">
<title>c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_250</title>
<path fill="none" stroke="black" d="M244.58,-607.65C222.75,-580.43 187.38,-528.4 187.38,-477 187.38,-477 187.38,-477 187.38,-399 187.38,-356.74 199.32,-309.15 208.38,-279.13"/>
<polygon fill="black" stroke="black" points="211.72,-280.19 211.35,-269.6 205.03,-278.11 211.72,-280.19"/>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244 -->
<!-- out_functionremove_html_markupat0x108877e20_253 -->
<g id="node12" class="node">
<title>out_functionremove_html_markupat0x108877e20_253</title>
<g id="a_node12"><a xlink:title="remove_html_markup:253">
<polygon fill="peachpuff" stroke="black" points="194.5,-116 110.25,-116 110.25,-76 194.5,-76 194.5,-116"/>
<text text-anchor="start" x="140" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">out</text>
<text text-anchor="start" x="118.25" y="-81.45" font-family="Courier,monospace" font-size="9.00">out = out + c</text>
</a>
</g>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;out_functionremove_html_markupat0x108877e20_253 -->
<g id="edge20" class="edge">
<title>c_functionremove_html_markupat0x108877e20_243&#45;&gt;out_functionremove_html_markupat0x108877e20_253</title>
<path fill="none" stroke="black" d="M224.05,-614C172.92,-593.53 87.38,-548.59 87.38,-477 87.38,-477 87.38,-477 87.38,-247 87.38,-201.81 112.52,-154.81 131.53,-125.73"/>
<polygon fill="black" stroke="black" points="134.41,-127.72 137.1,-117.47 128.61,-123.8 134.41,-127.72"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_248&#45;&gt;test_functionremove_html_markupat0x108877e20_250 -->
<g id="edge7" class="edge">
<title>test_functionremove_html_markupat0x108877e20_248&#45;&gt;test_functionremove_html_markupat0x108877e20_250</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M278.23,-379.68C269.13,-369.68 258.68,-356.89 251.38,-344 239.85,-323.65 231.35,-298.58 225.86,-279.31"/>
<polygon fill="grey" stroke="grey" points="229.3,-278.63 223.31,-269.89 222.55,-280.46 229.3,-278.63"/>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_249 -->
<g id="node7" class="node">
<title>tag_functionremove_html_markupat0x108877e20_249</title>
<g id="a_node7"><a xlink:title="remove_html_markup:249">
<polygon fill="peachpuff" stroke="black" points="334.25,-344 260.5,-344 260.5,-304 334.25,-304 334.25,-344"/>
<text text-anchor="start" x="285" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="268.5" y="-309.45" font-family="Courier,monospace" font-size="9.00">tag = False</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x108877e20_248&#45;&gt;tag_functionremove_html_markupat0x108877e20_249 -->
<g id="edge9" class="edge">
<title>test_functionremove_html_markupat0x108877e20_248&#45;&gt;tag_functionremove_html_markupat0x108877e20_249</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M291.35,-379.56C290.7,-372.25 290.49,-363.75 290.71,-355.67"/>
<polygon fill="grey" stroke="grey" points="294.2,-356.01 291.28,-345.82 287.21,-355.61 294.2,-356.01"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_248&#45;&gt;tag_functionremove_html_markupat0x108877e20_249 -->
<!-- test_functionremove_html_markupat0x108877e20_252 -->
<g id="node8" class="node">
<title>test_functionremove_html_markupat0x108877e20_252</title>
<g id="a_node8"><a xlink:title="remove_html_markup:252">
<polygon fill="peachpuff" stroke="black" points="260.5,-192 176.25,-192 176.25,-152 260.5,-152 260.5,-192"/>
<text text-anchor="start" x="193.62" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="184.25" y="-157.45" font-family="Courier,monospace" font-size="9.00">elif not tag:</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x108877e20_250&#45;&gt;test_functionremove_html_markupat0x108877e20_252 -->
<g id="edge12" class="edge">
<title>test_functionremove_html_markupat0x108877e20_250&#45;&gt;test_functionremove_html_markupat0x108877e20_252</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M212.35,-227.56C211.7,-220.25 211.49,-211.75 211.71,-203.67"/>
<polygon fill="grey" stroke="grey" points="215.2,-204.01 212.28,-193.82 208.21,-203.61 215.2,-204.01"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_250&#45;&gt;test_functionremove_html_markupat0x108877e20_252 -->
<!-- tag_functionremove_html_markupat0x108877e20_247&#45;&gt;test_functionremove_html_markupat0x108877e20_248 -->
<!-- tag_functionremove_html_markupat0x108877e20_247&#45;&gt;test_functionremove_html_markupat0x108877e20_252 -->
<g id="edge11" class="edge">
<title>tag_functionremove_html_markupat0x108877e20_247&#45;&gt;test_functionremove_html_markupat0x108877e20_252</title>
<path fill="none" stroke="black" d="M458.75,-455.67C497.01,-410.74 580.67,-297.79 522.38,-228 491.08,-190.53 350.56,-178.54 271.99,-174.74"/>
<polygon fill="black" stroke="black" points="272.53,-171.26 262.38,-174.3 272.21,-178.25 272.53,-171.26"/>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_247&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244 -->
<g id="edge17" class="edge">
<title>tag_functionremove_html_markupat0x108877e20_247&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244</title>
<path fill="none" stroke="black" d="M441.72,-455.73C442.41,-416.45 444,-326.85 444.83,-279.55"/>
<polygon fill="black" stroke="black" points="448.33,-279.79 445.01,-269.73 441.33,-279.67 448.33,-279.79"/>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_249&#45;&gt;test_functionremove_html_markupat0x108877e20_250 -->
<!-- tag_functionremove_html_markupat0x108877e20_249&#45;&gt;test_functionremove_html_markupat0x108877e20_252 -->
<g id="edge10" class="edge">
<title>tag_functionremove_html_markupat0x108877e20_249&#45;&gt;test_functionremove_html_markupat0x108877e20_252</title>
<path fill="none" stroke="black" d="M313.5,-303.69C328.14,-283.67 345.33,-252.01 330.38,-228 317.33,-207.06 293.73,-193.87 271.55,-185.68"/>
<polygon fill="black" stroke="black" points="272.85,-182.42 262.26,-182.53 270.61,-189.05 272.85,-182.42"/>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_249&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244 -->
<g id="edge14" class="edge">
<title>tag_functionremove_html_markupat0x108877e20_249&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244</title>
<path fill="none" stroke="black" d="M334.72,-304.33C353.39,-294.99 376.22,-283.58 396.29,-273.54"/>
<polygon fill="black" stroke="black" points="397.76,-276.72 405.14,-269.12 394.63,-270.46 397.76,-276.72"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_252&#45;&gt;out_functionremove_html_markupat0x108877e20_253 -->
<g id="edge21" class="edge">
<title>test_functionremove_html_markupat0x108877e20_252&#45;&gt;out_functionremove_html_markupat0x108877e20_253</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M195.01,-151.56C187.09,-143.48 178.41,-133.96 170.9,-125.15"/>
<polygon fill="grey" stroke="grey" points="173.63,-122.95 164.55,-117.48 168.24,-127.41 173.63,-122.95"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_252&#45;&gt;out_functionremove_html_markupat0x108877e20_253 -->
<!-- s_functionremove_html_markupat0x108877e20_255 -->
<g id="node9" class="node">
<title>s_functionremove_html_markupat0x108877e20_255</title>
<g id="a_node9"><a xlink:title="remove_html_markup:255">
<polygon fill="peachpuff" stroke="black" points="302.62,-724 234.12,-724 234.12,-684 302.62,-684 302.62,-724"/>
<text text-anchor="start" x="264.25" y="-707.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">s</text>
<text text-anchor="start" x="242.12" y="-689.45" font-family="Courier,monospace" font-size="9.00">return out</text>
</a>
</g>
</g>
<!-- s_functionremove_html_markupat0x108877e20_255&#45;&gt;c_functionremove_html_markupat0x108877e20_243 -->
<g id="edge13" class="edge">
<title>s_functionremove_html_markupat0x108877e20_255&#45;&gt;c_functionremove_html_markupat0x108877e20_243</title>
<path fill="none" stroke="black" d="M266.54,-683.56C265.84,-676.25 265.04,-667.75 264.28,-659.67"/>
<polygon fill="black" stroke="black" points="267.77,-659.45 263.34,-649.82 260.8,-660.1 267.77,-659.45"/>
</g>
<!-- assertion_functionremove_html_markupat0x108877e20_244&#45;&gt;test_functionremove_html_markupat0x108877e20_246 -->
<!-- tag_functionremove_html_markupat0x108877e20_239 -->
<g id="node11" class="node">
<title>tag_functionremove_html_markupat0x108877e20_239</title>
<g id="a_node11"><a xlink:title="remove_html_markup:239">
<polygon fill="peachpuff" stroke="black" points="566.25,-876 492.5,-876 492.5,-836 566.25,-836 566.25,-876"/>
<text text-anchor="start" x="517" y="-859.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="500.5" y="-841.45" font-family="Courier,monospace" font-size="9.00">tag = False</text>
</a>
</g>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_239&#45;&gt;quote_functionremove_html_markupat0x108877e20_240 -->
<!-- tag_functionremove_html_markupat0x108877e20_239&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244 -->
<g id="edge16" class="edge">
<title>tag_functionremove_html_markupat0x108877e20_239&#45;&gt;assertion_functionremove_html_markupat0x108877e20_244</title>
<path fill="none" stroke="black" d="M549.79,-835.78C575.78,-809.11 617.38,-758.14 617.38,-705 617.38,-705 617.38,-705 617.38,-399 617.38,-349.76 596.79,-337.14 560.38,-304 546.62,-291.48 529.49,-281.25 512.7,-273.16"/>
<polygon fill="black" stroke="black" points="514.25,-270.02 503.7,-269.03 511.33,-276.38 514.25,-270.02"/>
</g>
<!-- out_functionremove_html_markupat0x108877e20_253&#45;&gt;out_functionremove_html_markupat0x108877e20_253 -->
<g id="edge18" class="edge">
<title>out_functionremove_html_markupat0x108877e20_253&#45;&gt;out_functionremove_html_markupat0x108877e20_253</title>
<path fill="none" stroke="black" d="M194.79,-110C204.96,-108.9 212.5,-104.24 212.5,-96 212.5,-91.11 209.84,-87.48 205.56,-85.1"/>
<polygon fill="black" stroke="black" points="206.83,-81.83 196.25,-82.42 204.89,-88.55 206.83,-81.83"/>
</g>
<!-- remove_html_markupreturnvalue_functionremove_html_markupat0x108877e20_255 -->
<g id="node14" class="node">
<title>remove_html_markupreturnvalue_functionremove_html_markupat0x108877e20_255</title>
<g id="a_node14"><a xlink:title="remove_html_markup:255">
<polygon fill="peachpuff" stroke="black" points="304.75,-40 0,-40 0,0 304.75,0 304.75,-40"/>
<text text-anchor="start" x="8" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;remove_html_markup() return value&gt;</text>
<text text-anchor="start" x="126.12" y="-5.45" font-family="Courier,monospace" font-size="9.00">return out</text>
</a>
</g>
</g>
<!-- out_functionremove_html_markupat0x108877e20_253&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x108877e20_255 -->
<g id="edge22" class="edge">
<title>out_functionremove_html_markupat0x108877e20_253&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x108877e20_255</title>
<path fill="none" stroke="black" d="M146.35,-75.56C145.7,-68.25 145.49,-59.75 145.71,-51.67"/>
<polygon fill="black" stroke="black" points="149.2,-52.01 146.28,-41.82 142.21,-51.61 149.2,-52.01"/>
</g>
<!-- out_functionremove_html_markupat0x108877e20_253&#45;&gt;remove_html_markupreturnvalue_functionremove_html_markupat0x108877e20_255 -->
<!-- out_functionremove_html_markupat0x108877e20_241&#45;&gt;c_functionremove_html_markupat0x108877e20_243 -->
<!-- out_functionremove_html_markupat0x108877e20_241&#45;&gt;out_functionremove_html_markupat0x108877e20_253 -->
<g id="edge19" class="edge">
<title>out_functionremove_html_markupat0x108877e20_241&#45;&gt;out_functionremove_html_markupat0x108877e20_253</title>
<path fill="none" stroke="black" d="M158.11,-688.03C117.6,-664.98 49.38,-616.69 49.38,-553 49.38,-553 49.38,-553 49.38,-247 49.38,-196.97 88.79,-151.44 118.86,-123.98"/>
<polygon fill="black" stroke="black" points="121.13,-126.64 126.31,-117.39 116.5,-121.4 121.13,-126.64"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># print(repr(rhm_slicer.dependencies()))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rhm_slicer</span><span class="o">.</span><span class="n">code</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>   238 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
*  239     tag = <span class="ansi-blue-fg">False</span>
*  240     quote = <span class="ansi-blue-fg">False</span>
*  241     out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
   242 
*  243     <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:  <span class="ansi-white-fg"># &lt;= s (255)</span>
*  244         <span class="ansi-blue-fg">assert</span> tag <span class="ansi-magenta-fg">or</span> <span class="ansi-magenta-fg">not</span> quote  <span class="ansi-white-fg"># &lt;= tag (249), quote (240), tag (239), tag (247)</span>
   245 
*  246         <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:  <span class="ansi-white-fg"># &lt;= quote (240), c (243)</span>
*  247             tag = <span class="ansi-blue-fg">True</span>  <span class="ansi-white-fg"># &lt;- &lt;test&gt; (246)</span>
*  248         <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:  <span class="ansi-white-fg"># &lt;= quote (240), c (243); &lt;- &lt;test&gt; (246)</span>
*  249             tag = <span class="ansi-blue-fg">False</span>  <span class="ansi-white-fg"># &lt;- &lt;test&gt; (248)</span>
*  250         <span class="ansi-blue-fg">elif</span> (c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span>) <span class="ansi-magenta-fg">and</span> tag:  <span class="ansi-white-fg"># &lt;= c (243); &lt;- &lt;test&gt; (248)</span>
   251             quote = <span class="ansi-magenta-fg">not</span> quote
*  252         <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:  <span class="ansi-white-fg"># &lt;= tag (249), tag (247); &lt;- &lt;test&gt; (250)</span>
*  253             out = out + c  <span class="ansi-white-fg"># &lt;= out (253), out (241), c (243); &lt;- &lt;test&gt; (252)</span>
   254 
*  255     <span class="ansi-blue-fg">return</span> out  <span class="ansi-white-fg"># &lt;= out (253)</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can also compute slices over the dependencies:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">start_remove_html_markup</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
<span class="n">start_remove_html_markup</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>238
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slicing_criterion</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">remove_html_markup</span><span class="p">,</span>
                             <span class="n">start_remove_html_markup</span> <span class="o">+</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">tag_deps</span> <span class="o">=</span> <span class="n">rhm_slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">backward_slice</span><span class="p">(</span><span class="n">slicing_criterion</span><span class="p">)</span>
<span class="n">tag_deps</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="178pt" height="352pt"
 viewBox="0.00 0.00 178.38 352.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-348 174.38,-348 174.38,4 -4,4"/>
<!-- test_functionremove_html_markupat0x108877e20_246 -->
<g id="node1" class="node">
<title>test_functionremove_html_markupat0x108877e20_246</title>
<g id="a_node1"><a xlink:title="remove_html_markup:246">
<polygon fill="peachpuff" stroke="black" points="152.5,-268 0,-268 0,-228 152.5,-228 152.5,-268"/>
<text text-anchor="start" x="51.5" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="8" y="-233.45" font-family="Courier,monospace" font-size="9.00">if c == &#39;&lt;&#39; and not quote:</text>
</a>
</g>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_247 -->
<g id="node4" class="node">
<title>tag_functionremove_html_markupat0x108877e20_247</title>
<g id="a_node4"><a xlink:title="remove_html_markup:247">
<polygon fill="peachpuff" stroke="black" points="96.5,-192 28,-192 28,-152 96.5,-152 96.5,-192"/>
<text text-anchor="start" x="49.88" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">tag</text>
<text text-anchor="start" x="36" y="-157.45" font-family="Courier,monospace" font-size="9.00">tag = True</text>
</a>
</g>
</g>
<!-- test_functionremove_html_markupat0x108877e20_246&#45;&gt;tag_functionremove_html_markupat0x108877e20_247 -->
<g id="edge3" class="edge">
<title>test_functionremove_html_markupat0x108877e20_246&#45;&gt;tag_functionremove_html_markupat0x108877e20_247</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M66.55,-227.56C64.51,-220.25 62.69,-211.75 61.39,-203.67"/>
<polygon fill="grey" stroke="grey" points="64.87,-203.27 60.09,-193.81 57.93,-204.19 64.87,-203.27"/>
</g>
<!-- test_functionremove_html_markupat0x108877e20_246&#45;&gt;tag_functionremove_html_markupat0x108877e20_247 -->
<!-- quote_functionremove_html_markupat0x108877e20_240 -->
<g id="node2" class="node">
<title>quote_functionremove_html_markupat0x108877e20_240</title>
<g id="a_node2"><a xlink:title="remove_html_markup:240">
<polygon fill="peachpuff" stroke="black" points="170.38,-344 86.12,-344 86.12,-304 170.38,-304 170.38,-344"/>
<text text-anchor="start" x="107.62" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">quote</text>
<text text-anchor="start" x="94.12" y="-309.45" font-family="Courier,monospace" font-size="9.00">quote = False</text>
</a>
</g>
</g>
<!-- quote_functionremove_html_markupat0x108877e20_240&#45;&gt;test_functionremove_html_markupat0x108877e20_246 -->
<g id="edge1" class="edge">
<title>quote_functionremove_html_markupat0x108877e20_240&#45;&gt;test_functionremove_html_markupat0x108877e20_246</title>
<path fill="none" stroke="black" d="M114.59,-303.56C109.03,-295.65 102.5,-286.36 96.42,-277.71"/>
<polygon fill="black" stroke="black" points="99.3,-275.72 90.69,-269.55 93.58,-279.75 99.3,-275.72"/>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243 -->
<g id="node3" class="node">
<title>c_functionremove_html_markupat0x108877e20_243</title>
<g id="a_node3"><a xlink:title="remove_html_markup:243">
<polygon fill="peachpuff" stroke="black" points="170.12,-40 96.38,-40 96.38,0 170.12,0 170.12,-40"/>
<text text-anchor="start" x="129.12" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">c</text>
<text text-anchor="start" x="104.38" y="-5.45" font-family="Courier,monospace" font-size="9.00">for c in s:</text>
</a>
</g>
</g>
<!-- quote_functionremove_html_markupat0x108877e20_240&#45;&gt;c_functionremove_html_markupat0x108877e20_243 -->
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_246 -->
<g id="edge2" class="edge">
<title>c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_246</title>
<path fill="none" stroke="black" d="M126.56,-40.47C120.77,-72.72 114.05,-138.95 96.25,-192 93.39,-200.51 89.33,-209.3 85.46,-217.29"/>
<polygon fill="black" stroke="black" points="82.34,-215.7 81.09,-226.22 88.63,-218.77 82.34,-215.7"/>
</g>
<!-- c_functionremove_html_markupat0x108877e20_243&#45;&gt;test_functionremove_html_markupat0x108877e20_246 -->
<!-- s_functionremove_html_markupat0x108877e20_255 -->
<g id="node5" class="node">
<title>s_functionremove_html_markupat0x108877e20_255</title>
<g id="a_node5"><a xlink:title="remove_html_markup:255">
<polygon fill="peachpuff" stroke="black" points="96.5,-116 28,-116 28,-76 96.5,-76 96.5,-116"/>
<text text-anchor="start" x="58.12" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">s</text>
<text text-anchor="start" x="36" y="-81.45" font-family="Courier,monospace" font-size="9.00">return out</text>
</a>
</g>
</g>
<!-- tag_functionremove_html_markupat0x108877e20_247&#45;&gt;s_functionremove_html_markupat0x108877e20_255 -->
<!-- s_functionremove_html_markupat0x108877e20_255&#45;&gt;c_functionremove_html_markupat0x108877e20_243 -->
<g id="edge4" class="edge">
<title>s_functionremove_html_markupat0x108877e20_255&#45;&gt;c_functionremove_html_markupat0x108877e20_243</title>
<path fill="none" stroke="black" d="M80.9,-75.56C88.81,-67.31 98.17,-57.56 106.78,-48.59"/>
<polygon fill="black" stroke="black" points="109.27,-51.04 113.67,-41.4 104.22,-46.2 109.27,-51.04"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># repr(tag_deps)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Calls-and-Augmented-Assign">Calls and Augmented Assign<a class="anchor-link" href="#Calls-and-Augmented-Assign">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our last example covers augmented assigns and data flow across function calls. We introduce two simple functions <code>add_to()</code> and <code>mul_with()</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add_to</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">n</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mul_with</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">*=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And we put these two together in a single call:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_math</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">mul_with</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">add_to</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">add_to</span><span class="p">,</span> <span class="n">mul_with</span><span class="p">,</span> <span class="n">test_math</span><span class="p">)</span> <span class="k">as</span> <span class="n">math_slicer</span><span class="p">:</span>
    <span class="n">test_math</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The resulting dependence graph nicely captures the data flow between these calls, notably arguments and parameters:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">math_slicer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3262393251.py:21: UserWarning: Warning: y (mul_with:3) depends on &lt;add_to() return value&gt; (add_to:3), but &#39;return x&#39; does not seem to have a call
  warnings.warn(f&#34;Warning: {self.format_var(var)} &#34;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="264pt" height="504pt"
 viewBox="0.00 0.00 264.12 504.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 500)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-500 260.12,-500 260.12,4 -4,4"/>
<!-- x_functionmul_withat0x10913e020_2 -->
<g id="node1" class="node">
<title>x_functionmul_withat0x10913e020_2</title>
<g id="a_node1"><a xlink:title="mul_with:2">
<polygon fill="peachpuff" stroke="black" points="167.88,-192 113.88,-192 113.88,-152 167.88,-152 167.88,-192"/>
<text text-anchor="start" x="136.75" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="125.12" y="-157.45" font-family="Courier,monospace" font-size="9.00">x *= y</text>
</a>
</g>
</g>
<!-- mul_withreturnvalue_functionmul_withat0x10913e020_3 -->
<g id="node6" class="node">
<title>mul_withreturnvalue_functionmul_withat0x10913e020_3</title>
<g id="a_node6"><a xlink:title="mul_with:3">
<polygon fill="peachpuff" stroke="black" points="252,-116 29.75,-116 29.75,-76 252,-76 252,-116"/>
<text text-anchor="start" x="37.75" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;mul_with() return value&gt;</text>
<text text-anchor="start" x="119.88" y="-81.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- x_functionmul_withat0x10913e020_2&#45;&gt;mul_withreturnvalue_functionmul_withat0x10913e020_3 -->
<g id="edge7" class="edge">
<title>x_functionmul_withat0x10913e020_2&#45;&gt;mul_withreturnvalue_functionmul_withat0x10913e020_3</title>
<path fill="none" stroke="black" d="M134.85,-151.56C134.2,-144.25 133.99,-135.75 134.21,-127.67"/>
<polygon fill="black" stroke="black" points="137.7,-128.01 134.78,-117.82 130.71,-127.61 137.7,-128.01"/>
</g>
<!-- x_functionmul_withat0x10913e020_2&#45;&gt;mul_withreturnvalue_functionmul_withat0x10913e020_3 -->
<!-- y_functionmul_withat0x10913e020_3 -->
<g id="node2" class="node">
<title>y_functionmul_withat0x10913e020_3</title>
<g id="a_node2"><a xlink:title="mul_with:3">
<polygon fill="peachpuff" stroke="black" points="131.88,-268 73.88,-268 73.88,-228 131.88,-228 131.88,-268"/>
<text text-anchor="start" x="98.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">y</text>
<text text-anchor="start" x="81.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- y_functionmul_withat0x10913e020_3&#45;&gt;x_functionmul_withat0x10913e020_2 -->
<g id="edge1" class="edge">
<title>y_functionmul_withat0x10913e020_3&#45;&gt;x_functionmul_withat0x10913e020_2</title>
<path fill="none" stroke="black" d="M112.86,-227.56C116.79,-219.91 121.38,-210.96 125.7,-202.55"/>
<polygon fill="black" stroke="black" points="128.81,-204.15 130.27,-193.66 122.58,-200.96 128.81,-204.15"/>
</g>
<!-- x_functionmul_withat0x10913e020_3 -->
<g id="node3" class="node">
<title>x_functionmul_withat0x10913e020_3</title>
<g id="a_node3"><a xlink:title="mul_with:3">
<polygon fill="peachpuff" stroke="black" points="207.88,-268 149.88,-268 149.88,-228 207.88,-228 207.88,-268"/>
<text text-anchor="start" x="174.75" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="157.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- x_functionmul_withat0x10913e020_3&#45;&gt;x_functionmul_withat0x10913e020_2 -->
<g id="edge2" class="edge">
<title>x_functionmul_withat0x10913e020_3&#45;&gt;x_functionmul_withat0x10913e020_2</title>
<path fill="none" stroke="black" d="M168.89,-227.56C164.96,-219.91 160.37,-210.96 156.05,-202.55"/>
<polygon fill="black" stroke="black" points="159.17,-200.96 151.48,-193.66 152.94,-204.15 159.17,-200.96"/>
</g>
<!-- n_functionadd_toat0x10913e340_3 -->
<g id="node4" class="node">
<title>n_functionadd_toat0x10913e340_3</title>
<g id="a_node4"><a xlink:title="add_to:3">
<polygon fill="peachpuff" stroke="black" points="93.88,-496 35.88,-496 35.88,-456 93.88,-456 93.88,-496"/>
<text text-anchor="start" x="60.75" y="-479.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">n</text>
<text text-anchor="start" x="43.88" y="-461.45" font-family="Courier,monospace" font-size="9.00">return n</text>
</a>
</g>
</g>
<!-- n_functionadd_toat0x10913e340_2 -->
<g id="node8" class="node">
<title>n_functionadd_toat0x10913e340_2</title>
<g id="a_node8"><a xlink:title="add_to:2">
<polygon fill="peachpuff" stroke="black" points="129.88,-420 75.88,-420 75.88,-380 129.88,-380 129.88,-420"/>
<text text-anchor="start" x="98.75" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">n</text>
<text text-anchor="start" x="87.12" y="-385.45" font-family="Courier,monospace" font-size="9.00">n += m</text>
</a>
</g>
</g>
<!-- n_functionadd_toat0x10913e340_3&#45;&gt;n_functionadd_toat0x10913e340_2 -->
<g id="edge4" class="edge">
<title>n_functionadd_toat0x10913e340_3&#45;&gt;n_functionadd_toat0x10913e340_2</title>
<path fill="none" stroke="black" d="M74.86,-455.56C78.79,-447.91 83.38,-438.96 87.7,-430.55"/>
<polygon fill="black" stroke="black" points="90.81,-432.15 92.27,-421.66 84.58,-428.96 90.81,-432.15"/>
</g>
<!-- test_mathreturnvalue_functiontest_mathat0x10913f1a0_2 -->
<g id="node5" class="node">
<title>test_mathreturnvalue_functiontest_mathat0x10913f1a0_2</title>
<g id="a_node5"><a xlink:title="test_math:2">
<polygon fill="peachpuff" stroke="black" points="256.12,-40 25.62,-40 25.62,0 256.12,0 256.12,-40"/>
<text text-anchor="start" x="33.62" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test_math() return value&gt;</text>
<text text-anchor="start" x="56.88" y="-5.45" font-family="Courier,monospace" font-size="9.00">return mul_with(1, add_to(2, 3))</text>
</a>
</g>
</g>
<!-- mul_withreturnvalue_functionmul_withat0x10913e020_3&#45;&gt;test_mathreturnvalue_functiontest_mathat0x10913f1a0_2 -->
<g id="edge3" class="edge">
<title>mul_withreturnvalue_functionmul_withat0x10913e020_3&#45;&gt;test_mathreturnvalue_functiontest_mathat0x10913f1a0_2</title>
<path fill="none" stroke="black" d="M140.88,-75.56C140.88,-68.25 140.88,-59.75 140.88,-51.67"/>
<polygon fill="black" stroke="black" points="144.38,-51.83 140.88,-41.83 137.38,-51.83 144.38,-51.83"/>
</g>
<!-- m_functionadd_toat0x10913e340_3 -->
<g id="node7" class="node">
<title>m_functionadd_toat0x10913e340_3</title>
<g id="a_node7"><a xlink:title="add_to:3">
<polygon fill="peachpuff" stroke="black" points="169.88,-496 111.88,-496 111.88,-456 169.88,-456 169.88,-496"/>
<text text-anchor="start" x="136.75" y="-479.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">m</text>
<text text-anchor="start" x="119.88" y="-461.45" font-family="Courier,monospace" font-size="9.00">return n</text>
</a>
</g>
</g>
<!-- m_functionadd_toat0x10913e340_3&#45;&gt;n_functionadd_toat0x10913e340_2 -->
<g id="edge5" class="edge">
<title>m_functionadd_toat0x10913e340_3&#45;&gt;n_functionadd_toat0x10913e340_2</title>
<path fill="none" stroke="black" d="M130.89,-455.56C126.96,-447.91 122.37,-438.96 118.05,-430.55"/>
<polygon fill="black" stroke="black" points="121.17,-428.96 113.48,-421.66 114.94,-432.15 121.17,-428.96"/>
</g>
<!-- add_toreturnvalue_functionadd_toat0x10913e340_3 -->
<g id="node9" class="node">
<title>add_toreturnvalue_functionadd_toat0x10913e340_3</title>
<g id="a_node9"><a xlink:title="add_to:3">
<polygon fill="peachpuff" stroke="black" points="205.75,-344 0,-344 0,-304 205.75,-304 205.75,-344"/>
<text text-anchor="start" x="8" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;add_to() return value&gt;</text>
<text text-anchor="start" x="81.88" y="-309.45" font-family="Courier,monospace" font-size="9.00">return n</text>
</a>
</g>
</g>
<!-- n_functionadd_toat0x10913e340_2&#45;&gt;add_toreturnvalue_functionadd_toat0x10913e340_3 -->
<g id="edge8" class="edge">
<title>n_functionadd_toat0x10913e340_2&#45;&gt;add_toreturnvalue_functionadd_toat0x10913e340_3</title>
<path fill="none" stroke="black" d="M96.85,-379.56C96.2,-372.25 95.99,-363.75 96.21,-355.67"/>
<polygon fill="black" stroke="black" points="99.7,-356.01 96.78,-345.82 92.71,-355.61 99.7,-356.01"/>
</g>
<!-- n_functionadd_toat0x10913e340_2&#45;&gt;add_toreturnvalue_functionadd_toat0x10913e340_3 -->
<!-- add_toreturnvalue_functionadd_toat0x10913e340_3&#45;&gt;y_functionmul_withat0x10913e020_3 -->
<g id="edge6" class="edge">
<title>add_toreturnvalue_functionadd_toat0x10913e340_3&#45;&gt;y_functionmul_withat0x10913e020_3</title>
<path fill="none" stroke="black" d="M102.88,-303.56C102.88,-296.25 102.88,-287.75 102.88,-279.67"/>
<polygon fill="black" stroke="black" points="106.38,-279.83 102.88,-269.83 99.38,-279.83 106.38,-279.83"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>These are also reflected in the code view:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">math_slicer</span><span class="o">.</span><span class="n">code</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>     1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">add_to</span>(n, m):  <span class="ansi-white-fg"># type: ignore</span>
*    2     n += m  <span class="ansi-white-fg"># &lt;= n (3), m (3)</span>
*    3     <span class="ansi-blue-fg">return</span> n  <span class="ansi-white-fg"># &lt;= n (2)</span>

     1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">mul_with</span>(x, y):  <span class="ansi-white-fg"># type: ignore</span>
*    2     x *= y  <span class="ansi-white-fg"># &lt;= y (3), x (3)</span>
*    3     <span class="ansi-blue-fg">return</span> x  <span class="ansi-white-fg"># &lt;= &lt;add_to() return value&gt; (add_to:3), x (2)</span>

     1 <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">test_math</span>() -&gt; <span class="ansi-blue-fg">None</span>:
*    2     <span class="ansi-blue-fg">return</span> mul_with(<span class="ansi-blue-fg">1</span>, add_to(<span class="ansi-blue-fg">2</span>, <span class="ansi-blue-fg">3</span>))  <span class="ansi-white-fg"># &lt;= &lt;mul_with() return value&gt; (mul_with:3)</span>
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3262393251.py:21: UserWarning: Warning: y (mul_with:3) depends on &lt;add_to() return value&gt; (add_to:3), but &#39;return x&#39; does not seem to have a call
  warnings.warn(f&#34;Warning: {self.format_var(var)} &#34;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Dynamic-Instrumentation">Dynamic Instrumentation<a class="anchor-link" href="#Dynamic-Instrumentation">&#182;</a></h2><p>When initializing <code>Slicer()</code>, one has to provide the set of functions to be instrumented. This is because the instrumentation has to take place <em>before</em> the code in the <code>with</code> block is executed. Can we determine this list on the fly while <code>Slicer()</code> is executed?</p>
<p>The answer is: Yes, but the solution is a bit hackish  even more so than what we have seen above. In essence, we proceed in two steps:</p>
<ol>
<li>When <code>DynamicSlicer.__init__()</code> is called:<ul>
<li>Use the <code>inspect</code> module to determine the source code of the call</li>
<li>Analyze the enclosed <code>with</code> block for function calls</li>
<li>Instrument these functions</li>
</ul>
</li>
<li>Whenever a function is about to be called (<code>DataTracker.call()</code>)<ul>
<li>Create an instrumented version of that function</li>
<li>Have the <code>call()</code> method return the instrumented function instead</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
</div>

<details id="Excursion:-Implementing-Dynamic-Instrumentation">
<summary>Implementing Dynamic Instrumentation</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We start with the aim of determining the <code>with</code> block to which our slicer is applied. The <code>our_with_block()</code> method inspects the source code of the <code>Slicer()</code> caller, and returns the one <code>with</code> block (as an AST) whose source line is currently active.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">WithVisitor</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">withs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">With</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">visit_With</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">With</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">withs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">our_with_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">With</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the currently active `with` block.&quot;&quot;&quot;</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller_frame</span><span class="p">()</span>
        <span class="n">source_lines</span><span class="p">,</span> <span class="n">starting_lineno</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">starting_lineno</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">starting_lineno</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># We only get one `with` line, rather than the full block</span>
            <span class="c1"># This happens in Jupyter notebooks with iPython 8.1.0 and later.</span>
            <span class="c1"># Here&#39;s a hacky workaround to get the cell contents:</span>
            <span class="c1"># https://stackoverflow.com/questions/51566497/getting-the-source-of-an-object-defined-in-a-jupyter-notebook</span>
            <span class="n">source_lines</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">linecache</span><span class="o">.</span><span class="n">getlines</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getfile</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
            <span class="n">starting_lineno</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">source_ast</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_lines</span><span class="p">))</span>
        <span class="n">wv</span> <span class="o">=</span> <span class="n">WithVisitor</span><span class="p">()</span>
        <span class="n">wv</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">source_ast</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">with_ast</span> <span class="ow">in</span> <span class="n">wv</span><span class="o">.</span><span class="n">withs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">starting_lineno</span> <span class="o">+</span> <span class="p">(</span><span class="n">with_ast</span><span class="o">.</span><span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">with_ast</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot find &#39;with&#39; block&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Within the <code>with</code> AST, we can identify all calls:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallCollector</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calls</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">visit_Call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="n">caller_id</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calls</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">caller_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">calls_in_our_with_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a set of function names called in the `with` block.&quot;&quot;&quot;</span>
        <span class="n">block_ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">our_with_block</span><span class="p">()</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">CallCollector</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">stmt</span> <span class="ow">in</span> <span class="n">block_ast</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="n">cc</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cc</span><span class="o">.</span><span class="n">calls</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The method <code>funcs_in_our_with_block()</code> finally returns a list of all functions used in the <code>with</code> block. This is the list of functions we will instrument upfront.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">funcs_in_our_with_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
        <span class="n">funcs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">calls_in_our_with_block</span><span class="p">():</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_func</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">func</span><span class="p">:</span>
                <span class="n">funcs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">funcs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The method <code>default_items_to_instrument()</code> is already provided for dynamic instrumentation it is invoked whenever no list of functions to instrument is provided. So we have it return the list of functions as computed above.</p>
<p>However, <code>default_items_to_instrument()</code> does one more thing: Using the (also provided) <code>instrument_call()</code> hook in our dependency tracker, we ensure that all (later) calls are redirected to instrumented functions! This way, if further functions are called, these will be instrumented on the fly.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Slicer</span><span class="p">(</span><span class="n">Slicer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">default_items_to_instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
        <span class="c1"># In _data.call(), return instrumented function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dependency_tracker</span><span class="o">.</span><span class="n">instrument_call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrument</span>

        <span class="c1"># Start instrumenting the functions in our `with` block</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">funcs_in_our_with_block</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Both these hacks are effective, as shown in the following example. We use the <code>Slicer()</code> constructor without arguments; it automatically identifies <code>fun_2()</code> as a function in the <code>with</code> block. As the instrumented <code>fun2()</code> is invoked, its <code>_data.call()</code> method instruments the call to <code>fun_1()</code> (and ensures the instrumented version is called).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fun_1</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fun_2</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">fun_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">fun_2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Instrumenting &lt;function fun_2 at 0x109184360&gt;
<span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">fun_2</span>(x: <span class="ansi-cyan-fg">int</span>) -&gt; <span class="ansi-cyan-fg">int</span>:
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>, last=<span class="ansi-blue-fg">True</span>)
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;fun_2() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.ret(_data.call(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">fun_1</span><span class="ansi-yellow-fg">&#39;</span>, fun_1))(_data.arg(_data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x), pos=<span class="ansi-blue-fg">1</span>))))

Instrumenting &lt;function fun_1 at 0x1091842c0&gt;
<span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">fun_1</span>(x: <span class="ansi-cyan-fg">int</span>) -&gt; <span class="ansi-cyan-fg">int</span>:
    _data.param(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x, pos=<span class="ansi-blue-fg">1</span>, last=<span class="ansi-blue-fg">True</span>)
    <span class="ansi-blue-fg">return</span> _data.set(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;fun_1() return value&gt;</span><span class="ansi-yellow-fg">&#39;</span>, _data.get(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#39;</span>, x))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slicer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="206pt" height="276pt"
 viewBox="0.00 0.00 205.50 276.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 272)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-272 201.5,-272 201.5,4 -4,4"/>
<!-- fun_1returnvalue_functionfun_1at0x10913fba0_2 -->
<g id="node1" class="node">
<title>fun_1returnvalue_functionfun_1at0x10913fba0_2</title>
<g id="a_node1"><a xlink:title="fun_1:2">
<polygon fill="peachpuff" stroke="black" points="197.5,-116 0,-116 0,-76 197.5,-76 197.5,-116"/>
<text text-anchor="start" x="8" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;fun_1() return value&gt;</text>
<text text-anchor="start" x="77.75" y="-81.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- fun_2returnvalue_functionfun_2at0x10913fa60_2 -->
<g id="node4" class="node">
<title>fun_2returnvalue_functionfun_2at0x10913fa60_2</title>
<g id="a_node4"><a xlink:title="fun_2:2">
<polygon fill="peachpuff" stroke="black" points="197.5,-40 0,-40 0,0 197.5,0 197.5,-40"/>
<text text-anchor="start" x="8" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;fun_2() return value&gt;</text>
<text text-anchor="start" x="59.38" y="-5.45" font-family="Courier,monospace" font-size="9.00">return fun_1(x)</text>
</a>
</g>
</g>
<!-- fun_1returnvalue_functionfun_1at0x10913fba0_2&#45;&gt;fun_2returnvalue_functionfun_2at0x10913fa60_2 -->
<g id="edge3" class="edge">
<title>fun_1returnvalue_functionfun_1at0x10913fba0_2&#45;&gt;fun_2returnvalue_functionfun_2at0x10913fa60_2</title>
<path fill="none" stroke="black" d="M98.75,-75.56C98.75,-68.25 98.75,-59.75 98.75,-51.67"/>
<polygon fill="black" stroke="black" points="102.25,-51.83 98.75,-41.83 95.25,-51.83 102.25,-51.83"/>
</g>
<!-- x_functionfun_1at0x10913fba0_2 -->
<g id="node2" class="node">
<title>x_functionfun_1at0x10913fba0_2</title>
<g id="a_node2"><a xlink:title="fun_1:2">
<polygon fill="peachpuff" stroke="black" points="127.75,-192 69.75,-192 69.75,-152 127.75,-152 127.75,-192"/>
<text text-anchor="start" x="94.62" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="77.75" y="-157.45" font-family="Courier,monospace" font-size="9.00">return x</text>
</a>
</g>
</g>
<!-- x_functionfun_1at0x10913fba0_2&#45;&gt;fun_1returnvalue_functionfun_1at0x10913fba0_2 -->
<g id="edge1" class="edge">
<title>x_functionfun_1at0x10913fba0_2&#45;&gt;fun_1returnvalue_functionfun_1at0x10913fba0_2</title>
<path fill="none" stroke="black" d="M98.75,-151.56C98.75,-144.25 98.75,-135.75 98.75,-127.67"/>
<polygon fill="black" stroke="black" points="102.25,-127.83 98.75,-117.83 95.25,-127.83 102.25,-127.83"/>
</g>
<!-- x_functionfun_2at0x10913fa60_2 -->
<g id="node3" class="node">
<title>x_functionfun_2at0x10913fa60_2</title>
<g id="a_node3"><a xlink:title="fun_2:2">
<polygon fill="peachpuff" stroke="black" points="146.12,-268 51.38,-268 51.38,-228 146.12,-228 146.12,-268"/>
<text text-anchor="start" x="94.62" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="59.38" y="-233.45" font-family="Courier,monospace" font-size="9.00">return fun_1(x)</text>
</a>
</g>
</g>
<!-- x_functionfun_2at0x10913fa60_2&#45;&gt;x_functionfun_1at0x10913fba0_2 -->
<g id="edge2" class="edge">
<title>x_functionfun_2at0x10913fa60_2&#45;&gt;x_functionfun_1at0x10913fba0_2</title>
<path fill="none" stroke="black" d="M98.75,-227.56C98.75,-220.25 98.75,-211.75 98.75,-203.67"/>
<polygon fill="black" stroke="black" points="102.25,-203.83 98.75,-193.83 95.25,-203.83 102.25,-203.83"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="More-Applications">More Applications<a class="anchor-link" href="#More-Applications">&#182;</a></h2><p>The main use of dynamic slices is for <em>debugging tools</em>, where they show the origins of individual values. However, beyond facilitating debugging, tracking information flows has a number of additional applications, some of which we briefly sketch here.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Verifying-Information-Flows">Verifying Information Flows<a class="anchor-link" href="#Verifying-Information-Flows">&#182;</a></h3><p>Using dynamic slices, we can check all the locations where (potentially sensitive) information is used. As an example, consider the following function <code>password_checker()</code>, which requests a password from the user and returns <code>True</code> if it is the correct one:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/hashlib.html" class="import" target="_blank">hashlib</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="nb">input</span><span class="p">,</span> <span class="n">next_inputs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SECRET_HASH_DIGEST</span> <span class="o">=</span> <span class="s1">&#39;59f2da35bcc39525b87932b4cc1f3d68&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">password_checker</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Request a password. Return True if correct.&quot;&quot;&quot;</span>
    <span class="n">secret_password</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter secret password: &quot;</span><span class="p">)</span>
    <span class="n">password_digest</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">secret_password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">password_digest</span> <span class="o">==</span> <span class="n">SECRET_HASH_DIGEST</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>(Note that this is a very naive implementation: A true password checker would use the Python <code>getpass</code> module to read in a password without echoing it in the clear, and possibly also use a more sophisticated hash function than <code>md5</code>.)</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>From a security perspective, the interesting question we can ask using slicing is: <em>Is the entered password stored in the clear somewhere</em>? For this, we can simply run our slicer to see where the inputs are going:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;secret123&#39;]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">()</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">valid_pwd</span> <span class="o">=</span> <span class="n">password_checker</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>Enter secret password: <b>secret123</b></samp>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slicer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="413pt" height="276pt"
 viewBox="0.00 0.00 412.50 276.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 272)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-272 408.5,-272 408.5,4 -4,4"/>
<!-- password_digest_functionpassword_checkerat0x109185580_4 -->
<g id="node1" class="node">
<title>password_digest_functionpassword_checkerat0x109185580_4</title>
<g id="a_node1"><a xlink:title="password_checker:4">
<polygon fill="peachpuff" stroke="black" points="404.5,-192 0,-192 0,-152 404.5,-152 404.5,-192"/>
<text text-anchor="start" x="140.38" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">password_digest</text>
<text text-anchor="start" x="8" y="-157.45" font-family="Courier,monospace" font-size="9.00">password_digest = hashlib.md5(secret_password.encode(&#39;utf&#45;8&#39;)).hexdigest()</text>
</a>
</g>
</g>
<!-- test_functionpassword_checkerat0x109185580_6 -->
<g id="node4" class="node">
<title>test_functionpassword_checkerat0x109185580_6</title>
<g id="a_node4"><a xlink:title="password_checker:6">
<polygon fill="peachpuff" stroke="black" points="317.88,-116 86.62,-116 86.62,-76 317.88,-76 317.88,-116"/>
<text text-anchor="start" x="177.5" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="94.62" y="-81.45" font-family="Courier,monospace" font-size="9.00">if password_digest == SECRET_HASH_DIGEST:</text>
</a>
</g>
</g>
<!-- password_digest_functionpassword_checkerat0x109185580_4&#45;&gt;test_functionpassword_checkerat0x109185580_6 -->
<g id="edge3" class="edge">
<title>password_digest_functionpassword_checkerat0x109185580_4&#45;&gt;test_functionpassword_checkerat0x109185580_6</title>
<path fill="none" stroke="black" d="M196.23,-151.56C195.57,-144.25 195.36,-135.75 195.59,-127.67"/>
<polygon fill="black" stroke="black" points="199.07,-128.01 196.15,-117.82 192.09,-127.61 199.07,-128.01"/>
</g>
<!-- password_digest_functionpassword_checkerat0x109185580_4&#45;&gt;test_functionpassword_checkerat0x109185580_6 -->
<!-- secret_password_functionpassword_checkerat0x109185580_3 -->
<g id="node2" class="node">
<title>secret_password_functionpassword_checkerat0x109185580_3</title>
<g id="a_node2"><a xlink:title="password_checker:3">
<polygon fill="peachpuff" stroke="black" points="341.5,-268 63,-268 63,-228 341.5,-228 341.5,-268"/>
<text text-anchor="start" x="140.38" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">secret_password</text>
<text text-anchor="start" x="71" y="-233.45" font-family="Courier,monospace" font-size="9.00">secret_password = input(&quot;Enter secret password: &quot;)</text>
</a>
</g>
</g>
<!-- secret_password_functionpassword_checkerat0x109185580_3&#45;&gt;password_digest_functionpassword_checkerat0x109185580_4 -->
<g id="edge1" class="edge">
<title>secret_password_functionpassword_checkerat0x109185580_3&#45;&gt;password_digest_functionpassword_checkerat0x109185580_4</title>
<path fill="none" stroke="black" d="M196.23,-227.56C195.57,-220.25 195.36,-211.75 195.59,-203.67"/>
<polygon fill="black" stroke="black" points="199.07,-204.01 196.15,-193.82 192.09,-203.61 199.07,-204.01"/>
</g>
<!-- secret_password_functionpassword_checkerat0x109185580_3&#45;&gt;password_digest_functionpassword_checkerat0x109185580_4 -->
<!-- password_checkerreturnvalue_functionpassword_checkerat0x109185580_9 -->
<g id="node3" class="node">
<title>password_checkerreturnvalue_functionpassword_checkerat0x109185580_9</title>
<g id="a_node3"><a xlink:title="password_checker:9">
<polygon fill="peachpuff" stroke="black" points="346.38,-40 58.12,-40 58.12,0 346.38,0 346.38,-40"/>
<text text-anchor="start" x="66.12" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;password_checker() return value&gt;</text>
<text text-anchor="start" x="170.75" y="-5.45" font-family="Courier,monospace" font-size="9.00">return False</text>
</a>
</g>
</g>
<!-- test_functionpassword_checkerat0x109185580_6&#45;&gt;password_checkerreturnvalue_functionpassword_checkerat0x109185580_9 -->
<g id="edge2" class="edge">
<title>test_functionpassword_checkerat0x109185580_6&#45;&gt;password_checkerreturnvalue_functionpassword_checkerat0x109185580_9</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M196.23,-75.56C195.57,-68.25 195.36,-59.75 195.59,-51.67"/>
<polygon fill="grey" stroke="grey" points="199.07,-52.01 196.15,-41.82 192.09,-51.61 199.07,-52.01"/>
</g>
<!-- test_functionpassword_checkerat0x109185580_6&#45;&gt;password_checkerreturnvalue_functionpassword_checkerat0x109185580_9 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that the password only flows into <code>password_digest</code>, where it is already encrypted. If the password were flowing into some other function or variable, we would see this in our slice.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>(Note that an attacker may still be able to find out which password was entered, for instance, by checking memory contents.)</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">What is the secret password, actually?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="51256d58-cce7-11ef-87e4-6298cf1a578f" id="51256d58-cce7-11ef-87e4-6298cf1a578f-1" onclick="clear_selection('51256d58-cce7-11ef-87e4-6298cf1a578f')">
        <label id="51256d58-cce7-11ef-87e4-6298cf1a578f-1-label" for="51256d58-cce7-11ef-87e4-6298cf1a578f-1"><code>'automated'</code></label><br>

        <input type="radio" name="51256d58-cce7-11ef-87e4-6298cf1a578f" id="51256d58-cce7-11ef-87e4-6298cf1a578f-2" onclick="clear_selection('51256d58-cce7-11ef-87e4-6298cf1a578f')">
        <label id="51256d58-cce7-11ef-87e4-6298cf1a578f-2-label" for="51256d58-cce7-11ef-87e4-6298cf1a578f-2"><code>'debugging'</code></label><br>

        <input type="radio" name="51256d58-cce7-11ef-87e4-6298cf1a578f" id="51256d58-cce7-11ef-87e4-6298cf1a578f-3" onclick="clear_selection('51256d58-cce7-11ef-87e4-6298cf1a578f')">
        <label id="51256d58-cce7-11ef-87e4-6298cf1a578f-3-label" for="51256d58-cce7-11ef-87e4-6298cf1a578f-3"><code>'is'</code></label><br>

        <input type="radio" name="51256d58-cce7-11ef-87e4-6298cf1a578f" id="51256d58-cce7-11ef-87e4-6298cf1a578f-4" onclick="clear_selection('51256d58-cce7-11ef-87e4-6298cf1a578f')">
        <label id="51256d58-cce7-11ef-87e4-6298cf1a578f-4-label" for="51256d58-cce7-11ef-87e4-6298cf1a578f-4"><code>'fun'</code></label><br>

    </div>
    </p>
    <input id="51256d58-cce7-11ef-87e4-6298cf1a578f-submit" type="submit" value="Submit" onclick="check_selection('51256d58-cce7-11ef-87e4-6298cf1a578f', 4, 0, '')">
    <span class="quiz_hint" id="51256d58-cce7-11ef-87e4-6298cf1a578f-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Assessing-Test-Quality">Assessing Test Quality<a class="anchor-link" href="#Assessing-Test-Quality">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Another interesting usage of dynamic slices is to <em>assess test quality</em>. With our <code>square_root()</code> function, we have seen that the included assertions well test the arguments and the result for correctness:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>54  <span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">square_root</span>(x):  <span class="ansi-white-fg"># type: ignore</span>
55      <span class="ansi-blue-fg">assert</span> x &gt;= <span class="ansi-blue-fg">0</span>  <span class="ansi-white-fg"># precondition</span>
56  
57      approx = <span class="ansi-blue-fg">None</span>
58      guess = x / <span class="ansi-blue-fg">2</span>
59      <span class="ansi-blue-fg">while</span> approx != guess:
60          approx = guess
61          guess = (approx + x / approx) / <span class="ansi-blue-fg">2</span>
62  
63      <span class="ansi-blue-fg">assert</span> math.isclose(approx * approx, x)
64      <span class="ansi-blue-fg">return</span> approx
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, a lazy programmer could also omit these tests or worse yet, include tests that always pass:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">square_root_unchecked</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">assert</span> <span class="kc">True</span>  <span class="c1"># &lt;-- new &quot;precondition&quot;</span>

    <span class="n">approx</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="n">approx</span> <span class="o">!=</span> <span class="n">guess</span><span class="p">:</span>
        <span class="n">approx</span> <span class="o">=</span> <span class="n">guess</span>
        <span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="n">approx</span> <span class="o">+</span> <span class="n">x</span> <span class="o">/</span> <span class="n">approx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">assert</span> <span class="kc">True</span>  <span class="c1"># &lt;-- new &quot;postcondition&quot;</span>
    <span class="k">return</span> <span class="n">approx</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How can one check that the tests supplied actually are effective? This is a problem of "Who watches the watchmen"  we need to find a way to ensure that the tests do their job.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The "classical" way of testing tests is so-called <em>mutation testing</em> that is, introducing <em>artificial errors</em> into the code to see whether the tests catch them. Mutation testing is effective: The above "weak" tests would not catch any change to the <code>square_root()</code> computation code, and hence quickly be determined as ineffective. However, mutation testing is also <em>costly</em>, as tests have to be ran again and again for every small code mutation.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Slices offer a cost-effective alternative to determine the quality of tests. The idea is that if there are statements in the code whose result does <em>not</em> flow into an assertion, then any errors in these statements will go unnoticed. In consequence, the larger the backward slice of an assertion, the higher its ability to catch errors.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can easily validate this assumption using the two examples, above. Here is the backward slice for the "full" postcondition in <code>square_root()</code>. We see that the entire computation code flows into the final postcondition:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">postcondition_lineno</span> <span class="o">=</span> <span class="n">start_square_root</span> <span class="o">+</span> <span class="mi">9</span>
<span class="n">postcondition_lineno</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>63
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">()</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">square_root</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">backward_slice</span><span class="p">((</span><span class="n">square_root</span><span class="p">,</span> <span class="n">postcondition_lineno</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="482pt" height="428pt"
 viewBox="0.00 0.00 481.62 428.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 424)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-424 477.62,-424 477.62,4 -4,4"/>
<!-- approx_functionsquare_rootat0x108876ac0_57 -->
<g id="node1" class="node">
<title>approx_functionsquare_rootat0x108876ac0_57</title>
<g id="a_node1"><a xlink:title="square_root:57">
<polygon fill="peachpuff" stroke="black" points="399.75,-420 315.5,-420 315.5,-380 399.75,-380 399.75,-420"/>
<text text-anchor="start" x="332.88" y="-403.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">approx</text>
<text text-anchor="start" x="323.5" y="-385.45" font-family="Courier,monospace" font-size="9.00">approx = None</text>
</a>
</g>
</g>
<!-- test_functionsquare_rootat0x108876ac0_59 -->
<g id="node5" class="node">
<title>test_functionsquare_rootat0x108876ac0_59</title>
<g id="a_node5"><a xlink:title="square_root:59">
<polygon fill="peachpuff" stroke="black" points="307.38,-344 175.88,-344 175.88,-304 307.38,-304 307.38,-344"/>
<text text-anchor="start" x="216.88" y="-327.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;test&gt;</text>
<text text-anchor="start" x="183.88" y="-309.45" font-family="Courier,monospace" font-size="9.00">while approx != guess:</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x108876ac0_57&#45;&gt;test_functionsquare_rootat0x108876ac0_59 -->
<g id="edge4" class="edge">
<title>approx_functionsquare_rootat0x108876ac0_57&#45;&gt;test_functionsquare_rootat0x108876ac0_59</title>
<path fill="none" stroke="black" d="M327.15,-379.56C313.16,-370.63 296.39,-359.94 281.43,-350.39"/>
<polygon fill="black" stroke="black" points="283.49,-347.55 273.18,-345.13 279.72,-353.46 283.49,-347.55"/>
</g>
<!-- guess_functionsquare_rootat0x108876ac0_58 -->
<g id="node7" class="node">
<title>guess_functionsquare_rootat0x108876ac0_58</title>
<g id="a_node7"><a xlink:title="square_root:58">
<polygon fill="peachpuff" stroke="black" points="468.75,-40 384.5,-40 384.5,0 468.75,0 468.75,-40"/>
<text text-anchor="start" x="406" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">guess</text>
<text text-anchor="start" x="392.5" y="-5.45" font-family="Courier,monospace" font-size="9.00">guess = x / 2</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x108876ac0_57&#45;&gt;guess_functionsquare_rootat0x108876ac0_58 -->
<!-- assertion_functionsquare_rootat0x108876ac0_63 -->
<g id="node2" class="node">
<title>assertion_functionsquare_rootat0x108876ac0_63</title>
<g id="a_node2"><a xlink:title="square_root:63">
<polygon fill="peachpuff" stroke="black" points="352,-192 131.25,-192 131.25,-152 352,-152 352,-192"/>
<text text-anchor="start" x="196.25" y="-175.7" font-family="Courier,monospace" font-weight="bold" font-style="italic" font-size="14.00">&lt;assertion&gt;</text>
<text text-anchor="start" x="139.25" y="-157.45" font-family="Courier,monospace" font-size="9.00">assert math.isclose(approx * approx, x)</text>
</a>
</g>
</g>
<!-- x_functionsquare_rootat0x108876ac0_64 -->
<g id="node4" class="node">
<title>x_functionsquare_rootat0x108876ac0_64</title>
<g id="a_node4"><a xlink:title="square_root:64">
<polygon fill="peachpuff" stroke="black" points="283.75,-116 199.5,-116 199.5,-76 283.75,-76 283.75,-116"/>
<text text-anchor="start" x="237.5" y="-99.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">x</text>
<text text-anchor="start" x="207.5" y="-81.45" font-family="Courier,monospace" font-size="9.00">return approx</text>
</a>
</g>
</g>
<!-- assertion_functionsquare_rootat0x108876ac0_63&#45;&gt;x_functionsquare_rootat0x108876ac0_64 -->
<!-- approx_functionsquare_rootat0x108876ac0_60 -->
<g id="node3" class="node">
<title>approx_functionsquare_rootat0x108876ac0_60</title>
<g id="a_node3"><a xlink:title="square_root:60">
<polygon fill="peachpuff" stroke="black" points="286.38,-268 196.88,-268 196.88,-228 286.38,-228 286.38,-268"/>
<text text-anchor="start" x="216.88" y="-251.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">approx</text>
<text text-anchor="start" x="204.88" y="-233.45" font-family="Courier,monospace" font-size="9.00">approx = guess</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x108876ac0_60&#45;&gt;assertion_functionsquare_rootat0x108876ac0_63 -->
<g id="edge1" class="edge">
<title>approx_functionsquare_rootat0x108876ac0_60&#45;&gt;assertion_functionsquare_rootat0x108876ac0_63</title>
<path fill="none" stroke="black" d="M241.62,-227.56C241.62,-220.25 241.62,-211.75 241.62,-203.67"/>
<polygon fill="black" stroke="black" points="245.13,-203.83 241.63,-193.83 238.13,-203.83 245.13,-203.83"/>
</g>
<!-- approx_functionsquare_rootat0x108876ac0_60&#45;&gt;test_functionsquare_rootat0x108876ac0_59 -->
<g id="edge3" class="edge">
<title>approx_functionsquare_rootat0x108876ac0_60&#45;&gt;test_functionsquare_rootat0x108876ac0_59</title>
<path fill="none" stroke="black" d="M241.62,-268.31C241.62,-275.61 241.62,-284.1 241.62,-292.19"/>
<polygon fill="black" stroke="black" points="238.13,-292.04 241.63,-302.04 245.13,-292.04 238.13,-292.04"/>
</g>
<!-- guess_functionsquare_rootat0x108876ac0_61 -->
<g id="node6" class="node">
<title>guess_functionsquare_rootat0x108876ac0_61</title>
<g id="a_node6"><a xlink:title="square_root:61">
<polygon fill="peachpuff" stroke="black" points="189.25,-40 0,-40 0,0 189.25,0 189.25,-40"/>
<text text-anchor="start" x="74" y="-23.7" font-family="Courier,monospace" font-weight="bold" font-size="14.00">guess</text>
<text text-anchor="start" x="8" y="-5.45" font-family="Courier,monospace" font-size="9.00">guess = (approx + x / approx) / 2</text>
</a>
</g>
</g>
<!-- approx_functionsquare_rootat0x108876ac0_60&#45;&gt;guess_functionsquare_rootat0x108876ac0_61 -->
<g id="edge7" class="edge">
<title>approx_functionsquare_rootat0x108876ac0_60&#45;&gt;guess_functionsquare_rootat0x108876ac0_61</title>
<path fill="none" stroke="black" d="M196.62,-239.46C168.15,-232.03 133.32,-217.91 113.62,-192 82.49,-151.05 80.46,-88.51 85.22,-51.5"/>
<polygon fill="black" stroke="black" points="88.63,-52.36 86.74,-41.93 81.71,-51.26 88.63,-52.36"/>
</g>
<!-- approx_functionsquare_rootat0x108876ac0_60&#45;&gt;guess_functionsquare_rootat0x108876ac0_61 -->
<!-- x_functionsquare_rootat0x108876ac0_64&#45;&gt;assertion_functionsquare_rootat0x108876ac0_63 -->
<g id="edge2" class="edge">
<title>x_functionsquare_rootat0x108876ac0_64&#45;&gt;assertion_functionsquare_rootat0x108876ac0_63</title>
<path fill="none" stroke="black" d="M247.64,-116.31C248.3,-123.61 248.51,-132.1 248.29,-140.19"/>
<polygon fill="black" stroke="black" points="244.8,-139.86 247.73,-150.05 251.79,-140.26 244.8,-139.86"/>
</g>
<!-- x_functionsquare_rootat0x108876ac0_64&#45;&gt;guess_functionsquare_rootat0x108876ac0_61 -->
<g id="edge8" class="edge">
<title>x_functionsquare_rootat0x108876ac0_64&#45;&gt;guess_functionsquare_rootat0x108876ac0_61</title>
<path fill="none" stroke="black" d="M203,-75.56C184.76,-66.37 162.78,-55.31 143.41,-45.56"/>
<polygon fill="black" stroke="black" points="145.1,-42.49 134.6,-41.12 141.95,-48.74 145.1,-42.49"/>
</g>
<!-- x_functionsquare_rootat0x108876ac0_64&#45;&gt;guess_functionsquare_rootat0x108876ac0_58 -->
<g id="edge12" class="edge">
<title>x_functionsquare_rootat0x108876ac0_64&#45;&gt;guess_functionsquare_rootat0x108876ac0_58</title>
<path fill="none" stroke="black" d="M284.07,-78.02C310.65,-67.39 345.12,-53.6 373.51,-42.25"/>
<polygon fill="black" stroke="black" points="374.67,-45.55 382.65,-38.59 372.07,-39.05 374.67,-45.55"/>
</g>
<!-- test_functionsquare_rootat0x108876ac0_59&#45;&gt;approx_functionsquare_rootat0x108876ac0_60 -->
<g id="edge11" class="edge">
<title>test_functionsquare_rootat0x108876ac0_59&#45;&gt;approx_functionsquare_rootat0x108876ac0_60</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M229.58,-303.56C228.27,-296.25 227.85,-287.75 228.3,-279.67"/>
<polygon fill="grey" stroke="grey" points="231.77,-280.15 229.43,-269.82 224.82,-279.35 231.77,-280.15"/>
</g>
<!-- test_functionsquare_rootat0x108876ac0_59&#45;&gt;approx_functionsquare_rootat0x108876ac0_60 -->
<!-- test_functionsquare_rootat0x108876ac0_59&#45;&gt;guess_functionsquare_rootat0x108876ac0_61 -->
<g id="edge9" class="edge">
<title>test_functionsquare_rootat0x108876ac0_59&#45;&gt;guess_functionsquare_rootat0x108876ac0_61</title>
<path fill="none" stroke="grey" stroke-dasharray="5,2" d="M203.64,-303.66C167.72,-281.21 115.91,-240.94 89.62,-192 65.79,-147.62 71.79,-86.97 81.16,-51.1"/>
<polygon fill="grey" stroke="grey" points="84.43,-52.41 83.87,-41.83 77.71,-50.45 84.43,-52.41"/>
</g>
<!-- guess_functionsquare_rootat0x108876ac0_61&#45;&gt;assertion_functionsquare_rootat0x108876ac0_63 -->
<!-- guess_functionsquare_rootat0x108876ac0_61&#45;&gt;test_functionsquare_rootat0x108876ac0_59 -->
<g id="edge5" class="edge">
<title>guess_functionsquare_rootat0x108876ac0_61&#45;&gt;test_functionsquare_rootat0x108876ac0_59</title>
<path fill="none" stroke="black" d="M95.17,-40.38C91.43,-73.65 81.21,-142.82 107.62,-192 131.45,-236.35 176.23,-273.59 207.56,-296.89"/>
<polygon fill="black" stroke="black" points="205.46,-299.68 215.6,-302.77 209.6,-294.04 205.46,-299.68"/>
</g>
<!-- guess_functionsquare_rootat0x108876ac0_58&#45;&gt;approx_functionsquare_rootat0x108876ac0_60 -->
<g id="edge10" class="edge">
<title>guess_functionsquare_rootat0x108876ac0_58&#45;&gt;approx_functionsquare_rootat0x108876ac0_60</title>
<path fill="none" stroke="black" d="M418.34,-40.27C413.88,-50.78 408.33,-64.06 403.62,-76 383.46,-127.15 397.96,-151.64 360.62,-192 343.76,-210.24 319.64,-222.92 297.53,-231.47"/>
<polygon fill="black" stroke="black" points="296.5,-228.12 288.29,-234.83 298.89,-234.7 296.5,-228.12"/>
</g>
<!-- guess_functionsquare_rootat0x108876ac0_58&#45;&gt;test_functionsquare_rootat0x108876ac0_59 -->
<g id="edge6" class="edge">
<title>guess_functionsquare_rootat0x108876ac0_58&#45;&gt;test_functionsquare_rootat0x108876ac0_59</title>
<path fill="none" stroke="black" d="M420.39,-40.34C414.67,-73.55 406.75,-142.63 377.62,-192 351.77,-235.83 306.44,-273.27 275.14,-296.76"/>
<polygon fill="black" stroke="black" points="273.08,-293.93 267.13,-302.69 277.25,-299.55 273.08,-293.93"/>
</g>
<!-- guess_functionsquare_rootat0x108876ac0_58&#45;&gt;test_functionsquare_rootat0x108876ac0_59 -->
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In contrast, the "lazy" assertion in <code>square_root_unchecked()</code> has an empty backward slice, showing that it depends on no other value at all:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">()</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">square_root_unchecked</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">slicer</span><span class="o">.</span><span class="n">dependencies</span><span class="p">()</span><span class="o">.</span><span class="n">backward_slice</span><span class="p">((</span><span class="n">square_root</span><span class="p">,</span> <span class="n">postcondition_lineno</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="8pt" height="8pt"
 viewBox="0.00 0.00 8.00 8.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4)">
<title>dependencies</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-4 4,-4 4,4 -4,4"/>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In [<a href="https://doi.org/10.1109/ICST.2011.32">Schuler <em>et al</em>, 2011</a>], Schuler et al. have tried out this technique and found their "checked coverage" to be a sure indicator for the quality of the checks in tests. Using our dynamic slices, you may wish to try this out on Python code.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Use-in-Statistical-Debugging">Use in Statistical Debugging<a class="anchor-link" href="#Use-in-Statistical-Debugging">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Collecting dynamic slices over several runs allows for <em>correlating dependencies with other execution features</em>, notably <em>failures</em>: "The program fails whenever the value of <code>weekday</code> comes from <code>calendar()</code>." We will revisit this idea in <a href="StatisticalDebugger.html">the chapter on statistical debugging</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Things-that-do-not-Work">Things that do not Work<a class="anchor-link" href="#Things-that-do-not-Work">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our slicer (and especially the underlying dependency tracker) is still a proof of concept. A number of Python features are not or only partially supported, and/or hardly tested:</p>
<ul>
<li><strong>Exceptions</strong> can lead to missing or erroneous dependencies. The code assumes that for every <code>call()</code>, there is a matching <code>ret()</code>; when exceptions break this, dependencies across function calls and arguments may be missing or be assigned incorrectly.</li>
<li><strong>Multiple definitions on a single line</strong> as in <code>x = y; x = 1</code> can lead to missing or erroneous dependencies. Our implementation assumes that there is one statement per line.</li>
<li><strong>If-Expressions</strong> (<code>y = 1 if x else 0</code>) do not create control dependencies, as there are no statements to control. Neither do <code>if</code> clauses in comprehensions.</li>
<li><strong>Asynchronous functions</strong> (<code>async</code>, <code>await</code>) are not tested.</li>
</ul>
<p>In these cases, the instrumentation and the underlying dependency tracker may fail to identify control and/or data flows. The semantics of the code, however, should always stay unchanged.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned<a class="anchor-link" href="#Lessons-Learned">&#182;</a></h2><ul>
<li>To track the origin of some incorrect value, follow back its <em>dependencies</em>:<ul>
<li><em>Data dependencies</em> indicate where the value came from.</li>
<li><em>Control dependencies</em> show why a statement was executed.</li>
</ul>
</li>
<li>A <em>slice</em> is a subset of the code that could have influenced a specific value. It can be computed by transitively following all dependencies.</li>
<li><em>Instrument code</em> to automatically determine and visualize dependencies.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps<a class="anchor-link" href="#Next-Steps">&#182;</a></h2><p>In the <a href="StatisticalDebugger.html">next chapter</a>, we will explore how to make use of <em>multiple</em> passing and failing executions.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background<a class="anchor-link" href="#Background">&#182;</a></h2><p>Slicing as computing a subset of a program by means of data and control dependencies was invented by Mark Weiser [Weiser <em>et al</em>, 1981]. In his seminal work "Programmers use Slices when Debugging", [<a href="https://doi.org/10.1145/358557.358577">Weiser <em>et al</em>, 1982</a>], Weiser demonstrated how such dependencies are crucial for systematic debugging:</p>
<blockquote><p>When debugging unfamiliar programs programmers use program pieces called <em>slices</em> which are sets of statements related by their flow of data. The statements in a slice are not necessarily textually contiguous, but may be scattered through a program.</p>
</blockquote>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Weiser's slices (and dependencies) were determined <em>statically</em> from program code. Both Korel and Laski [<a href="https://doi.org/10.1016/0020-0190(88)90054-3">Korel <em>et al</em>, 1988</a>] as well as Agrawal and Horgan [<a href="https://doi.org/10.1145/93542.93576">Agrawal <em>et al</em>, 1990</a>] introduced <em>dynamic</em> program slicing, building on <em>dynamic</em> dependencies, which would be more specific to a given (failing) run. (The <code>Slicer</code> we implement in this chapter is a dynamic slicer.) Tip [<a href="https://www.franktip.org/pubs/jpl1995.pdf">Tip <em>et al</em>, 1995</a>] gives a survey on program slicing techniques. Chen et al. [<a href="https://doi.org/10.1109/COMPSAC.2014.30">Z. Chen <em>et al</em>, 2014</a>] describe and evaluate the first dynamic slicer for Python programs (which is independent of our implementation).</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One exemplary application of program slices is <a href="https://github.com/amyjko/whyline">the Whyline</a> by Ko and Myers [<a href="https://doi.org/10.1145/985692.985712">Ko <em>et al</em>, 2004</a>]. The Whyline is a debugging interface for asking questions about program behavior. It allows querying interactively where a particular variable came from (a data dependency) and why or why not specific things took place (control dependencies).</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In [<a href="https://figshare.com/articles/conference_contribution/Locating_Faults_with_Program_Slicing_-_An_Empirical_Analysis_-_Replication_Package/13369400/1">Ezekiel Soremekun <em>et al</em>, 2021</a>], Soremekun et al. evaluated the performance of slicing as a fault localization mechanism and found that following dependencies was one of the most successful strategies to determine fault locations. Notably, if programmers first examine at most the top five most suspicious locations from <a href="StatisticalDebugger.html">statistical debugging</a>, and then switch to dynamic slices, on average, they will need to examine only 15% (12 lines) of the code.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises<a class="anchor-link" href="#Exercises">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-Control-Slices">Exercise 1: Control Slices<a class="anchor-link" href="#Exercise-1:-Control-Slices">&#182;</a></h3><p>Augment the <code>Slicer</code> class with two keyword arguments, <code>include</code> and <code>exclude</code>, each taking a list of functions to instrument or not to instrument, respectively. These can be helpful when using "automatic" instrumentation.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-2:-Incremental-Exploration">Exercise 2: Incremental Exploration<a class="anchor-link" href="#Exercise-2:-Incremental-Exploration">&#182;</a></h3><p>This is more of a programming project than a simple exercise. Rather than showing all dependencies as a whole, as we do, build a system that allows the user to <em>explore</em> dependencies interactively.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-3:-Forward-Slicing">Exercise 3: Forward Slicing<a class="anchor-link" href="#Exercise-3:-Forward-Slicing">&#182;</a></h3><p>Extend <code>Dependencies</code> with a variant of <code>backward_slice()</code> named <code>forward_slice()</code> that, instead of computing the dependencies that go <em>into</em> a location, computes the dependencies that go <em>out</em> of a location.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-4:-Code-with-Forward-Dependencies">Exercise 4: Code with Forward Dependencies<a class="anchor-link" href="#Exercise-4:-Code-with-Forward-Dependencies">&#182;</a></h3><p>Create a variant of <code>Dependencies.code()</code> that, for each statement <code>s</code>, instead of showing a "passive" view (which variables and locations influenced <code>s</code>?), shows an "active" view (which variables and locations were influenced by <code>s</code>?). For <code>middle()</code>, for instance, the first line should show which lines are influenced by <code>x</code>, <code>y</code>, and <code>z</code>, respectively. Use <code>-&gt;</code> for control flows and <code>=&gt;</code> for data flows.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-5:-Flow-Assertions">Exercise 5: Flow Assertions<a class="anchor-link" href="#Exercise-5:-Flow-Assertions">&#182;</a></h3><p>In line with <a href="#Verifying-Flows-at-Runtime">Verifying Flows at Runtime</a>, above, implement a function <code>assert_flow(target, source)</code> that checks at runtime that the data flowing into <code>target</code> only comes from the variables named in <code>source</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">assert_flow</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raise an `AssertionError` if the dependencies of `target`</span>
<span class="sd">    are not equal to `source`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>assert_flow()</code> would be used in conjunction with <code>Slicer()</code> as follows:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">demo4</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">26</span>
    <span class="n">assert_flow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>  <span class="c1"># ensures that `y` depends on `x` only</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Slicer</span><span class="p">()</span> <span class="k">as</span> <span class="n">slicer</span><span class="p">:</span>
    <span class="n">demo4</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2498757139.py:9: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords.append(keyword(arg=&#39;pos&#39;, value=ast.Num(pos)))
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/2454789564.py:22: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), value],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/3554319793.py:4: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(id), Name(id=id, ctx=Load())],
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:12: DeprecationWarning: ast.Num is deprecated and will be removed in Python 3.14; use ast.Constant instead
  keywords=[keyword(arg=&#39;pos&#39;, value=ast.Num(n + 1))]
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:25: DeprecationWarning: ast.Str is deprecated and will be removed in Python 3.14; use ast.Constant instead
  args=[ast.Str(child.arg),
/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_18911/882995308.py:19: DeprecationWarning: ast.NameConstant is deprecated and will be removed in Python 3.14; use ast.Constant instead
  value=ast.NameConstant(value=True)))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To check dependencies, have <code>assert_flow()</code> check the contents of the <code>_data</code> dependency collector as set up by the slicer.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-6:-Checked-Coverage">Exercise 6: Checked Coverage<a class="anchor-link" href="#Exercise-6:-Checked-Coverage">&#182;</a></h3><p>Implement checked coverage, as sketched in <a href="#Assessing-Test-Quality">Assessing Test Quality</a> above. For every <code>assert</code> statement encountered during a run, produce the number of statements it depends upon.</p>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Creative Commons License">
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target=_blank>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/debuggingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/debuggingbook/commits/master/notebooks/Slicer.ipynb" target=_blank)>Last change: 2024-11-24 21:38:19+01:00</a> &bull; 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> &bull;
<a href="https://cispa.de/en/impressum" target=_blank>Imprint</a>
</p>

<script>
function revealCitation() {
    var c = document.getElementById("citation");
    c.style.display = "block";
}
</script>

<div id="citation" class="citation" style="display: none;">
<a name="citation"></a>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller: "<a href="https://www.debuggingbook.org/html/Slicer.html">Tracking Failure Origins</a>".  In Andreas Zeller, "<a href="https://www.debuggingbook.org/">The Debugging Book</a>", <a href="https://www.debuggingbook.org/html/Slicer.html">https://www.debuggingbook.org/html/Slicer.html</a>.  Retrieved 2024-11-24 21:38:19+01:00.
</p>
<pre>
@incollection{debuggingbook2024:Slicer,
    author = {Andreas Zeller},
    booktitle = {The Debugging Book},
    title = {Tracking Failure Origins},
    year = {2024},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.debuggingbook.org/html/Slicer.html}},
    note = {Retrieved 2024-11-24 21:38:19+01:00},
    url = {https://www.debuggingbook.org/html/Slicer.html},
    urldate = {2024-11-24 21:38:19+01:00}
}
</pre>
</div>

      </div>
    </div>
    </article>

 </body>

</html>